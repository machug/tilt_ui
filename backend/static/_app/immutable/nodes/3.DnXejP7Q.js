import{d as Se,f as d,s as o,a as c,c as ke}from"../chunks/BMR6TOGE.js";import{aa as Te,ad as s,ac as l,af as t,aq as x,b as n,ao as P,ab as De,ar as $,au as ae,an as N,p as Be,ap as Oe,ai as ze,s as L,e as He,ae as Ie}from"../chunks/CJ9U_lt3.js";import{e as Ce,i as Qe}from"../chunks/Bv8p5TEf.js";import{i as p}from"../chunks/BK4Po838.js";import{s as Re,h as Je,r as Ke}from"../chunks/CHurcNvB.js";import{s as ge}from"../chunks/aXqbUBLU.js";import{b as We}from"../chunks/CAiyxBcm.js";import{g as ue}from"../chunks/FtPPu8tm.js";import{e as Xe,b as Ye}from"../chunks/C_g1FNU9.js";import{s as te}from"../chunks/CJgb9CkH.js";import{p as Ze}from"../chunks/zos2G0RV.js";import{e as $e,d as et,h as tt,g as at}from"../chunks/BZ207_Dj.js";var st=d('<span class="recipe-name svelte-6cd32a"> </span>'),rt=d('<span class="status-dot svelte-6cd32a"></span>'),nt=d('<div class="metric svelte-6cd32a"><div class="metric-value temp svelte-6cd32a"> <span class="metric-unit svelte-6cd32a"> </span> <span class="temp-indicator svelte-6cd32a"> </span></div> <div class="metric-label svelte-6cd32a">Temp</div></div>'),lt=d('<div class="metric svelte-6cd32a"><div class="metric-value progress-value svelte-6cd32a"> <span class="metric-unit svelte-6cd32a">%</span></div> <div class="metric-label svelte-6cd32a">Progress</div></div>'),it=d('<div class="progress-bar-container svelte-6cd32a"><div class="progress-bar svelte-6cd32a"></div> <div class="progress-markers svelte-6cd32a"><span class="svelte-6cd32a">0%</span> <span class="svelte-6cd32a">50%</span> <span class="svelte-6cd32a">100%</span></div></div>'),vt=d('<div class="stat svelte-6cd32a"><span class="stat-label svelte-6cd32a">ABV</span> <span class="stat-value svelte-6cd32a"> </span></div> <div class="stat svelte-6cd32a"><span class="stat-label svelte-6cd32a">Atten</span> <span class="stat-value svelte-6cd32a"> </span></div>',1),ct=d('<div class="stat svelte-6cd32a"><span class="stat-label svelte-6cd32a">Target FG</span> <span class="stat-value svelte-6cd32a"> </span></div>'),ot=d('<button type="button" class="action-btn svelte-6cd32a">View <svg class="action-icon svelte-6cd32a" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" class="svelte-6cd32a"></path></svg></button>'),dt=d('<button type="button" class="expand-btn svelte-6cd32a"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" class="svelte-6cd32a"></path></svg></button>'),ut=d('<div><div class="accent-stripe svelte-6cd32a"></div> <div class="card-content svelte-6cd32a"><div class="header svelte-6cd32a"><div class="header-left svelte-6cd32a"><div class="batch-number svelte-6cd32a"> </div> <div class="title-group svelte-6cd32a"><h3 class="batch-name svelte-6cd32a"> </h3> <!></div></div> <button type="button" class="status-pill svelte-6cd32a"><!> </button></div> <div class="metrics-row svelte-6cd32a"><div class="metric svelte-6cd32a"><div class="metric-value svelte-6cd32a"> <span class="metric-unit svelte-6cd32a"> </span></div> <div class="metric-label svelte-6cd32a"> </div></div> <!> <!></div> <!> <div class="stats-row svelte-6cd32a"><!> <!> <div class="stat svelte-6cd32a"><span class="stat-label svelte-6cd32a">Brewed</span> <span class="stat-value svelte-6cd32a"> </span></div></div> <div class="footer svelte-6cd32a"><span class="brew-date svelte-6cd32a"> </span> <div class="footer-actions svelte-6cd32a"><!> <!></div></div></div></div>');function gt(se,a){Te(a,!0);let C=Ze(a,"expanded",3,!1);const q={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},j={in_range:{icon:"‚úì",color:"var(--positive)"},too_cold:{icon:"‚Üì",color:"#3b82f6"},too_hot:{icon:"‚Üë",color:"var(--negative)"},unknown:{icon:"?",color:"var(--text-muted)"}};let y=P(()=>q[a.batch.status]||q.planning),k=P(()=>a.progress?.temperature?.status?j[a.progress.temperature.status]:j.unknown),S=P($e),re=P(at);function O(e){return e==null?"--":et(e)}function z(e){return e==null?"--":tt(e)}function ne(){if(!a.batch.brew_date)return"--";const e=new Date(a.batch.brew_date),i=Math.floor((new Date().getTime()-e.getTime())/(1e3*60*60*24));return i===0?"Today":i===1?"1 day":`${i} days`}function H(e){return e?new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"--"}let I=P(ne),le=P(()=>a.batch.name||a.batch.recipe?.name||"Unnamed Batch");var T=ut();let A;var Q=s(T),R=l(Q,2),J=s(R),K=s(J),W=s(K),v=s(W);t(W);var _=l(W,2),g=s(_),D=s(g,!0);t(g);var M=l(g,2);{var u=e=>{var r=st(),i=s(r,!0);t(r),x(()=>o(i,a.batch.recipe.name)),c(e,r)};p(M,e=>{a.batch.recipe?.name&&a.batch.name&&a.batch.name!==a.batch.recipe.name&&e(u)})}t(_),t(K);var m=l(K,2);m.__click=()=>a.onStatusChange?.(a.batch.status);var F=s(m);{var X=e=>{var r=rt();c(e,r)};p(F,e=>{a.batch.status==="fermenting"&&e(X)})}var Y=l(F);t(m),t(J);var w=l(J,2),f=s(w),B=s(f),V=s(B),E=l(V),G=s(E,!0);t(E),t(B);var U=l(B,2),ie=s(U,!0);t(U),t(f);var _e=l(f,2);{var Me=e=>{var r=nt(),i=s(r),b=s(i),h=l(b),ee=s(h,!0);t(h);var Z=l(h,2),oe=s(Z,!0);t(Z),t(i),$(2),t(r),x(de=>{te(i,`color: ${n(k).color??""};`),o(b,`${de??""} `),o(ee,n(re)),o(oe,n(k).icon)},[()=>z(a.progress.temperature.current)]),c(e,r)};p(_e,e=>{a.progress?.temperature?.current!=null&&e(Me)})}var Fe=l(_e,2);{var Ve=e=>{var r=lt(),i=s(r),b=s(i);$(),t(i),$(2),t(r),x(h=>o(b,`${h??""} `),[()=>a.progress.progress.percent_complete.toFixed(0)]),c(e,r)};p(Fe,e=>{a.progress?.progress?.percent_complete!==void 0&&a.progress.progress.percent_complete!==null&&e(Ve)})}t(w);var me=l(w,2);{var Ge=e=>{var r=it(),i=s(r);$(2),t(r),x(()=>te(i,`width: ${a.progress?.progress?.percent_complete??0??""}%;`)),c(e,r)};p(me,e=>{(a.batch.status==="fermenting"||a.batch.status==="conditioning")&&e(Ge)})}var ve=l(me,2),pe=s(ve);{var Le=e=>{var r=vt(),i=ae(r),b=l(s(i),2),h=s(b);t(b),t(i);var ee=l(i,2),Z=l(s(ee),2),oe=s(Z);t(Z),t(ee),x((de,qe)=>{o(h,`${de??""}%`),o(oe,`${qe??""}%`)},[()=>a.progress.measured.abv?.toFixed(1)??"--",()=>a.progress.measured.attenuation?.toFixed(0)??"--"]),c(e,r)};p(pe,e=>{a.batch.measured_og&&a.progress?.measured?.current_sg&&e(Le)})}var be=l(pe,2);{var Pe=e=>{var r=ct(),i=l(s(r),2),b=s(i,!0);t(i),t(r),x(h=>o(b,h),[()=>O(a.progress.targets.fg)]),c(e,r)};p(be,e=>{a.progress?.targets?.fg&&e(Pe)})}var fe=l(be,2),he=l(s(fe),2),Ue=s(he,!0);t(he),t(fe),t(ve);var we=l(ve,2),ce=s(we),je=s(ce,!0);t(ce);var xe=l(ce,2),ye=s(xe);{var Ae=e=>{var r=ot();r.__click=function(...i){a.onViewDetails?.apply(this,i)},c(e,r)};p(ye,e=>{a.onViewDetails&&e(Ae)})}var Ee=l(ye,2);{var Ne=e=>{var r=dt();r.__click=function(...h){a.onToggleExpand?.apply(this,h)};var i=s(r);let b;t(r),x(()=>{Re(r,"aria-label",C()?"Collapse":"Expand"),b=ge(i,0,"expand-icon svelte-6cd32a",null,b,{"rotate-180":C()})}),c(e,r)};p(Ee,e=>{a.onToggleExpand&&e(Ne)})}t(xe),t(we),t(R),t(T),x((e,r)=>{A=ge(T,1,"batch-card svelte-6cd32a",null,A,{expanded:C(),fermenting:a.batch.status==="fermenting"}),te(Q,`background: ${n(y).color??""};`),o(v,`#${(a.batch.batch_number||"?")??""}`),o(D,n(le)),te(m,`color: ${n(y).color??""}; background: ${n(y).bg??""};`),o(Y,` ${n(y).label??""}`),o(V,`${e??""} `),o(G,n(S)!=="SG"?n(S):""),o(ie,a.progress?.measured?.current_sg?"Current":"OG"),o(Ue,n(I)),o(je,r)},[()=>O(a.progress?.measured?.current_sg??a.batch.measured_og),()=>H(a.batch.brew_date)]),c(se,T),De()}Se(["click"]);var _t=d('<button type="button"> </button>'),mt=d('<div class="loading-state svelte-40gn7n"><div class="spinner svelte-40gn7n"></div> <span>Loading batches...</span></div>'),pt=d('<div class="error-state svelte-40gn7n"><span class="error-icon svelte-40gn7n">!</span> <p> </p> <button type="button" class="retry-btn svelte-40gn7n">Retry</button></div>'),bt=d('<div class="empty-icon svelte-40gn7n">üç∫</div> <h3 class="svelte-40gn7n">No batches yet</h3> <p class="svelte-40gn7n">Create your first batch to start tracking fermentation</p> <button type="button" class="create-btn svelte-40gn7n">Create Batch</button>',1),ft=d('<div class="empty-icon svelte-40gn7n">üîç</div> <h3 class="svelte-40gn7n">No matches</h3> <p class="svelte-40gn7n">Try adjusting your filters or search query</p>',1),ht=d('<div class="empty-state svelte-40gn7n"><!></div>'),wt=d('<div class="batches-grid svelte-40gn7n"></div>'),xt=d('<div class="page-container svelte-40gn7n"><div class="page-header svelte-40gn7n"><div class="header-content svelte-40gn7n"><h1 class="page-title svelte-40gn7n">Batches</h1> <p class="page-description svelte-40gn7n">Track your fermentation batches</p></div> <button type="button" class="create-btn svelte-40gn7n"><svg class="btn-icon svelte-40gn7n" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg> New Batch</button></div> <div class="filters-row svelte-40gn7n"><div class="filter-chips svelte-40gn7n"></div> <div class="search-box svelte-40gn7n"><svg class="search-icon svelte-40gn7n" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> <input type="text" placeholder="Search batches..." class="search-input svelte-40gn7n"/></div></div> <!></div>');function Pt(se,a){Te(a,!0);let C=N(Be([])),q=N(Be(new Map)),j=N(!0),y=N(null),k=N(""),S=N("");const re=[{value:"",label:"All Batches"},{value:"planning",label:"Planning"},{value:"fermenting",label:"Fermenting"},{value:"conditioning",label:"Conditioning"},{value:"completed",label:"Completed"},{value:"archived",label:"Archived"}];let O=P(()=>n(C).filter(v=>{const _=!n(k)||v.status===n(k),g=!n(S)||(v.name?.toLowerCase().includes(n(S).toLowerCase())??!1)||(v.recipe?.name?.toLowerCase().includes(n(S).toLowerCase())??!1);return _&&g}));async function z(){L(j,!0),L(y,null);try{L(C,await Xe(n(k)||void 0),!0);const v=["fermenting","conditioning"],g=n(C).filter(u=>v.includes(u.status)).map(async u=>{try{const m=await Ye(u.id);return[u.id,m]}catch{return null}}),D=await Promise.all(g),M=new Map;for(const u of D)u&&M.set(u[0],u[1]);L(q,M,!0)}catch(v){L(y,v instanceof Error?v.message:"Failed to load batches",!0)}finally{L(j,!1)}}function ne(v){ue(`/batches/${v}`)}Oe(()=>{z()}),ze(()=>{n(k)!==void 0&&z()});var H=xt();Je("40gn7n",v=>{He(()=>{Ie.title="Batches | BrewSignal"})});var I=s(H),le=l(s(I),2);le.__click=()=>ue("/batches/new"),t(I);var T=l(I,2),A=s(T);Ce(A,21,()=>re,Qe,(v,_)=>{var g=_t();let D;g.__click=()=>L(k,n(_).value,!0);var M=s(g,!0);t(g),x(()=>{D=ge(g,1,"filter-chip svelte-40gn7n",null,D,{active:n(k)===n(_).value}),o(M,n(_).label)}),c(v,g)}),t(A);var Q=l(A,2),R=l(s(Q),2);Ke(R),t(Q),t(T);var J=l(T,2);{var K=v=>{var _=mt();c(v,_)},W=v=>{var _=ke(),g=ae(_);{var D=u=>{var m=pt(),F=l(s(m),2),X=s(F,!0);t(F);var Y=l(F,2);Y.__click=z,t(m),x(()=>o(X,n(y))),c(u,m)},M=u=>{var m=ke(),F=ae(m);{var X=w=>{var f=ht(),B=s(f);{var V=G=>{var U=bt(),ie=l(ae(U),6);ie.__click=()=>ue("/batches/new"),c(G,U)},E=G=>{var U=ft();$(4),c(G,U)};p(B,G=>{n(C).length===0?G(V):G(E,!1)})}t(f),c(w,f)},Y=w=>{var f=wt();Ce(f,21,()=>n(O),B=>B.id,(B,V)=>{{let E=P(()=>n(q).get(n(V).id));gt(B,{get batch(){return n(V)},get progress(){return n(E)},onViewDetails:()=>ne(n(V).id)})}}),t(f),c(w,f)};p(F,w=>{n(O).length===0?w(X):w(Y,!1)},!0)}c(u,m)};p(g,u=>{n(y)?u(D):u(M,!1)},!0)}c(v,_)};p(J,v=>{n(j)?v(K):v(W,!1)})}t(H),We(R,()=>n(S),v=>L(S,v)),c(se,H),De()}Se(["click"]);export{Pt as component};
