import{d as $e,f as d,s as v,a as l,c as Se}from"../chunks/BQ88CgEU.js";import{al as a,ak as s,an as t,as as _,ah as Me,ar as Y,c as e,ai as P,at as Be,aj as Pe,ap as Yt,aL as qt,aF as Kt,am as Qt,ao as ge,s as f}from"../chunks/CGXqq0_G.js";import{e as kt,i as xt}from"../chunks/payu-7ZH.js";import{i as c}from"../chunks/ziKwUJ4R.js";import{h as Xt}from"../chunks/BP8qDDK3.js";import{s as zt}from"../chunks/D2zVhfuI.js";import{s as ze}from"../chunks/DqcjHxzZ.js";import{s as He}from"../chunks/BSw_pJTS.js";import{i as Zt,s as $t}from"../chunks/C5J5lxM1.js";import{s as ea,a as ta}from"../chunks/C-ohbqfQ.js";import{p as aa}from"../chunks/Ccx1YLak.js";import{g as sa}from"../chunks/DvAT4RLL.js";import{o as ra,g as ht,v as Ne,h as ia,u as jt,w as Xe}from"../chunks/DLtesNQI.js";import{b as la,g as wt,d as et,e as Ct,c as yt}from"../chunks/CtEhNW1g.js";import{t as va}from"../chunks/DThvY6M2.js";import{B as na}from"../chunks/Bl2i8ozr.js";import{s as oa}from"../chunks/CUQuFe4_.js";import{p as Ze}from"../chunks/B3wItnqC.js";const da=!1,Fs=Object.freeze(Object.defineProperty({__proto__:null,prerender:da},Symbol.toStringTag,{value:"Module"}));function ca(L){return L>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:L>=-60?{bars:3,color:"var(--positive)",label:"Good"}:L>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function Ft(L){const i=Math.floor((Date.now()-new Date(L).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const h=Math.floor(i/60);if(h<60)return`${h}m ago`;const C=Math.floor(h/60);return C<24?`${C}h ago`:`${Math.floor(C/24)}d ago`}var ua=d('<div class="accent-bar svelte-1oyrwd9"></div>'),_a=d('<span class="card-icon svelte-1oyrwd9"> </span>'),ga=d('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),fa=d('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function Le(L,i){let h=Ze(i,"highlight",3,!1),C=Ze(i,"collapsible",3,!1),j=Ze(i,"expanded",3,!1);var k=fa();let u;var r=a(k);{var T=z=>{var R=ua();l(z,R)};c(r,z=>{h()&&z(T)})}var n=s(r,2),F=a(n),S=a(F);{var D=z=>{var R=_a(),V=a(R,!0);t(R),_(()=>v(V,i.icon)),l(z,R)};c(S,z=>{i.icon&&z(D)})}var g=s(S,2),p=a(g,!0);t(g),t(F);var y=s(F,2);{var x=z=>{var R=ga();R.__click=function(...E){i.onToggle?.apply(this,E)};var V=a(R);let G;t(R),_(()=>{zt(R,"aria-label",j()?"Collapse":"Expand"),G=ze(V,0,"expand-icon svelte-1oyrwd9",null,G,{"rotate-180":j()})}),l(z,R)};c(y,z=>{C()&&i.onToggle&&z(x)})}t(n);var b=s(n,2);let m;var B=a(b);oa(B,()=>i.children),t(b),t(k),_(()=>{u=ze(k,1,"batch-card svelte-1oyrwd9",null,u,{highlight:h()}),v(p,i.title),m=ze(b,1,"card-content svelte-1oyrwd9",null,m,{collapsed:C()&&!j()})}),l(L,k)}$e(["click"]);var ma=d('<span class="unit svelte-lzskfi"> </span>'),pa=d('<div class="raw-values svelte-lzskfi"><span class="raw-label svelte-lzskfi">Raw:</span> <span class="raw-value svelte-lzskfi"> </span> <span class="raw-separator svelte-lzskfi">¬∑</span> <span class="raw-value svelte-lzskfi"> </span></div>'),ba=d('<div class="last-seen svelte-lzskfi"> </div>'),ha=d('<div class="live-badge svelte-lzskfi"><span class="live-dot svelte-lzskfi"></span> <span class="live-text svelte-lzskfi">LIVE</span></div> <div class="readings-grid svelte-lzskfi"><div class="reading svelte-lzskfi"><div class="reading-value svelte-lzskfi"> <!></div> <div class="reading-label svelte-lzskfi"> </div></div> <div class="reading svelte-lzskfi"><div class="reading-value temp svelte-lzskfi"> <span class="unit svelte-lzskfi"> </span></div> <div class="reading-label svelte-lzskfi">Temperature</div></div></div> <!> <!>',1);function ja(L,i){Me(i,!0);let h=P(()=>i.liveReading?.sg??i.currentSg),C=P(()=>i.liveReading?.temp??i.currentTemp),j=P(()=>i.liveReading?.sg_raw),k=P(()=>i.liveReading?.temp_raw),u=P(()=>i.liveReading?.last_seen),r=P(()=>i.liveReading&&(i.liveReading.sg!==i.liveReading.sg_raw||i.liveReading.temp!==i.liveReading.temp_raw)),T=P(la),n=P(wt);function F(g){return g==null?"--":et(g)}function S(g){return g==null?"--":Ct(g)}let D=P(()=>e(u)?Ft(e(u)):null);Le(L,{title:"Live Readings",highlight:!0,children:(g,p)=>{var y=ha(),x=s(Y(y),2),b=a(x),m=a(b),B=a(m),z=s(B);{var R=A=>{var M=ma(),ee=a(M,!0);t(M),_(()=>v(ee,e(T))),l(A,M)};c(z,A=>{e(T)!=="SG"&&A(R)})}t(m);var V=s(m,2),G=a(V,!0);t(V),t(b);var E=s(b,2),q=a(E),Q=a(q),$=s(Q),X=a($,!0);t($),t(q),Be(2),t(E),t(x);var le=s(x,2);{var Z=A=>{var M=pa(),ee=s(a(M),2),Ee=a(ee,!0);t(ee);var Te=s(ee,4),te=a(Te);t(Te),t(M),_((ae,o)=>{v(Ee,ae),v(te,`${o??""}${e(n)??""}`)},[()=>F(e(j)),()=>S(e(k))]),l(A,M)};c(le,A=>{e(r)&&A(Z)})}var _e=s(le,2);{var he=A=>{var M=ba(),ee=a(M);t(M),_(()=>v(ee,`Updated ${e(D)??""}`)),l(A,M)};c(_e,A=>{e(D)&&A(he)})}_((A,M)=>{v(B,`${A??""} `),v(G,e(T)==="SG"?"Gravity":e(T)==="¬∞P"?"Plato":"Brix"),v(Q,`${M??""} `),v(X,e(n))},[()=>F(e(h)),()=>S(e(C))]),l(g,y)},$$slots:{default:!0}}),Pe()}var ya=d('<div class="gravity-point target svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Target FG</div> <div class="point-value svelte-t80j9z"> </div></div>'),ka=d('<div class="progress-remaining svelte-t80j9z"> </div>'),xa=d('<div class="progress-section svelte-t80j9z"><div class="progress-header svelte-t80j9z"><span class="progress-label svelte-t80j9z">Fermentation Progress</span> <span class="progress-percent svelte-t80j9z"> </span></div> <div class="progress-bar-container svelte-t80j9z"><div class="progress-bar-bg svelte-t80j9z"></div> <div class="progress-bar-fill svelte-t80j9z"></div> <div class="progress-bar-shine svelte-t80j9z"></div></div> <!></div>'),za=d('<div class="current-sg svelte-t80j9z"><div class="sg-label svelte-t80j9z">Current Specific Gravity</div> <div class="sg-value svelte-t80j9z"> <span class="fermenting-badge svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> Fermenting</span></div></div> <div class="gravity-timeline svelte-t80j9z"><div class="timeline-line svelte-t80j9z"></div> <div class="gravity-point start svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Original Gravity</div> <div class="point-value svelte-t80j9z"> </div></div> <!> <div class="gravity-point current svelte-t80j9z"><div class="point-marker pulsing svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Current FG</div> <div class="point-value svelte-t80j9z"> </div></div></div> <div class="metrics-grid svelte-t80j9z"><div class="metric abv-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">%</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Alcohol by Volume</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div> <div class="metric attenuation-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">‚Üì</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Apparent Attenuation</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div></div> <!>',1),wa=d('<div class="measurements-grid svelte-t80j9z"><div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Original Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Final Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">ABV</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Attenuation</div> <div class="measurement-value svelte-t80j9z"> </div></div></div>'),Ca=d('<div class="no-data svelte-t80j9z"><div class="no-data-icon svelte-t80j9z">‚óã</div> <p class="no-data-text svelte-t80j9z">Set Original Gravity to begin tracking fermentation metrics</p></div>');function Fa(L,i){Me(i,!0);let h=P(()=>{if(!i.batch.measured_og)return null;const u=i.currentSg??i.progress?.measured?.current_sg;if(!u)return null;const r=(i.batch.measured_og-u)*131.25,T=i.batch.measured_og-1,n=T!==0?(i.batch.measured_og-u)/T*100:0;return{currentSg:u,abv:Math.max(0,r),attenuation:Math.max(0,Math.min(100,n)),isFermenting:i.batch.status==="fermenting"||i.batch.status==="conditioning"}}),C=P(()=>e(h)?.isFermenting??!1);function j(u){return u==null?"--":et(u)}function k(u){return u==null?"--":`${u.toFixed(1)}%`}{let u=P(()=>e(C)?"Fermentation Progress":"Fermentation Measurements");Le(L,{get title(){return e(u)},children:(r,T)=>{var n=Se(),F=Y(n);{var S=g=>{var p=za(),y=Y(p),x=s(a(y),2),b=a(x);Be(),t(x),t(y);var m=s(y,2),B=s(a(m),2),z=s(a(B),4),R=a(z,!0);t(z),t(B);var V=s(B,2);{var G=te=>{var ae=ya(),o=s(a(ae),4),O=a(o,!0);t(o),t(ae),_(U=>v(O,U),[()=>j(i.batch.recipe.fg_target)]),l(te,ae)};c(V,te=>{i.batch.recipe?.fg_target&&te(G)})}var E=s(V,2),q=s(a(E),4),Q=a(q,!0);t(q),t(E),t(m);var $=s(m,2),X=a($),le=s(a(X),2),Z=s(a(le),2),_e=a(Z);Be(),t(Z),t(le),t(X);var he=s(X,2),A=s(a(he),2),M=s(a(A),2),ee=a(M);Be(),t(M),t(A),t(he),t($);var Ee=s($,2);{var Te=te=>{var ae=xa(),o=a(ae),O=s(a(o),2),U=a(O);t(O),t(o);var I=s(o,2),Ae=s(a(I),2);Be(2),t(I);var ne=s(I,2);{var ve=J=>{var fe=ka(),we=a(fe);t(fe),_(je=>v(we,`${je??""} gravity points remaining`),[()=>i.progress.progress.sg_remaining.toFixed(3)]),l(J,fe)};c(ne,J=>{i.progress.progress.sg_remaining!=null&&J(ve)})}t(ae),_(J=>{v(U,`${J??""}%`),He(Ae,`width: ${i.progress.progress.percent_complete??""}%`)},[()=>i.progress.progress.percent_complete.toFixed(0)]),l(te,ae)};c(Ee,te=>{i.progress?.progress?.percent_complete!=null&&te(Te)})}_((te,ae,o,O,U)=>{v(b,`${te??""} `),v(R,ae),v(Q,o),v(_e,`${O??""} `),v(ee,`${U??""} `)},[()=>j(e(h).currentSg),()=>j(i.batch.measured_og),()=>j(e(h).currentSg),()=>k(e(h).abv),()=>k(e(h).attenuation)]),l(g,p)},D=g=>{var p=Se(),y=Y(p);{var x=m=>{var B=wa(),z=a(B),R=s(a(z),2),V=a(R,!0);t(R),t(z);var G=s(z,2),E=s(a(G),2),q=a(E,!0);t(E),t(G);var Q=s(G,2),$=s(a(Q),2),X=a($,!0);t($),t(Q);var le=s(Q,2),Z=s(a(le),2),_e=a(Z,!0);t(Z),t(le),t(B),_((he,A,M,ee)=>{v(V,he),v(q,A),v(X,M),v(_e,ee)},[()=>j(i.batch.measured_og),()=>j(i.batch.measured_fg),()=>i.batch.measured_abv!=null?k(i.batch.measured_abv):"--",()=>i.batch.measured_attenuation!=null?k(i.batch.measured_attenuation):"--"]),l(m,B)},b=m=>{var B=Ca();l(m,B)};c(y,m=>{i.batch.measured_og?m(x):m(b,!1)},!0)}l(g,p)};c(F,g=>{e(h)&&e(C)?g(S):g(D,!1)})}l(r,n)},$$slots:{default:!0}})}Pe()}var Sa=d('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Ba(L,i){Me(i,!0);function h(j){return j?new Date(j).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function C(j){return j?new Date(j).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}Le(L,{title:"Timeline",children:(j,k)=>{var u=Sa(),r=a(u),T=s(a(r),2),n=a(T,!0);t(T),t(r);var F=s(r,2),S=s(a(F),2),D=a(S,!0);t(S),t(F);var g=s(F,2),p=s(a(g),2),y=a(p,!0);t(p),t(g);var x=s(g,2),b=s(a(x),2),m=a(b,!0);t(b),t(x),t(u),_((B,z,R,V)=>{v(n,B),v(D,z),v(y,R),v(m,V)},[()=>h(i.batch.brew_date),()=>C(i.batch.start_time),()=>C(i.batch.end_time),()=>C(i.batch.created_at)]),l(j,u)},$$slots:{default:!0}}),Pe()}var Ta=d('<div class="signal-bar svelte-1kdxwtz"></div>'),Ra=d('<div class="signal-details svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="signal-text svelte-1kdxwtz"> </span></div>'),Oa=d('<div class="device-last-seen svelte-1kdxwtz"> </div>'),Ga=d('<div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!> <!>',1),Da=d('<div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <div class="device-last-seen svelte-1kdxwtz">Not receiving data</div>',1),Ma=d('<div class="device-info svelte-1kdxwtz"><!></div>'),Pa=d('<button type="button" class="link-btn svelte-1kdxwtz">Link a device</button>'),La=d('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Ea(L,i){Me(i,!0);let h=P(()=>i.liveReading?.rssi?ca(i.liveReading.rssi):null),C=P(()=>i.liveReading?.last_seen?Ft(i.liveReading.last_seen):null);Le(L,{title:"Tracking Device",children:(j,k)=>{var u=Se(),r=Y(u);{var T=F=>{var S=Ma(),D=a(S);{var g=y=>{var x=Ga(),b=Y(x),m=s(a(b));t(b);var B=s(b,2);{var z=G=>{var E=Ra(),q=a(E);kt(q,20,()=>Array(4),xt,(X,le,Z)=>{var _e=Ta();_(()=>He(_e,`
										height: ${6+Z*3}px;
										background: ${(Z<e(h).bars?e(h).color:"var(--bg-hover)")??""};
										opacity: ${Z<e(h).bars?1:.4};
									`)),l(X,_e)}),t(q);var Q=s(q,2),$=a(Q);t(Q),t(E),_(()=>{He(Q,`color: ${e(h).color??""}`),v($,`${e(h).label??""} (${i.liveReading.rssi??""} dBm)`)}),l(G,E)};c(B,G=>{e(h)&&G(z)})}var R=s(B,2);{var V=G=>{var E=Oa(),q=a(E);t(E),_(()=>v(q,`Updated ${e(C)??""}`)),l(G,E)};c(R,G=>{e(C)&&G(V)})}_(()=>v(m,` ${i.liveReading.color??""} Tilt - Connected`)),l(y,x)},p=y=>{var x=Da(),b=Y(x),m=s(a(b));t(b),Be(2),_(()=>v(m,` Device: ${i.batch.device_id??""}`)),l(y,x)};c(D,y=>{i.liveReading?y(g):y(p,!1)})}t(S),l(F,S)},n=F=>{var S=La(),D=s(a(S),2);{var g=p=>{var y=Pa();y.__click=function(...x){i.onEdit?.apply(this,x)},l(p,y)};c(D,p=>{i.onEdit&&p(g)})}t(S),l(F,S)};c(r,F=>{i.batch.device_id?F(T):F(n,!1)})}l(j,u)},$$slots:{default:!0}}),Pe()}$e(["click"]);var Aa=d('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),Ua=d('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function Na(L,i){Me(i,!0);function h(C){return C==null?"--":et(C)}Le(L,{title:"Recipe Targets",children:(C,j)=>{var k=Ua(),u=a(k),r=s(a(u),2),T=a(r,!0);t(r),t(u);var n=s(u,2),F=s(a(n),2),S=a(F,!0);t(F),t(n);var D=s(n,2),g=s(a(D),2),p=a(g,!0);t(g),t(D);var y=s(D,2);{var x=b=>{var m=Aa(),B=s(a(m),2),z=a(B,!0);t(B),t(m),_(()=>v(z,i.recipe.yeast_name)),l(b,m)};c(y,b=>{i.recipe.yeast_name&&b(x)})}t(k),_((b,m,B)=>{v(T,b),v(S,m),v(p,B)},[()=>h(i.recipe.og_target),()=>h(i.recipe.fg_target),()=>i.recipe.abv_target!=null?`${i.recipe.abv_target.toFixed(1)}%`:"--"]),l(C,k)},$$slots:{default:!0}}),Pe()}var Ha=d('<p class="notes-content svelte-hkv31i"> </p>');function Va(L,i){Le(L,{title:"Notes",children:(h,C)=>{var j=Ha(),k=a(j,!0);t(j),_(()=>v(k,i.notes)),l(h,j)},$$slots:{default:!0}})}var Ia=d('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Wa=d('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Ja=d('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Ya=d('<span class="recipe-type svelte-g5au2j"> </span>'),qa=d('<a class="recipe-link svelte-g5au2j"> <!></a>'),Ka=d('<option class="svelte-g5au2j"> </option>'),Qa=d('<div class="device-status heater svelte-g5au2j"><div>üî•</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Heater</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Xa=d('<div class="device-status cooler svelte-g5au2j"><div>‚ùÑÔ∏è</div> <div class="device-info svelte-g5au2j"><span class="device-label svelte-g5au2j">Cooler</span> <span> </span> <span class="device-entity svelte-g5au2j"> </span></div></div>'),Za=d('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">‚ö°</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),$a=d('<button type="button" class="override-btn heat-on svelte-g5au2j">Force Heat ON</button> <button type="button" class="override-btn heat-off svelte-g5au2j">Force Heat OFF</button>',1),es=d('<button type="button" class="override-btn cool-on svelte-g5au2j">Force Cool ON</button> <button type="button" class="override-btn cool-off svelte-g5au2j">Force Cool OFF</button>',1),ts=d('<div class="control-details svelte-g5au2j"><div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="control-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns-grid svelte-g5au2j"><!> <!> <button type="button" class="override-btn auto-mode svelte-g5au2j">Auto Mode</button></div></div>',1),as=d('<div><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="device-status-grid svelte-g5au2j"><!> <!></div> <!></div>'),ss=d('<span class="svelte-g5au2j"> </span>'),rs=d('<span class="svelte-g5au2j"> </span>'),is=d('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><!> <!> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),ls=d('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j" aria-label="Delete batch"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!></div></div>',1),vs=d('<div class="modal-overlay svelte-g5au2j"><div class="modal svelte-g5au2j"><h2 class="modal-title svelte-g5au2j">Delete Batch?</h2> <p class="modal-text svelte-g5au2j"> </p> <div class="modal-actions svelte-g5au2j"><button type="button" class="modal-btn cancel svelte-g5au2j">Cancel</button> <button type="button" class="modal-btn delete svelte-g5au2j"> </button></div></div></div>'),ns=d('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div> <!>',1);function Ss(L,i){Me(i,!0);const h=()=>ta(aa,"$page",C),[C,j]=ea();let k=null,u=null,r=ge(null),T=ge(null),n=ge(null),F=ge(!0),S=ge(null),D=ge(!1),g=ge(!1),p=ge(!1),y=ge(!1),x=ge(!1),b=P(()=>parseInt(h().params.id??"0"));const m={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},B=["planning","fermenting","conditioning","completed","archived"];let z=P(()=>e(r)?m[e(r).status]:m.planning),R=P(wt),V=P(()=>yt.config.ha_enabled&&yt.config.temp_control_enabled&&(e(r)?.heater_entity_id||e(r)?.cooler_entity_id)),G=P(()=>{if(!e(r)?.device_id)return null;const o=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!o?.[1])return null;const O=o[1].toUpperCase();for(const U of va.tilts.values())if(U.color.toUpperCase()===O)return U;return null});async function E(){f(F,!0),f(S,null);try{if(f(r,await ra(e(b)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{f(T,await ht(e(b)),!0)}catch{}if(e(r).heater_entity_id||e(r).cooler_entity_id)try{f(n,await Ne(e(b)),!0)}catch{}}catch(o){f(S,o instanceof Error?o.message:"Failed to load batch",!0)}finally{f(F,!1)}}async function q(o){if(!(!e(r)||e(g))){f(g,!0);try{f(r,await jt(e(r).id,{status:o}),!0),(o==="fermenting"||o==="conditioning")&&f(T,await ht(e(r).id),!0)}catch(O){console.error("Failed to update status:",O)}finally{f(g,!1)}}}async function Q(o){if(e(r)&&(f(r,await jt(e(r).id,o),!0),f(D,!1),e(r).heater_entity_id||e(r).cooler_entity_id))try{f(n,await Ne(e(r).id),!0)}catch{}}async function $(){if(e(r)){f(x,!0);try{await ia(e(r).id),sa("/batches")}catch(o){f(S,o instanceof Error?o.message:"Failed to delete batch",!0),f(x,!1),f(y,!1)}}}async function X(o,O){if(!(!e(r)||e(p))){f(p,!0);try{await Xe(e(r).id,O,60,o),f(n,await Ne(e(r).id),!0)}catch(U){console.error("Failed to set override:",U)}finally{f(p,!1)}}}async function le(){if(!(!e(r)||e(p))){f(p,!0);try{e(r).heater_entity_id&&await Xe(e(r).id,null,60,"heater"),e(r).cooler_entity_id&&await Xe(e(r).id,null,60,"cooler"),f(n,await Ne(e(r).id),!0)}catch(o){console.error("Failed to clear overrides:",o)}finally{f(p,!1)}}}function Z(){if(k?.readyState===WebSocket.OPEN)return;const O=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;k=new WebSocket(O),k.onmessage=async U=>{try{const I=JSON.parse(U.data);I.type==="control_event"&&I.batch_id===e(b)&&e(n)&&(I.action==="heat_on"?f(n,{...e(n),heater_state:"on"},!0):I.action==="heat_off"?f(n,{...e(n),heater_state:"off"},!0):I.action==="cool_on"?f(n,{...e(n),cooler_state:"on"},!0):I.action==="cool_off"&&f(n,{...e(n),cooler_state:"off"},!0))}catch{}},k.onclose=()=>{k=null,u=setTimeout(Z,3e3)},k.onerror=()=>{k?.close()}}function _e(){u&&(clearTimeout(u),u=null),k?.close(),k=null}function he(o){return o==null?"--":Ct(o)}Yt(()=>{E(),Z()}),qt(()=>{_e()});var A=ns();Xt("g5au2j",o=>{Kt(()=>{Qt.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var M=Y(A),ee=s(a(M),2);{var Ee=o=>{var O=Ia();l(o,O)},Te=o=>{var O=Se(),U=Y(O);{var I=ne=>{var ve=Wa(),J=s(a(ve),2),fe=a(J,!0);t(J);var we=s(J,2);we.__click=E,t(ve),_(()=>v(fe,e(S))),l(ne,ve)},Ae=ne=>{var ve=Se(),J=Y(ve);{var fe=je=>{var Ue=Ja();l(je,Ue)},we=je=>{var Ue=Se(),St=Y(Ue);{var Bt=Re=>{na(Re,{get batch(){return e(r)},onSubmit:Q,onCancel:()=>f(D,!1)})},Tt=Re=>{var tt=ls(),Ve=Y(tt),Ie=a(Ve),We=a(Ie),Rt=a(We);t(We);var at=s(We,2),Je=a(at),Ot=a(Je,!0);t(Je);var Gt=s(Je,2);{var Dt=w=>{var N=qa(),K=a(N),pe=s(K);{var oe=be=>{var ye=Ya(),Oe=a(ye);t(ye),_(()=>v(Oe,`(${e(r).recipe.type??""})`)),l(be,ye)};c(pe,be=>{e(r).recipe.type&&be(oe)})}t(N),_(()=>{zt(N,"href",`/recipes/${e(r).recipe.id??""}`),v(K,`${e(r).recipe.name??""} `)}),l(w,N)};c(Gt,w=>{e(r).recipe&&w(Dt)})}t(at),t(Ie);var st=s(Ie,2),Ye=a(st),me=a(Ye);me.__change=w=>q(w.currentTarget.value),kt(me,21,()=>B,xt,(w,N)=>{var K=Ka(),pe=a(K,!0);t(K);var oe={};_(()=>{v(pe,m[e(N)].label),oe!==(oe=e(N))&&(K.value=(K.__value=e(N))??"")}),l(w,K)}),t(me);var rt;Zt(me),t(Ye);var it=s(Ye,2);it.__click=()=>f(D,!0);var Mt=s(it,2);Mt.__click=()=>f(y,!0),t(st),t(Ve);var lt=s(Ve,2),qe=a(lt),vt=a(qe);{var Pt=w=>{{let N=P(()=>e(T)?.measured?.current_sg),K=P(()=>e(T)?.temperature?.current);ja(w,{get liveReading(){return e(G)},get currentSg(){return e(N)},get currentTemp(){return e(K)}})}};c(vt,w=>{(e(G)||e(T)?.measured?.current_sg!=null)&&w(Pt)})}var nt=s(vt,2);{let w=P(()=>e(G)?.sg??e(T)?.measured?.current_sg);Fa(nt,{get batch(){return e(r)},get currentSg(){return e(w)},get progress(){return e(T)}})}var Lt=s(nt,2);{var Et=w=>{Na(w,{get recipe(){return e(r).recipe}})};c(Lt,w=>{e(r).recipe&&w(Et)})}t(qe);var ot=s(qe,2),dt=a(ot);Ba(dt,{get batch(){return e(r)}});var ct=s(dt,2);Ea(ct,{get batch(){return e(r)},get liveReading(){return e(G)},onEdit:()=>f(D,!0)});var ut=s(ct,2);{var At=w=>{var N=as();let K;var pe=s(a(N),2),oe=a(pe);{var be=se=>{var H=Qa(),W=a(H);let re;var ke=s(W,2),de=s(a(ke),2);let xe;var Ge=a(de,!0);t(de);var Ce=s(de,2),De=a(Ce,!0);t(Ce),t(ke),t(H),_(()=>{re=ze(W,1,"device-icon-wrap svelte-g5au2j",null,re,{active:e(n)?.heater_state==="on"}),xe=ze(de,1,"device-state svelte-g5au2j",null,xe,{on:e(n)?.heater_state==="on"}),v(Ge,e(n)?.heater_state==="on"?"ON":"OFF"),v(De,e(r).heater_entity_id)}),l(se,H)};c(oe,se=>{e(r).heater_entity_id&&se(be)})}var ye=s(oe,2);{var Oe=se=>{var H=Xa(),W=a(H);let re;var ke=s(W,2),de=s(a(ke),2);let xe;var Ge=a(de,!0);t(de);var Ce=s(de,2),De=a(Ce,!0);t(Ce),t(ke),t(H),_(()=>{re=ze(W,1,"device-icon-wrap svelte-g5au2j",null,re,{active:e(n)?.cooler_state==="on"}),xe=ze(de,1,"device-state svelte-g5au2j",null,xe,{on:e(n)?.cooler_state==="on"}),v(Ge,e(n)?.cooler_state==="on"?"ON":"OFF"),v(De,e(r).cooler_entity_id)}),l(se,H)};c(ye,se=>{e(r).cooler_entity_id&&se(Oe)})}t(pe);var Ke=s(pe,2);{var Qe=se=>{var H=ts(),W=Y(H),re=a(W),ke=s(a(re),2),de=a(ke);t(ke),t(re);var xe=s(re,2),Ge=s(a(xe),2),Ce=a(Ge);t(Ge),t(xe),t(W);var De=s(W,2);{var Vt=ie=>{var ce=Za(),ue=s(a(ce),2),Fe=a(ue);t(ue);var bt=s(ue,2);bt.__click=()=>le(),t(ce),_(Jt=>{v(Fe,`Override active: ${Jt??""}`),bt.disabled=e(p)},[()=>e(n).override_state?.toUpperCase()]),l(ie,ce)};c(De,ie=>{e(n).override_active&&ie(Vt)})}var _t=s(De,2),gt=s(a(_t),2),ft=a(gt);{var It=ie=>{var ce=$a(),ue=Y(ce);ue.__click=()=>X("heater","on");var Fe=s(ue,2);Fe.__click=()=>X("heater","off"),_(()=>{ue.disabled=e(p),Fe.disabled=e(p)}),l(ie,ce)};c(ft,ie=>{e(r).heater_entity_id&&ie(It)})}var mt=s(ft,2);{var Wt=ie=>{var ce=es(),ue=Y(ce);ue.__click=()=>X("cooler","on");var Fe=s(ue,2);Fe.__click=()=>X("cooler","off"),_(()=>{ue.disabled=e(p),Fe.disabled=e(p)}),l(ie,ce)};c(mt,ie=>{e(r).cooler_entity_id&&ie(Wt)})}var pt=s(mt,2);pt.__click=()=>le(),t(gt),t(_t),_((ie,ce)=>{v(de,`${ie??""}${e(R)??""}`),v(Ce,`¬±${ce??""}${e(R)??""}`),pt.disabled=e(p)},[()=>he(e(n).target_temp),()=>e(n).hysteresis?.toFixed(1)||"--"]),l(se,H)};c(Ke,se=>{e(n)&&se(Qe)})}t(N),_(()=>K=ze(N,1,"info-card temp-control-card svelte-g5au2j",null,K,{"heater-on":e(n)?.heater_state==="on","cooler-on":e(n)?.cooler_state==="on"})),l(w,N)},Ut=w=>{var N=Se(),K=Y(N);{var pe=oe=>{var be=is(),ye=s(a(be),2),Oe=a(ye);{var Ke=H=>{var W=ss(),re=a(W);t(W),_(()=>v(re,`Heater: ${e(r).heater_entity_id??""}`)),l(H,W)};c(Oe,H=>{e(r).heater_entity_id&&H(Ke)})}var Qe=s(Oe,2);{var se=H=>{var W=rs(),re=a(W);t(W),_(()=>v(re,`Cooler: ${e(r).cooler_entity_id??""}`)),l(H,W)};c(Qe,H=>{e(r).cooler_entity_id&&H(se)})}Be(2),t(ye),t(be),l(oe,be)};c(K,oe=>{(e(r).heater_entity_id||e(r).cooler_entity_id)&&e(r).status!=="fermenting"&&oe(pe)},!0)}l(w,N)};c(ut,w=>{e(V)&&e(r).status==="fermenting"?w(At):w(Ut,!1)})}var Nt=s(ut,2);{var Ht=w=>{Va(w,{get notes(){return e(r).notes}})};c(Nt,w=>{e(r).notes&&w(Ht)})}t(ot),t(lt),_(()=>{v(Rt,`#${(e(r).batch_number||"?")??""}`),v(Ot,e(r).name||e(r).recipe?.name||"Unnamed Batch"),me.disabled=e(g),He(me,`color: ${e(z).color??""}; background: ${e(z).bg??""};`),rt!==(rt=e(r).status)&&(me.value=(me.__value=e(r).status)??"",$t(me,e(r).status))}),l(Re,tt)};c(St,Re=>{e(D)?Re(Bt):Re(Tt,!1)},!0)}l(je,Ue)};c(J,je=>{e(r)?je(we,!1):je(fe)},!0)}l(ne,ve)};c(U,ne=>{e(S)?ne(I):ne(Ae,!1)},!0)}l(o,O)};c(ee,o=>{e(F)?o(Ee):o(Te,!1)})}t(M);var te=s(M,2);{var ae=o=>{var O=vs();O.__click=()=>f(y,!1);var U=a(O);U.__click=we=>we.stopPropagation();var I=s(a(U),2),Ae=a(I);t(I);var ne=s(I,2),ve=a(ne);ve.__click=()=>f(y,!1);var J=s(ve,2);J.__click=$;var fe=a(J,!0);t(J),t(ne),t(U),t(O),_(()=>{v(Ae,`Are you sure you want to delete "${(e(r)?.name||"this batch")??""}"? This cannot be undone.`),ve.disabled=e(x),J.disabled=e(x),v(fe,e(x)?"Deleting...":"Delete Batch")}),l(o,O)};c(te,o=>{e(y)&&o(ae)})}l(L,A),Pe(),j()}$e(["click","change"]);export{Ss as component,Fs as universal};
