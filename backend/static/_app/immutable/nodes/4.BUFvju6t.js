import{d as Ma,f as g,a as u,c as pe,s as d}from"../chunks/BMR6TOGE.js";import{aa as Aa,ap as Oa,ab as Ea,aD as Pa,ac as s,ad as t,b as e,ae as Va,an as M,af as a,s as j,ao as N,au as A,aq as b,ar as Pe}from"../chunks/CJ9U_lt3.js";import{e as Ia,i as Na}from"../chunks/Bv8p5TEf.js";import{i as m}from"../chunks/BK4Po838.js";import{h as Ra,s as za}from"../chunks/CHurcNvB.js";import{s as Ve}from"../chunks/CJgb9CkH.js";import{i as Ha,s as qa}from"../chunks/4F6_53_-.js";import{s as Ya,a as Ja}from"../chunks/CjMG55H5.js";import{p as Ka}from"../chunks/OIlHNTYf.js";import{g as Qa}from"../chunks/DpgVq-x9.js";import{a as Wa,b as Ie,u as Ne,d as Xa}from"../chunks/C_g1FNU9.js";import{d as Za,e as et,h as at,g as tt}from"../chunks/BZ207_Dj.js";import{t as st}from"../chunks/7aIyeNsM.js";import{B as rt}from"../chunks/BLXs8lYI.js";const vt=!1,Vt=Object.freeze(Object.defineProperty({__proto__:null,prerender:vt},Symbol.toStringTag,{value:"Module"}));var it=g('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),lt=g('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),nt=g('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),dt=g('<span class="recipe-type svelte-g5au2j"> </span>'),ut=g('<a class="recipe-link svelte-g5au2j"> <!></a>'),ot=g('<option class="svelte-g5au2j"> </option>'),ct=g('<span class="live-badge svelte-g5au2j"><span class="live-dot svelte-g5au2j"></span> Live</span>'),gt=g('<div class="stat-item svelte-g5au2j"><div class="stat-value temp svelte-g5au2j"> </div> <div class="stat-label svelte-g5au2j"> </div></div>'),pt=g('<div class="stat-card live svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Current</span> <!></div> <div class="stat-row svelte-g5au2j"><div class="stat-item svelte-g5au2j"><div class="stat-value svelte-g5au2j"> </div> <div class="stat-label svelte-g5au2j"> </div></div> <!></div></div>'),_t=g('<div class="progress-remaining svelte-g5au2j"> </div>'),mt=g('<div class="stat-card svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Progress</span></div> <div class="progress-display svelte-g5au2j"><div class="progress-value svelte-g5au2j"> </div> <div class="progress-bar-container svelte-g5au2j"><div class="progress-bar svelte-g5au2j"></div></div> <!></div></div>'),ft=g('<div class="measurement wide svelte-g5au2j"><span class="measurement-label svelte-g5au2j">Yeast</span> <span class="measurement-value target svelte-g5au2j"> </span></div>'),jt=g('<div class="stat-card svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Recipe Targets</span></div> <div class="measurements-grid svelte-g5au2j"><div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">OG</span> <span class="measurement-value target svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">FG</span> <span class="measurement-value target svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">ABV</span> <span class="measurement-value target svelte-g5au2j"> </span></div> <!></div></div>'),bt=g('<div class="device-status online svelte-g5au2j"><span class="device-dot svelte-g5au2j"></span> </div> <div class="device-last-seen svelte-g5au2j">Updated just now</div>',1),ht=g('<div class="device-status offline svelte-g5au2j"><span class="device-dot svelte-g5au2j"></span> </div> <div class="device-last-seen svelte-g5au2j">Not receiving data</div>',1),xt=g('<div class="device-info svelte-g5au2j"><!></div>'),yt=g('<div class="no-device svelte-g5au2j"><span class="svelte-g5au2j">No device assigned</span> <button type="button" class="link-btn svelte-g5au2j">Link a device</button></div>'),kt=g('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Notes</h3> <p class="notes-content svelte-g5au2j"> </p></div>'),wt=g('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!> <div class="stat-card svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Measurements</span></div> <div class="measurements-grid svelte-g5au2j"><div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">OG</span> <span class="measurement-value svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">FG</span> <span class="measurement-value svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">ABV</span> <span class="measurement-value svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">Atten</span> <span class="measurement-value svelte-g5au2j"> </span></div></div></div> <!></div> <div class="info-section svelte-g5au2j"><div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Timeline</h3> <div class="timeline svelte-g5au2j"><div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Date</span> <span class="timeline-value svelte-g5au2j"> </span></div> <div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Started</span> <span class="timeline-value svelte-g5au2j"> </span></div> <div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Ended</span> <span class="timeline-value svelte-g5au2j"> </span></div> <div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Created</span> <span class="timeline-value svelte-g5au2j"> </span></div></div></div> <div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Tracking Device</h3> <!></div> <!></div></div>',1),Bt=g('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div>');function It(Re,ze){Aa(ze,!0);const He=()=>Ja(Ka,"$page",qe),[qe,Ye]=Ya();let r=M(null),x=M(null),Y=M(!0),R=M(null),O=M(!1),z=M(!1),_e=N(()=>parseInt(He().params.id));const J={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},Je=["planning","fermenting","conditioning","completed","archived"];let me=N(()=>e(r)?J[e(r).status]:J.planning),Ke=N(et),Qe=N(tt),C=N(()=>e(r)?.device_id?st.tilts.get(e(r).device_id):null);async function fe(){j(Y,!0),j(R,null);try{if(j(r,await Wa(e(_e)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{j(x,await Ie(e(_e)),!0)}catch{}}catch(l){j(R,l instanceof Error?l.message:"Failed to load batch",!0)}finally{j(Y,!1)}}async function We(l){if(!(!e(r)||e(z))){j(z,!0);try{j(r,await Ne(e(r).id,{status:l}),!0),(l==="fermenting"||l==="conditioning")&&j(x,await Ie(e(r).id),!0)}catch(D){console.error("Failed to update status:",D)}finally{j(z,!1)}}}async function Xe(l){e(r)&&(j(r,await Ne(e(r).id,l),!0),j(O,!1))}async function Ze(){if(e(r)&&confirm(`Are you sure you want to delete "${e(r).name||"this batch"}"?`))try{await Xa(e(r).id),Qa("/batches")}catch{alert("Failed to delete batch")}}function E(l){return l==null?"--":Za(l)}function ea(l){return l==null?"--":at(l)}function aa(l){return l?new Date(l).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"}):"--"}function K(l){return l?new Date(l).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}):"--"}Oa(()=>{fe()});var Q=Bt();Ra("g5au2j",l=>{Pa(()=>{Va.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var ta=s(t(Q),2);{var sa=l=>{var D=it();u(l,D)},ra=l=>{var D=pe(),va=A(D);{var ia=S=>{var T=lt(),P=s(t(T),2),W=t(P,!0);a(P);var X=s(P,2);X.__click=fe,a(T),b(()=>d(W,e(R))),u(S,T)},la=S=>{var T=pe(),P=A(T);{var W=U=>{var H=nt();u(U,H)},X=U=>{var H=pe(),na=A(H);{var da=G=>{rt(G,{get batch(){return e(r)},onSubmit:Xe,onCancel:()=>j(O,!1)})},ua=G=>{var je=wt(),Z=A(je),ee=t(Z),ae=t(ee),oa=t(ae);a(ae);var be=s(ae,2),te=t(be),ca=t(te,!0);a(te);var ga=s(te,2);{var pa=i=>{var v=ut(),n=t(v),p=s(n);{var f=o=>{var c=dt(),_=t(c);a(c),b(()=>d(_,`(${e(r).recipe.type??""})`)),u(o,c)};m(p,o=>{e(r).recipe.type&&o(f)})}a(v),b(()=>{za(v,"href",`/recipes/${e(r).recipe.id??""}`),d(n,`${e(r).recipe.name??""} `)}),u(i,v)};m(ga,i=>{e(r).recipe&&i(pa)})}a(be),a(ee);var he=s(ee,2),se=t(he),w=t(se);w.__change=i=>We(i.currentTarget.value),Ia(w,21,()=>Je,Na,(i,v)=>{var n=ot(),p=t(n,!0);a(n);var f={};b(()=>{d(p,J[e(v)].label),f!==(f=e(v))&&(n.value=(n.__value=e(v))??"")}),u(i,n)}),a(w);var xe;Ha(w),a(se);var ye=s(se,2);ye.__click=()=>j(O,!0);var _a=s(ye,2);_a.__click=Ze,a(he),a(Z);var ke=s(Z,2),re=t(ke),we=t(re);{var ma=i=>{var v=pt(),n=t(v),p=s(t(n),2);{var f=y=>{var k=ct();u(y,k)};m(p,y=>{e(C)&&y(f)})}a(n);var o=s(n,2),c=t(o),_=t(c),B=t(_,!0);a(_);var h=s(_,2),F=t(h,!0);a(h),a(c);var V=s(c,2);{var I=y=>{var k=gt(),$=t(k),L=t($,!0);a($);var q=s($,2),Ga=t(q,!0);a(q),a(k),b(La=>{d(L,La),d(Ga,e(Qe))},[()=>ea(e(C)?.temp??e(x)?.temperature?.current)]),u(y,k)};m(V,y=>{(e(C)?.temp!=null||e(x)?.temperature?.current!=null)&&y(I)})}a(o),a(v),b(y=>{d(B,y),d(F,e(Ke))},[()=>E(e(C)?.sg??e(x)?.measured?.current_sg)]),u(i,v)};m(we,i=>{(e(C)||e(x)?.measured?.current_sg!=null)&&i(ma)})}var Be=s(we,2);{var fa=i=>{var v=mt(),n=s(t(v),2),p=t(n),f=t(p);a(p);var o=s(p,2),c=t(o);a(o);var _=s(o,2);{var B=h=>{var F=_t(),V=t(F);a(F),b(I=>d(V,`${I??""} SG remaining`),[()=>e(x).progress.sg_remaining.toFixed(3)]),u(h,F)};m(_,h=>{e(x).progress.sg_remaining!=null&&h(B)})}a(n),a(v),b(h=>{d(f,`${h??""}%`),Ve(c,`width: ${e(x).progress.percent_complete??""}%`)},[()=>e(x).progress.percent_complete.toFixed(0)]),u(i,v)};m(Be,i=>{e(x)?.progress?.percent_complete!=null&&i(fa)})}var ve=s(Be,2),$e=s(t(ve),2),ie=t($e),Fe=s(t(ie),2),ja=t(Fe,!0);a(Fe),a(ie);var le=s(ie,2),Ce=s(t(le),2),ba=t(Ce,!0);a(Ce),a(le);var ne=s(le,2),De=s(t(ne),2),ha=t(De,!0);a(De),a(ne);var Se=s(ne,2),Te=s(t(Se),2),xa=t(Te,!0);a(Te),a(Se),a($e),a(ve);var ya=s(ve,2);{var ka=i=>{var v=jt(),n=s(t(v),2),p=t(n),f=s(t(p),2),o=t(f,!0);a(f),a(p);var c=s(p,2),_=s(t(c),2),B=t(_,!0);a(_),a(c);var h=s(c,2),F=s(t(h),2),V=t(F,!0);a(F),a(h);var I=s(h,2);{var y=k=>{var $=ft(),L=s(t($),2),q=t(L,!0);a(L),a($),b(()=>d(q,e(r).recipe.yeast_name)),u(k,$)};m(I,k=>{e(r).recipe.yeast_name&&k(y)})}a(n),a(v),b((k,$,L)=>{d(o,k),d(B,$),d(V,L)},[()=>E(e(r).recipe.og_target),()=>E(e(r).recipe.fg_target),()=>e(r).recipe.abv_target!=null?`${e(r).recipe.abv_target.toFixed(1)}%`:"--"]),u(i,v)};m(ya,i=>{e(r).recipe&&i(ka)})}a(re);var Ue=s(re,2),de=t(Ue),Ge=s(t(de),2),ue=t(Ge),Le=s(t(ue),2),wa=t(Le,!0);a(Le),a(ue);var oe=s(ue,2),Me=s(t(oe),2),Ba=t(Me,!0);a(Me),a(oe);var ce=s(oe,2),Ae=s(t(ce),2),$a=t(Ae,!0);a(Ae),a(ce);var Oe=s(ce,2),Ee=s(t(Oe),2),Fa=t(Ee,!0);a(Ee),a(Oe),a(Ge),a(de);var ge=s(de,2),Ca=s(t(ge),2);{var Da=i=>{var v=xt(),n=t(v);{var p=o=>{var c=bt(),_=A(c),B=s(t(_));a(_),Pe(2),b(()=>d(B,` ${e(C).color??""} Tilt - Connected`)),u(o,c)},f=o=>{var c=ht(),_=A(c),B=s(t(_));a(_),Pe(2),b(()=>d(B,` Device: ${e(r).device_id??""}`)),u(o,c)};m(n,o=>{e(C)?o(p):o(f,!1)})}a(v),u(i,v)},Sa=i=>{var v=yt(),n=s(t(v),2);n.__click=()=>j(O,!0),a(v),u(i,v)};m(Ca,i=>{e(r).device_id?i(Da):i(Sa,!1)})}a(ge);var Ta=s(ge,2);{var Ua=i=>{var v=kt(),n=s(t(v),2),p=t(n,!0);a(n),a(v),b(()=>d(p,e(r).notes)),u(i,v)};m(Ta,i=>{e(r).notes&&i(Ua)})}a(Ue),a(ke),b((i,v,n,p,f,o,c,_)=>{d(oa,`#${(e(r).batch_number||"?")??""}`),d(ca,e(r).name||e(r).recipe?.name||"Unnamed Batch"),w.disabled=e(z),Ve(w,`color: ${e(me).color??""}; background: ${e(me).bg??""};`),xe!==(xe=e(r).status)&&(w.value=(w.__value=e(r).status)??"",qa(w,e(r).status)),d(ja,i),d(ba,v),d(ha,n),d(xa,p),d(wa,f),d(Ba,o),d($a,c),d(Fa,_)},[()=>E(e(r).measured_og),()=>E(e(r).measured_fg),()=>e(r).measured_abv!=null?`${e(r).measured_abv.toFixed(1)}%`:"--",()=>e(r).measured_attenuation!=null?`${e(r).measured_attenuation.toFixed(0)}%`:"--",()=>aa(e(r).brew_date),()=>K(e(r).start_time),()=>K(e(r).end_time),()=>K(e(r).created_at)]),u(G,je)};m(na,G=>{e(O)?G(da):G(ua,!1)},!0)}u(U,H)};m(P,U=>{e(r)?U(X,!1):U(W)},!0)}u(S,T)};m(va,S=>{e(R)?S(ia):S(la,!1)},!0)}u(l,D)};m(ta,l=>{e(Y)?l(sa):l(ra,!1)})}a(Q),u(Re,Q),Ea(),Ye()}Ma(["click","change"]);export{It as component,Vt as universal};
