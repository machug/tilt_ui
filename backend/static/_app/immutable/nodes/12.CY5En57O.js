import{d as la,f as d,a as c,s as g,t as Ke,b as lt}from"../chunks/BQ88CgEU.js";import{ah as ra,ao as o,p as oa,ap as ca,aq as va,aj as da,s as n,e as pa,ak as a,al as t,c as e,ai as it,am as ha,an as s,at as F,as as A,ar as Ve}from"../chunks/CGXqq0_G.js";import{e as ua,i as _a}from"../chunks/payu-7ZH.js";import{i as h}from"../chunks/ziKwUJ4R.js";import{h as fa}from"../chunks/BP8qDDK3.js";import{r as N,s as L}from"../chunks/D2zVhfuI.js";import{s as H}from"../chunks/DqcjHxzZ.js";import{b as J}from"../chunks/CL9D8AtU.js";import{i as ga,s as ma,b as ja}from"../chunks/C5J5lxM1.js";import{c as m,f as ba,u as Ye,a as ya}from"../chunks/Do2ytZ8P.js";var wa=d('<div class="loading-state svelte-hj1sc2"><div class="loading-spinner svelte-hj1sc2"></div> <span class="svelte-hj1sc2">Loading system information...</span></div>'),Sa=d('<div class="info-grid svelte-hj1sc2"><div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Hostname</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Version</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Uptime</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">IP Address</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div></div>'),xa=d('<p class="text-muted svelte-hj1sc2">Unable to load system information</p>'),ka=d('<div class="setting-row sub-setting svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Smoothing Samples</span> <span class="setting-description svelte-hj1sc2">Number of readings to average</span></div> <select class="select-input-sm svelte-hj1sc2"><option class="svelte-hj1sc2">3</option><option class="svelte-hj1sc2">5</option><option class="svelte-hj1sc2">10</option><option class="svelte-hj1sc2">15</option><option class="svelte-hj1sc2">20</option></select></div>'),Ta=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Ca=d('<p class="config-error svelte-hj1sc2"> </p>'),Aa=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Fa=d('<option class="svelte-hj1sc2"> </option>'),za=d('<div class="loading-spinner-small svelte-hj1sc2"></div>'),Ea=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Connection Status</span></div> <span> </span></div>'),Ma=d("<span> </span>"),Ha=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Ua=d('<p class="config-error svelte-hj1sc2"> </p>'),Pa=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Ra=d('<!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Home Assistant URL</span> <span class="setting-description svelte-hj1sc2">e.g., http://192.168.1.100:8123</span></div> <input type="url" placeholder="http://homeassistant.local:8123" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Access Token</span> <span class="setting-description svelte-hj1sc2">Long-lived access token from HA profile</span></div> <input type="password" placeholder="Enter token..." class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Test Connection</span></div> <div class="test-connection svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Temp Entity</span> <span class="setting-description svelte-hj1sc2">e.g., sensor.fermenter_room_temperature</span></div> <input type="text" placeholder="sensor.xxx_temperature" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Humidity Entity</span> <span class="setting-description svelte-hj1sc2">Optional humidity sensor</span></div> <input type="text" placeholder="sensor.xxx_humidity" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Weather Entity</span> <span class="setting-description svelte-hj1sc2">For forecast display, e.g., weather.home</span></div> <input type="text" placeholder="weather.home" class="input-field svelte-hj1sc2"/></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),Ia=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Ba=d('<p class="config-error svelte-hj1sc2"> </p>'),Da=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Oa=d(`<p class="section-note svelte-hj1sc2">Configure heater switches per batch. These are the default settings used when a batch doesn't specify its own.</p> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Default Target Temperature</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" step="0.5" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Default Hysteresis</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>`,1),Na=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Temperature Control</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Temperature Control</span> <span class="setting-description svelte-hj1sc2">Automatically control heaters for batches</span></div> <button type="button" aria-label="Toggle temperature control"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div>'),La=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Alert Threshold</span> <span class="setting-description svelte-hj1sc2">Alert when forecast differs from target by this amount (°C)</span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" min="1" max="15" step="0.5" class="input-field-sm svelte-hj1sc2"/> <span class="unit svelte-hj1sc2">°C</span></div></div> <p class="setting-hint mt-2 svelte-hj1sc2">Alerts are generated when the forecast high or low temperatures differ from your target fermentation temperature by more than the threshold.</p>',1),Ja=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Ga=d('<p class="config-error svelte-hj1sc2"> </p>'),Wa=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),qa=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Weather Alerts</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Weather Alerts</span> <span class="setting-description svelte-hj1sc2">Get alerts when forecast temps may affect fermentation</span></div> <button type="button" aria-label="Toggle weather alerts"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div>'),Ka=d('<div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Total Readings</span></div> <div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Estimated Size</span></div>',1),Va=d('<p class="text-muted svelte-hj1sc2">Unable to load storage stats</p>'),Ya=d('<button type="button" class="btn-danger-sm svelte-hj1sc2"> </button>'),Qa=d('<p class="cleanup-message svelte-hj1sc2"> </p>'),Xa=d('<span class="loading-dot svelte-hj1sc2"></span> Rebooting...',1),Za=lt('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" class="svelte-hj1sc2"></path></svg> Reboot System',1),$a=d('<span class="loading-dot svelte-hj1sc2"></span> Shutting down...',1),en=lt('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" class="svelte-hj1sc2"></path></svg> Shutdown System',1),sn=d('<div class="grid gap-6 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">System Information</h2></div> <div class="card-body svelte-hj1sc2"><!></div></div> <div class="grid gap-6 md:grid-cols-2 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Application Settings</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Temperature Units</span> <span class="setting-description svelte-hj1sc2">Display temperature in Celsius or Fahrenheit</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">°C</button> <button type="button">°F</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Gravity Units</span> <span class="setting-description svelte-hj1sc2">Display gravity as SG, Plato, or Brix</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">SG</button> <button type="button">°P</button> <button type="button">°Bx</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Minimum RSSI</span> <span class="setting-description svelte-hj1sc2">Ignore readings below this signal strength</span></div> <div class="rssi-input svelte-hj1sc2"><input type="number" min="-100" max="0" class="input-field-sm svelte-hj1sc2"/> <span class="input-suffix svelte-hj1sc2">dBm</span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Reading Smoothing</span> <span class="setting-description svelte-hj1sc2">Average multiple readings to reduce noise</span></div> <button type="button" aria-label="Toggle reading smoothing"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Identify by MAC</span> <span class="setting-description svelte-hj1sc2">Use MAC address instead of broadcast ID</span></div> <button type="button" aria-label="Toggle identify by MAC address"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Timezone</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description svelte-hj1sc2">Current timezone: <span class="font-mono text-[var(--accent)] svelte-hj1sc2"> </span></p> <div class="timezone-selector svelte-hj1sc2"><select class="select-input svelte-hj1sc2"></select> <!></div></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Home Assistant</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Integration</span> <span class="setting-description svelte-hj1sc2">Connect to Home Assistant for ambient temp and control</span></div> <button type="button" aria-label="Enable Home Assistant integration"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div> <!> <!> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Storage & Data Cleanup</h2></div> <div class="card-body svelte-hj1sc2"><div class="storage-grid svelte-hj1sc2"><div class="storage-stats svelte-hj1sc2"><!></div> <div class="cleanup-section svelte-hj1sc2"><p class="section-description mb-3 svelte-hj1sc2">Remove old readings to free up storage. Readings older than the specified days will be permanently deleted.</p> <div class="cleanup-controls svelte-hj1sc2"><div class="cleanup-input-group svelte-hj1sc2"><label for="retention-days" class="svelte-hj1sc2">Keep readings from last</label> <input id="retention-days" type="number" min="1" max="365" class="input-field-sm svelte-hj1sc2"/> <span class="svelte-hj1sc2">days</span></div> <div class="cleanup-actions svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <!></div></div></div></div> <div class="card danger-zone svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Power Controls</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description danger-text svelte-hj1sc2">These actions will affect the entire system. Make sure you have saved any pending work.</p> <div class="power-buttons svelte-hj1sc2"><button type="button" class="btn-warning svelte-hj1sc2"><!></button> <button type="button" class="btn-danger svelte-hj1sc2"><!></button></div></div></div></div>'),tn=d('<div class="page-container svelte-hj1sc2"><div class="page-header svelte-hj1sc2"><h1 class="page-title svelte-hj1sc2">System</h1> <p class="page-description svelte-hj1sc2">System settings, timezone configuration, and power controls</p> <div class="header-actions svelte-hj1sc2"><a href="/system/maintenance" class="btn-secondary-link svelte-hj1sc2"><svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" class="svelte-hj1sc2"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" class="svelte-hj1sc2"></path></svg> Data Maintenance</a></div></div> <!></div>');function un(rt,ot){ra(ot,!0);let ee=o(null),ye=o(null),js=o(oa([])),re=o(""),bs=o(!0),j=o(null),oe=o("C"),Y=o("sg"),we=o(-100),se=o(!1),Se=o(5),ce=o(!1),xe=o(!1),ke=o(null),Te=o(!1),ve=o(30),R=o(null),G=o(!1),de=o(""),pe=o(""),Ce=o(""),Ae=o(""),_e=o(""),Fe=o(!1),te=o(null),ze=o(null),Ee=o(!1),Me=o(null),He=o(!1),ae=o(!1),Ue=o(68),fe=o(1),Pe=o(!1),Re=o(null),Ie=o(!1),ne=o(!1),Be=o(3),De=o(!1),Oe=o(null),Ne=o(!1),W=it(()=>m.config.temp_units==="C"),Le=it(()=>e(W)?"°C":"°F");function ct(i){return e(W)?ya(i):i}function vt(i){return e(W)?ba(i):i}async function dt(){try{const i=await fetch("/api/system/info");i.ok&&n(ee,await i.json(),!0)}catch(i){console.error("Failed to load system info:",i)}}async function ys(){try{const i=await fetch("/api/system/storage");i.ok&&n(ye,await i.json(),!0)}catch(i){console.error("Failed to load storage stats:",i)}}async function pt(){try{const[i,T]=await Promise.all([fetch("/api/system/timezones"),fetch("/api/system/timezone")]);if(i.ok){const z=await i.json();n(js,z.timezones||[],!0)}if(T.ok){const z=await T.json();n(re,z.timezone||"UTC",!0)}}catch(i){console.error("Failed to load timezones:",i)}}function ws(){n(oe,m.config.temp_units,!0),n(Y,m.config.sg_units,!0),n(we,m.config.min_rssi,!0),n(se,m.config.smoothing_enabled,!0),n(Se,m.config.smoothing_samples,!0),n(ce,m.config.id_by_mac,!0),n(G,m.config.ha_enabled,!0),n(de,m.config.ha_url,!0),n(pe,m.config.ha_token,!0),n(Ce,m.config.ha_ambient_temp_entity_id,!0),n(Ae,m.config.ha_ambient_humidity_entity_id,!0),n(_e,m.config.ha_weather_entity_id,!0),n(ae,m.config.temp_control_enabled,!0),n(Ue,Math.round(vt(m.config.temp_target)*2)/2),n(fe,m.config.temp_units==="C"?Math.round(m.config.temp_hysteresis*(5/9)*100)/100:m.config.temp_hysteresis,!0),n(ne,m.config.weather_alerts_enabled,!0),n(Be,m.config.alert_temp_threshold,!0)}async function ht(){n(xe,!0),n(ke,null),n(Te,!1);try{const i=await Ye({temp_units:e(oe),sg_units:e(Y),min_rssi:e(we),smoothing_enabled:e(se),smoothing_samples:e(Se),id_by_mac:e(ce)});i.success?(n(Te,!0),setTimeout(()=>n(Te,!1),3e3)):n(ke,i.error||"Failed to save settings",!0)}finally{n(xe,!1)}}async function ut(){n(Ee,!0),n(Me,null),n(He,!1);try{const i=await Ye({ha_enabled:e(G),ha_url:e(de),ha_token:e(pe),ha_ambient_temp_entity_id:e(Ce),ha_ambient_humidity_entity_id:e(Ae),ha_weather_entity_id:e(_e)});i.success?(n(He,!0),setTimeout(()=>n(He,!1),3e3),await xs()):n(Me,i.error||"Failed to save settings",!0)}finally{n(Ee,!1)}}async function _t(){n(Pe,!0),n(Re,null),n(Ie,!1);try{const i=ct(e(Ue)),T=e(W)?e(fe)*(9/5):e(fe),z=await Ye({temp_control_enabled:e(ae),temp_target:i,temp_hysteresis:T});z.success?(n(Ie,!0),setTimeout(()=>n(Ie,!1),3e3)):n(Re,z.error||"Failed to save settings",!0)}finally{n(Pe,!1)}}async function ft(){n(De,!0),n(Oe,null),n(Ne,!1);try{const i=await Ye({weather_alerts_enabled:e(ne),alert_temp_threshold:e(Be)});i.success?(n(Ne,!0),setTimeout(()=>n(Ne,!1),3e3)):n(Oe,i.error||"Failed to save settings",!0)}finally{n(De,!1)}}async function gt(i){n(j,"timezone");try{(await fetch("/api/system/timezone",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({timezone:i})})).ok&&n(re,i,!0)}catch(T){console.error("Failed to set timezone:",T)}finally{n(j,null)}}async function mt(){n(j,"cleanup-preview");try{const i=await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(ve),confirm:!1})});i.ok&&n(R,await i.json(),!0)}catch(i){console.error("Failed to preview cleanup:",i)}finally{n(j,null)}}async function jt(){if(!(!e(R)||e(R).readings_to_delete===0)&&confirm(`Delete ${e(R).readings_to_delete.toLocaleString()} readings older than ${e(ve)} days?`)){n(j,"cleanup");try{(await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(ve),confirm:!0})})).ok&&(n(R,null),await ys())}catch(i){console.error("Failed to execute cleanup:",i)}finally{n(j,null)}}}async function bt(){if(confirm("Are you sure you want to reboot the system? The UI will be unavailable until restart completes.")){n(j,"reboot");try{await fetch("/api/system/reboot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Reboot command failed:",i)}finally{n(j,null)}}}async function yt(){if(confirm("Are you sure you want to shut down the system? You will need physical access to restart.")){n(j,"shutdown");try{await fetch("/api/system/shutdown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Shutdown command failed:",i)}finally{n(j,null)}}}function wt(i){if(!i)return"Unknown";const T=Math.floor(i/86400),z=Math.floor(i%86400/3600),ge=Math.floor(i%3600/60),ie=[];return T>0&&ie.push(`${T}d`),z>0&&ie.push(`${z}h`),ge>0&&ie.push(`${ge}m`),ie.length>0?ie.join(" "):"< 1m"}function St(i){return!Number.isFinite(i)||i<0?"0 B":i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(1)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`}function Ss(i){return i.toLocaleString()}async function xt(){n(Fe,!0),n(te,null);try{const i=await fetch("/api/ha/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e(de),token:e(pe)})});i.ok?n(te,await i.json(),!0):n(te,{success:!1,message:"Request failed"},!0)}catch{n(te,{success:!1,message:"Network error"},!0)}finally{n(Fe,!1)}}async function xs(){try{const i=await fetch("/api/ha/status");i.ok&&n(ze,await i.json(),!0)}catch(i){console.error("Failed to load HA status:",i)}}ca(async()=>{await Promise.all([dt(),ys(),pt(),xs()]),ws(),n(bs,!1)}),va(()=>{m.loaded&&ws()});var Qe=tn();fa("hj1sc2",i=>{pa(()=>{ha.title="System | BrewSignal"})});var kt=a(t(Qe),2);{var Tt=i=>{var T=wa();c(i,T)},Ct=i=>{var T=sn(),z=t(T),ge=a(t(z),2),ie=t(ge);{var At=l=>{var r=Sa(),p=t(r),u=a(t(p),2),f=t(u,!0);s(u),s(p);var w=a(p,2),S=a(t(w),2),E=t(S);s(S),s(w);var x=a(w,2),C=a(t(x),2),M=t(C,!0);s(C),s(x);var I=a(x,2),K=a(t(I),2),Q=t(K,!0);s(K),s(I),s(r),A(B=>{g(f,e(ee).hostname),g(E,`v${e(ee).version??""}`),g(M,B),g(Q,e(ee).ip_addresses.length>0?e(ee).ip_addresses[0]:"Unknown")},[()=>wt(e(ee).uptime_seconds)]),c(l,r)},Ft=l=>{var r=xa();c(l,r)};h(ie,l=>{e(ee)?l(At):l(Ft,!1)})}s(ge),s(z);var Xe=a(z,2),Ze=t(Xe),ks=a(t(Ze),2),$e=t(ks),Ts=a(t($e),2),es=t(Ts);let Cs;es.__click=()=>n(oe,"C");var As=a(es,2);let Fs;As.__click=()=>n(oe,"F"),s(Ts),s($e);var ss=a($e,2),zs=a(t(ss),2),ts=t(zs);let Es;ts.__click=()=>n(Y,"sg");var as=a(ts,2);let Ms;as.__click=()=>n(Y,"plato");var Hs=a(as,2);let Us;Hs.__click=()=>n(Y,"brix"),s(zs),s(ss);var ns=a(ss,2),Ps=a(t(ns),2),Rs=t(Ps);N(Rs),F(2),s(Ps),s(ns);var is=a(ns,2),ls=a(t(is),2);let Is;ls.__click=()=>n(se,!e(se)),s(is);var Bs=a(is,2);{var zt=l=>{var r=ka(),p=a(t(r),2),u=t(p);u.value=u.__value=3;var f=a(u);f.value=f.__value=5;var w=a(f);w.value=w.__value=10;var S=a(w);S.value=S.__value=15;var E=a(S);E.value=E.__value=20,s(p),s(r),ja(p,()=>e(Se),x=>n(Se,x)),c(l,r)};h(Bs,l=>{e(se)&&l(zt)})}var rs=a(Bs,2),os=a(t(rs),2);let Ds;os.__click=()=>n(ce,!e(ce)),s(rs);var Os=a(rs,2),me=t(Os);me.__click=ht;var Et=t(me);{var Mt=l=>{var r=Ta();F(),c(l,r)},Ht=l=>{var r=Ke("Save Settings");c(l,r)};h(Et,l=>{e(xe)?l(Mt):l(Ht,!1)})}s(me);var Ns=a(me,2);{var Ut=l=>{var r=Ca(),p=t(r,!0);s(r),A(()=>g(p,e(ke))),c(l,r)};h(Ns,l=>{e(ke)&&l(Ut)})}var Pt=a(Ns,2);{var Rt=l=>{var r=Aa();c(l,r)};h(Pt,l=>{e(Te)&&l(Rt)})}s(Os),s(ks),s(Ze);var Ls=a(Ze,2),Js=a(t(Ls),2),cs=t(Js),Gs=a(t(cs)),It=t(Gs,!0);s(Gs),s(cs);var Ws=a(cs,2),q=t(Ws);q.__change=l=>gt(l.currentTarget.value),ua(q,21,()=>e(js),_a,(l,r)=>{var p=Fa(),u=t(p,!0);s(p);var f={};A(()=>{g(u,e(r)),f!==(f=e(r))&&(p.value=(p.__value=e(r))??"")}),c(l,p)}),s(q);var qs;ga(q);var Bt=a(q,2);{var Dt=l=>{var r=za();c(l,r)};h(Bt,l=>{e(j)==="timezone"&&l(Dt)})}s(Ws),s(Js),s(Ls),s(Xe);var vs=a(Xe,2),Ks=a(t(vs),2),ds=t(Ks),ps=a(t(ds),2);let Vs;ps.__click=()=>n(G,!e(G)),s(ds);var Ot=a(ds,2);{var Nt=l=>{var r=Ra(),p=Ve(r);{var u=v=>{var y=Ea(),P=a(t(y),2);let ue;var ms=t(P,!0);s(P),s(y),A(()=>{ue=H(P,1,"status-badge svelte-hj1sc2",null,ue,{connected:e(ze).connected}),g(ms,e(ze).connected?"Connected":"Disconnected")}),c(v,y)};h(p,v=>{e(ze)&&v(u)})}var f=a(p,2),w=a(t(f),2);N(w),s(f);var S=a(f,2),E=a(t(S),2);N(E),s(S);var x=a(S,2),C=a(t(x),2),M=t(C);M.__click=xt;var I=t(M,!0);s(M);var K=a(M,2);{var Q=v=>{var y=Ma();let P;var ue=t(y,!0);s(y),A(()=>{P=H(y,1,"test-result svelte-hj1sc2",null,P,{success:e(te).success}),g(ue,e(te).message)}),c(v,y)};h(K,v=>{e(te)&&v(Q)})}s(C),s(x);var B=a(x,2),D=a(t(B),2);N(D),s(B);var X=a(B,2),_=a(t(X),2);N(_),s(X);var b=a(X,2),U=a(t(b),2);N(U),s(b);var Z=a(b,2),O=t(Z);O.__click=ut;var he=t(O);{var $=v=>{var y=Ha();F(),c(v,y)},Ge=v=>{var y=Ke("Save HA Settings");c(v,y)};h(he,v=>{e(Ee)?v($):v(Ge,!1)})}s(O);var We=a(O,2);{var qe=v=>{var y=Ua(),P=t(y,!0);s(y),A(()=>g(P,e(Me))),c(v,y)};h(We,v=>{e(Me)&&v(qe)})}var le=a(We,2);{var gs=v=>{var y=Pa();c(v,y)};h(le,v=>{e(He)&&v(gs)})}s(Z),A(()=>{M.disabled=e(Fe)||!e(de)||!e(pe),g(I,e(Fe)?"Testing...":"Test"),O.disabled=e(Ee)}),J(w,()=>e(de),v=>n(de,v)),J(E,()=>e(pe),v=>n(pe,v)),J(D,()=>e(Ce),v=>n(Ce,v)),J(_,()=>e(Ae),v=>n(Ae,v)),J(U,()=>e(_e),v=>n(_e,v)),c(l,r)};h(Ot,l=>{e(G)&&l(Nt)})}s(Ks),s(vs);var Ys=a(vs,2);{var Lt=l=>{var r=Na(),p=a(t(r),2),u=t(p),f=a(t(u),2);let w;f.__click=()=>n(ae,!e(ae)),s(u);var S=a(u,2);{var E=x=>{var C=Oa(),M=a(Ve(C),2),I=t(M),K=a(t(I),2),Q=t(K);s(K),s(I);var B=a(I,2),D=t(B);N(D);var X=a(D,2),_=t(X,!0);s(X),s(B),s(M);var b=a(M,2),U=t(b),Z=a(t(U),2),O=t(Z);s(Z),s(U);var he=a(U,2),$=t(he);N($);var Ge=a($,2),We=t(Ge,!0);s(Ge),s(he),s(b);var qe=a(b,2),le=t(qe);le.__click=_t;var gs=t(le);{var v=k=>{var V=Ia();F(),c(k,V)},y=k=>{var V=Ke("Save Control Settings");c(k,V)};h(gs,k=>{e(Pe)?k(v):k(y,!1)})}s(le);var P=a(le,2);{var ue=k=>{var V=Ba(),ia=t(V,!0);s(V),A(()=>g(ia,e(Re))),c(k,V)};h(P,k=>{e(Re)&&k(ue)})}var ms=a(P,2);{var na=k=>{var V=Da();c(k,V)};h(ms,k=>{e(Ie)&&k(na)})}s(qe),A(()=>{g(Q,`Desired fermentation temperature (${e(Le)??""})`),L(D,"min",e(W)?0:32),L(D,"max",e(W)?38:100),g(_,e(Le)),g(O,`± tolerance before triggering (${e(Le)??""})`),L($,"min",e(W)?.3:.5),L($,"max",e(W)?5.5:10),L($,"step",e(W)?.25:.5),g(We,e(Le)),le.disabled=e(Pe)}),J(D,()=>e(Ue),k=>n(Ue,k)),J($,()=>e(fe),k=>n(fe,k)),c(x,C)};h(S,x=>{e(ae)&&x(E)})}s(p),s(r),A(()=>{w=H(f,1,"toggle svelte-hj1sc2",null,w,{active:e(ae)}),L(f,"aria-pressed",e(ae))}),c(l,r)};h(Ys,l=>{e(G)&&l(Lt)})}var Qs=a(Ys,2);{var Jt=l=>{var r=qa(),p=a(t(r),2),u=t(p),f=a(t(u),2);let w;f.__click=()=>n(ne,!e(ne)),s(u);var S=a(u,2);{var E=_=>{var b=La(),U=Ve(b),Z=a(t(U),2),O=t(Z);N(O),F(2),s(Z),s(U),F(2),J(O,()=>e(Be),he=>n(Be,he)),c(_,b)};h(S,_=>{e(ne)&&_(E)})}var x=a(S,2),C=t(x);C.__click=ft;var M=t(C);{var I=_=>{var b=Ja();F(),c(_,b)},K=_=>{var b=Ke("Save Alert Settings");c(_,b)};h(M,_=>{e(De)?_(I):_(K,!1)})}s(C);var Q=a(C,2);{var B=_=>{var b=Ga(),U=t(b,!0);s(b),A(()=>g(U,e(Oe))),c(_,b)};h(Q,_=>{e(Oe)&&_(B)})}var D=a(Q,2);{var X=_=>{var b=Wa();c(_,b)};h(D,_=>{e(Ne)&&_(X)})}s(x),s(p),s(r),A(()=>{w=H(f,1,"toggle svelte-hj1sc2",null,w,{active:e(ne)}),L(f,"aria-pressed",e(ne)),C.disabled=e(De)}),c(l,r)};h(Qs,l=>{e(G)&&e(_e)&&l(Jt)})}var hs=a(Qs,2),Xs=a(t(hs),2),Zs=t(Xs),us=t(Zs),Gt=t(us);{var Wt=l=>{var r=Ka(),p=Ve(r),u=t(p),f=t(u,!0);s(u),F(2),s(p);var w=a(p,2),S=t(w),E=t(S,!0);s(S),F(2),s(w),A((x,C)=>{g(f,x),g(E,C)},[()=>Ss(e(ye).total_readings),()=>St(e(ye).estimated_size_bytes)]),c(l,r)},qt=l=>{var r=Va();c(l,r)};h(Gt,l=>{e(ye)?l(Wt):l(qt,!1)})}s(us);var $s=a(us,2),_s=a(t($s),2),fs=t(_s),et=a(t(fs),2);N(et),F(2),s(fs);var st=a(fs,2),je=t(st);je.__click=mt;var Kt=t(je,!0);s(je);var Vt=a(je,2);{var Yt=l=>{var r=Ya();r.__click=jt;var p=t(r,!0);s(r),A(u=>{r.disabled=e(j)!==null,g(p,u)},[()=>e(j)==="cleanup"?"Deleting...":`Delete ${Ss(e(R).readings_to_delete)} readings`]),c(l,r)};h(Vt,l=>{e(R)&&e(R).readings_to_delete>0&&l(Yt)})}s(st),s(_s);var Qt=a(_s,2);{var Xt=l=>{var r=Qa(),p=t(r);s(r),A(()=>g(p,`No readings older than ${e(ve)??""} days found.`)),c(l,r)};h(Qt,l=>{e(R)&&e(R).readings_to_delete===0&&l(Xt)})}s($s),s(Zs),s(Xs),s(hs);var tt=a(hs,2),at=a(t(tt),2),nt=a(t(at),2),be=t(nt);be.__click=bt;var Zt=t(be);{var $t=l=>{var r=Xa();F(),c(l,r)},ea=l=>{var r=Za();F(),c(l,r)};h(Zt,l=>{e(j)==="reboot"?l($t):l(ea,!1)})}s(be);var Je=a(be,2);Je.__click=yt;var sa=t(Je);{var ta=l=>{var r=$a();F(),c(l,r)},aa=l=>{var r=en();F(),c(l,r)};h(sa,l=>{e(j)==="shutdown"?l(ta):l(aa,!1)})}s(Je),s(nt),s(at),s(tt),s(T),A(()=>{Cs=H(es,1,"unit-btn svelte-hj1sc2",null,Cs,{active:e(oe)==="C"}),Fs=H(As,1,"unit-btn svelte-hj1sc2",null,Fs,{active:e(oe)==="F"}),Es=H(ts,1,"unit-btn svelte-hj1sc2",null,Es,{active:e(Y)==="sg"}),Ms=H(as,1,"unit-btn svelte-hj1sc2",null,Ms,{active:e(Y)==="plato"}),Us=H(Hs,1,"unit-btn svelte-hj1sc2",null,Us,{active:e(Y)==="brix"}),Is=H(ls,1,"toggle svelte-hj1sc2",null,Is,{active:e(se)}),L(ls,"aria-pressed",e(se)),Ds=H(os,1,"toggle svelte-hj1sc2",null,Ds,{active:e(ce)}),L(os,"aria-pressed",e(ce)),me.disabled=e(xe),g(It,e(re)),q.disabled=e(j)==="timezone",qs!==(qs=e(re))&&(q.value=(q.__value=e(re))??"",ma(q,e(re))),Vs=H(ps,1,"toggle svelte-hj1sc2",null,Vs,{active:e(G)}),L(ps,"aria-pressed",e(G)),je.disabled=e(j)!==null,g(Kt,e(j)==="cleanup-preview"?"Checking...":"Preview"),be.disabled=e(j)!==null,Je.disabled=e(j)!==null}),J(Rs,()=>e(we),l=>n(we,l)),J(et,()=>e(ve),l=>n(ve,l)),c(i,T)};h(kt,i=>{e(bs)?i(Tt):i(Ct,!1)})}s(Qe),c(rt,Qe),da()}la(["click","change"]);export{un as component};
