import{d as Xa,f as d,a as c,s as _,t as ns,b as Bt}from"../chunks/BMR6TOGE.js";import{aa as Za,an as o,p as en,ap as sn,ai as tn,ab as an,s as n,e as nn,ac as a,ad as t,b as e,ao as It,ae as ln,af as s,ar as O,aq as T,au as is}from"../chunks/CJ9U_lt3.js";import{e as rn,i as on}from"../chunks/Bv8p5TEf.js";import{i as u}from"../chunks/BK4Po838.js";import{h as cn,r as R,s as W}from"../chunks/CHurcNvB.js";import{s as S}from"../chunks/aXqbUBLU.js";import{b as N}from"../chunks/CAiyxBcm.js";import{i as vn,s as dn,b as pn}from"../chunks/4F6_53_-.js";import{c as j,f as Pt,u as ls,b as un}from"../chunks/BZ207_Dj.js";import{a as Rt,f as Nt,t as Q}from"../chunks/7aIyeNsM.js";var hn=d('<div class="loading-state svelte-hj1sc2"><div class="loading-spinner svelte-hj1sc2"></div> <span class="svelte-hj1sc2">Loading system information...</span></div>'),_n=d('<div class="info-grid svelte-hj1sc2"><div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Hostname</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Version</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Uptime</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">IP Address</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div></div>'),fn=d('<p class="text-muted svelte-hj1sc2">Unable to load system information</p>'),gn=d('<div class="setting-row sub-setting svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Smoothing Samples</span> <span class="setting-description svelte-hj1sc2">Number of readings to average</span></div> <select class="select-input-sm svelte-hj1sc2"><option class="svelte-hj1sc2">3</option><option class="svelte-hj1sc2">5</option><option class="svelte-hj1sc2">10</option><option class="svelte-hj1sc2">15</option><option class="svelte-hj1sc2">20</option></select></div>'),mn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),jn=d('<p class="config-error svelte-hj1sc2"> </p>'),bn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),yn=d('<option class="svelte-hj1sc2"> </option>'),wn=d('<div class="loading-spinner-small svelte-hj1sc2"></div>'),Sn=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Connection Status</span></div> <span> </span></div>'),xn=d("<span> </span>"),kn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Tn=d('<p class="config-error svelte-hj1sc2"> </p>'),Cn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),An=d('<!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Home Assistant URL</span> <span class="setting-description svelte-hj1sc2">e.g., http://192.168.1.100:8123</span></div> <input type="url" placeholder="http://homeassistant.local:8123" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Access Token</span> <span class="setting-description svelte-hj1sc2">Long-lived access token from HA profile</span></div> <input type="password" placeholder="Enter token..." class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Test Connection</span></div> <div class="test-connection svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Temp Entity</span> <span class="setting-description svelte-hj1sc2">e.g., sensor.fermenter_room_temperature</span></div> <input type="text" placeholder="sensor.xxx_temperature" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Humidity Entity</span> <span class="setting-description svelte-hj1sc2">Optional humidity sensor</span></div> <input type="text" placeholder="sensor.xxx_humidity" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Weather Entity</span> <span class="setting-description svelte-hj1sc2">For forecast display, e.g., weather.home</span></div> <input type="text" placeholder="weather.home" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Heater Switch Entity</span> <span class="setting-description svelte-hj1sc2">Switch to control fermentation heating</span></div> <input type="text" placeholder="switch.fermenter_heater" class="input-field svelte-hj1sc2"/></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),Fn=d('<div class="override-banner svelte-hj1sc2"><span class="override-icon svelte-hj1sc2">âš¡</span> <span class="svelte-hj1sc2"> </span></div>'),En=d('<div class="control-status svelte-hj1sc2"><div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Wort Temp</span> <span class="status-value svelte-hj1sc2"> </span></div> <div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Target</span> <span class="status-value svelte-hj1sc2"> </span></div> <div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Mode</span> <span> </span></div></div>'),Hn=d('<button type="button" class="btn-override btn-cancel svelte-hj1sc2">Cancel</button>'),zn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),On=d('<p class="config-error svelte-hj1sc2"> </p>'),Mn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Un=d('<div><div class="heater-status-main svelte-hj1sc2"><div><span class="heater-icon svelte-hj1sc2">ðŸ”¥</span></div> <div class="heater-info svelte-hj1sc2"><span class="heater-state-label svelte-hj1sc2">Heater Status</span> <span> </span></div> <div class="heater-toggle-buttons svelte-hj1sc2"><button type="button">Turn On</button> <button type="button">Turn Off</button></div></div> <!></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Target Temperature</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" step="0.5" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Hysteresis</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Manual Override</span> <span class="setting-description svelte-hj1sc2">Temporarily override automatic control (1 hour)</span></div> <div class="override-buttons svelte-hj1sc2"><button type="button">Force ON</button> <button type="button">Force OFF</button> <!></div></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),In=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Temperature Control</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Temperature Control</span> <span class="setting-description svelte-hj1sc2">Automatically control heater based on wort temp</span></div> <button type="button" aria-label="Toggle temperature control"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div>'),Pn=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Alert Threshold</span> <span class="setting-description svelte-hj1sc2">Alert when forecast differs from target by this amount (Â°C)</span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" min="1" max="15" step="0.5" class="input-field-sm svelte-hj1sc2"/> <span class="unit svelte-hj1sc2">Â°C</span></div></div> <p class="setting-hint mt-2 svelte-hj1sc2">Alerts are generated when the forecast high or low temperatures differ from your target fermentation temperature by more than the threshold.</p>',1),Rn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),Nn=d('<p class="config-error svelte-hj1sc2"> </p>'),Bn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),Dn=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Weather Alerts</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Weather Alerts</span> <span class="setting-description svelte-hj1sc2">Get alerts when forecast temps may affect fermentation</span></div> <button type="button" aria-label="Toggle weather alerts"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div>'),Ln=d('<div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Total Readings</span></div> <div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Estimated Size</span></div>',1),Jn=d('<p class="text-muted svelte-hj1sc2">Unable to load storage stats</p>'),Gn=d('<button type="button" class="btn-danger-sm svelte-hj1sc2"> </button>'),Wn=d('<p class="cleanup-message svelte-hj1sc2"> </p>'),$n=d('<span class="loading-dot svelte-hj1sc2"></span> Rebooting...',1),qn=Bt('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" class="svelte-hj1sc2"></path></svg> Reboot System',1),Kn=d('<span class="loading-dot svelte-hj1sc2"></span> Shutting down...',1),Vn=Bt('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" class="svelte-hj1sc2"></path></svg> Shutdown System',1),Yn=d('<div class="grid gap-6 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">System Information</h2></div> <div class="card-body svelte-hj1sc2"><!></div></div> <div class="grid gap-6 md:grid-cols-2 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Application Settings</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Temperature Units</span> <span class="setting-description svelte-hj1sc2">Display temperature in Celsius or Fahrenheit</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">Â°C</button> <button type="button">Â°F</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Gravity Units</span> <span class="setting-description svelte-hj1sc2">Display gravity as SG, Plato, or Brix</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">SG</button> <button type="button">Â°P</button> <button type="button">Â°Bx</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Minimum RSSI</span> <span class="setting-description svelte-hj1sc2">Ignore readings below this signal strength</span></div> <div class="rssi-input svelte-hj1sc2"><input type="number" min="-100" max="0" class="input-field-sm svelte-hj1sc2"/> <span class="input-suffix svelte-hj1sc2">dBm</span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Reading Smoothing</span> <span class="setting-description svelte-hj1sc2">Average multiple readings to reduce noise</span></div> <button type="button" aria-label="Toggle reading smoothing"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Identify by MAC</span> <span class="setting-description svelte-hj1sc2">Use MAC address instead of broadcast ID</span></div> <button type="button" aria-label="Toggle identify by MAC address"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Timezone</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description svelte-hj1sc2">Current timezone: <span class="font-mono text-[var(--accent)] svelte-hj1sc2"> </span></p> <div class="timezone-selector svelte-hj1sc2"><select class="select-input svelte-hj1sc2"></select> <!></div></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Home Assistant</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Integration</span> <span class="setting-description svelte-hj1sc2">Connect to Home Assistant for ambient temp and control</span></div> <button type="button" aria-label="Enable Home Assistant integration"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div> <!> <!> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Storage & Data Cleanup</h2></div> <div class="card-body svelte-hj1sc2"><div class="storage-grid svelte-hj1sc2"><div class="storage-stats svelte-hj1sc2"><!></div> <div class="cleanup-section svelte-hj1sc2"><p class="section-description mb-3 svelte-hj1sc2">Remove old readings to free up storage. Readings older than the specified days will be permanently deleted.</p> <div class="cleanup-controls svelte-hj1sc2"><div class="cleanup-input-group svelte-hj1sc2"><label for="retention-days" class="svelte-hj1sc2">Keep readings from last</label> <input id="retention-days" type="number" min="1" max="365" class="input-field-sm svelte-hj1sc2"/> <span class="svelte-hj1sc2">days</span></div> <div class="cleanup-actions svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <!></div></div></div></div> <div class="card danger-zone svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Power Controls</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description danger-text svelte-hj1sc2">These actions will affect the entire system. Make sure you have saved any pending work.</p> <div class="power-buttons svelte-hj1sc2"><button type="button" class="btn-warning svelte-hj1sc2"><!></button> <button type="button" class="btn-danger svelte-hj1sc2"><!></button></div></div></div></div>'),Qn=d('<div class="page-container svelte-hj1sc2"><div class="page-header svelte-hj1sc2"><h1 class="page-title svelte-hj1sc2">System</h1> <p class="page-description svelte-hj1sc2">System settings, timezone configuration, and power controls</p></div> <!></div>');function oi(Dt,Lt){Za(Lt,!0);let ne=o(null),He=o(null),Ns=o(en([])),de=o(""),Bs=o(!0),w=o(null),pe=o("C"),X=o("sg"),ze=o(-100),ie=o(!1),Oe=o(5),ue=o(!1),Me=o(!1),Ue=o(null),Ie=o(!1),he=o(30),B=o(null),$=o(!1),_e=o(""),fe=o(""),Pe=o(""),Re=o(""),je=o(""),be=o(""),Ne=o(!1),le=o(null),Be=o(null),De=o(!1),Le=o(null),Je=o(!1),I=o(null),re=o(!1),ye=o(68),we=o(1),Ge=o(!1),We=o(null),$e=o(!1),Se=o(!1),oe=o(!1),qe=o(3),Ke=o(!1),Ve=o(null),Ye=o(!1),D=It(()=>j.config.temp_units==="C"),ge=It(()=>e(D)?"Â°C":"Â°F");function Jt(i){return i==null?"â€”":e(D)?Pt(i).toFixed(1):i.toFixed(1)}function Gt(i){return e(D)?un(i):i}function Wt(i){return e(D)?Pt(i):i}async function $t(){try{const i=await fetch("/api/system/info");i.ok&&n(ne,await i.json(),!0)}catch(i){console.error("Failed to load system info:",i)}}async function Ds(){try{const i=await fetch("/api/system/storage");i.ok&&n(He,await i.json(),!0)}catch(i){console.error("Failed to load storage stats:",i)}}async function qt(){try{const[i,x]=await Promise.all([fetch("/api/system/timezones"),fetch("/api/system/timezone")]);if(i.ok){const M=await i.json();n(Ns,M.timezones||[],!0)}if(x.ok){const M=await x.json();n(de,M.timezone||"UTC",!0)}}catch(i){console.error("Failed to load timezones:",i)}}function Ls(){n(pe,j.config.temp_units,!0),n(X,j.config.sg_units,!0),n(ze,j.config.min_rssi,!0),n(ie,j.config.smoothing_enabled,!0),n(Oe,j.config.smoothing_samples,!0),n(ue,j.config.id_by_mac,!0),n($,j.config.ha_enabled,!0),n(_e,j.config.ha_url,!0),n(fe,j.config.ha_token,!0),n(Pe,j.config.ha_ambient_temp_entity_id,!0),n(Re,j.config.ha_ambient_humidity_entity_id,!0),n(je,j.config.ha_weather_entity_id,!0),n(be,j.config.ha_heater_entity_id,!0),n(re,j.config.temp_control_enabled,!0),n(ye,Math.round(Wt(j.config.temp_target)*2)/2),n(we,j.config.temp_units==="C"?Math.round(j.config.temp_hysteresis*(5/9)*100)/100:j.config.temp_hysteresis,!0),n(oe,j.config.weather_alerts_enabled,!0),n(qe,j.config.alert_temp_threshold,!0)}async function Kt(){n(Me,!0),n(Ue,null),n(Ie,!1);try{const i=await ls({temp_units:e(pe),sg_units:e(X),min_rssi:e(ze),smoothing_enabled:e(ie),smoothing_samples:e(Oe),id_by_mac:e(ue)});i.success?(n(Ie,!0),setTimeout(()=>n(Ie,!1),3e3)):n(Ue,i.error||"Failed to save settings",!0)}finally{n(Me,!1)}}async function Vt(){n(De,!0),n(Le,null),n(Je,!1);try{const i=await ls({ha_enabled:e($),ha_url:e(_e),ha_token:e(fe),ha_ambient_temp_entity_id:e(Pe),ha_ambient_humidity_entity_id:e(Re),ha_weather_entity_id:e(je),ha_heater_entity_id:e(be)});i.success?(n(Je,!0),setTimeout(()=>n(Je,!1),3e3),await Gs()):n(Le,i.error||"Failed to save settings",!0)}finally{n(De,!1)}}async function rs(){try{const i=await fetch("/api/control/status");i.ok&&n(I,await i.json(),!0)}catch(i){console.error("Failed to load control status:",i)}}async function Yt(){n(Ge,!0),n(We,null),n($e,!1);try{const i=Gt(e(ye)),x=e(D)?e(we)*(9/5):e(we),M=await ls({temp_control_enabled:e(re),temp_target:i,temp_hysteresis:x});M.success?(n($e,!0),setTimeout(()=>n($e,!1),3e3),await rs()):n(We,M.error||"Failed to save settings",!0)}finally{n(Ge,!1)}}async function Qt(){n(Ke,!0),n(Ve,null),n(Ye,!1);try{const i=await ls({weather_alerts_enabled:e(oe),alert_temp_threshold:e(qe)});i.success?(n(Ye,!0),setTimeout(()=>n(Ye,!1),3e3)):n(Ve,i.error||"Failed to save settings",!0)}finally{n(Ke,!1)}}async function os(i){n(Se,!0);try{(await fetch("/api/control/override",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({state:i,duration_minutes:60})})).ok&&await rs()}catch(x){console.error("Failed to set override:",x)}finally{n(Se,!1)}}async function Xt(i){n(w,"timezone");try{(await fetch("/api/system/timezone",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({timezone:i})})).ok&&n(de,i,!0)}catch(x){console.error("Failed to set timezone:",x)}finally{n(w,null)}}async function Zt(){n(w,"cleanup-preview");try{const i=await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(he),confirm:!1})});i.ok&&n(B,await i.json(),!0)}catch(i){console.error("Failed to preview cleanup:",i)}finally{n(w,null)}}async function ea(){if(!(!e(B)||e(B).readings_to_delete===0)&&confirm(`Delete ${e(B).readings_to_delete.toLocaleString()} readings older than ${e(he)} days?`)){n(w,"cleanup");try{(await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(he),confirm:!0})})).ok&&(n(B,null),await Ds())}catch(i){console.error("Failed to execute cleanup:",i)}finally{n(w,null)}}}async function sa(){if(confirm("Are you sure you want to reboot the system? The UI will be unavailable until restart completes.")){n(w,"reboot");try{await fetch("/api/system/reboot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Reboot command failed:",i)}finally{n(w,null)}}}async function ta(){if(confirm("Are you sure you want to shut down the system? You will need physical access to restart.")){n(w,"shutdown");try{await fetch("/api/system/shutdown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Shutdown command failed:",i)}finally{n(w,null)}}}function aa(i){if(!i)return"Unknown";const x=Math.floor(i/86400),M=Math.floor(i%86400/3600),xe=Math.floor(i%3600/60),ce=[];return x>0&&ce.push(`${x}d`),M>0&&ce.push(`${M}h`),xe>0&&ce.push(`${xe}m`),ce.length>0?ce.join(" "):"< 1m"}function na(i){return!Number.isFinite(i)||i<0?"0 B":i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(1)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`}function Js(i){return i.toLocaleString()}async function ia(){n(Ne,!0),n(le,null);try{const i=await fetch("/api/ha/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e(_e),token:e(fe)})});i.ok?n(le,await i.json(),!0):n(le,{success:!1,message:"Request failed"},!0)}catch{n(le,{success:!1,message:"Network error"},!0)}finally{n(Ne,!1)}}async function Gs(){try{const i=await fetch("/api/ha/status");i.ok&&n(Be,await i.json(),!0)}catch(i){console.error("Failed to load HA status:",i)}}sn(async()=>{await Promise.all([$t(),Ds(),qt(),Gs(),rs()]),Ls(),n(Bs,!1)}),tn(()=>{j.loaded&&Ls()});var cs=Qn();cn("hj1sc2",i=>{nn(()=>{ln.title="System | BrewSignal"})});var la=a(t(cs),2);{var ra=i=>{var x=hn();c(i,x)},oa=i=>{var x=Yn(),M=t(x),xe=a(t(M),2),ce=t(xe);{var ca=l=>{var r=_n(),p=t(r),g=a(t(p),2),m=t(g,!0);s(g),s(p);var k=a(p,2),C=a(t(k),2),U=t(C);s(C),s(k);var A=a(k,2),E=a(t(A),2),H=t(E,!0);s(E),s(A);var K=a(A,2),L=a(t(K),2),V=t(L,!0);s(L),s(K),s(r),T(J=>{_(m,e(ne).hostname),_(U,`v${e(ne).version??""}`),_(H,J),_(V,e(ne).ip_addresses.length>0?e(ne).ip_addresses[0]:"Unknown")},[()=>aa(e(ne).uptime_seconds)]),c(l,r)},va=l=>{var r=fn();c(l,r)};u(ce,l=>{e(ne)?l(ca):l(va,!1)})}s(xe),s(M);var vs=a(M,2),ds=t(vs),Ws=a(t(ds),2),ps=t(Ws),$s=a(t(ps),2),us=t($s);let qs;us.__click=()=>n(pe,"C");var Ks=a(us,2);let Vs;Ks.__click=()=>n(pe,"F"),s($s),s(ps);var hs=a(ps,2),Ys=a(t(hs),2),_s=t(Ys);let Qs;_s.__click=()=>n(X,"sg");var fs=a(_s,2);let Xs;fs.__click=()=>n(X,"plato");var Zs=a(fs,2);let et;Zs.__click=()=>n(X,"brix"),s(Ys),s(hs);var gs=a(hs,2),st=a(t(gs),2),tt=t(st);R(tt),O(2),s(st),s(gs);var ms=a(gs,2),js=a(t(ms),2);let at;js.__click=()=>n(ie,!e(ie)),s(ms);var nt=a(ms,2);{var da=l=>{var r=gn(),p=a(t(r),2),g=t(p);g.value=g.__value=3;var m=a(g);m.value=m.__value=5;var k=a(m);k.value=k.__value=10;var C=a(k);C.value=C.__value=15;var U=a(C);U.value=U.__value=20,s(p),s(r),pn(p,()=>e(Oe),A=>n(Oe,A)),c(l,r)};u(nt,l=>{e(ie)&&l(da)})}var bs=a(nt,2),ys=a(t(bs),2);let it;ys.__click=()=>n(ue,!e(ue)),s(bs);var lt=a(bs,2),ke=t(lt);ke.__click=Kt;var pa=t(ke);{var ua=l=>{var r=mn();O(),c(l,r)},ha=l=>{var r=ns("Save Settings");c(l,r)};u(pa,l=>{e(Me)?l(ua):l(ha,!1)})}s(ke);var rt=a(ke,2);{var _a=l=>{var r=jn(),p=t(r,!0);s(r),T(()=>_(p,e(Ue))),c(l,r)};u(rt,l=>{e(Ue)&&l(_a)})}var fa=a(rt,2);{var ga=l=>{var r=bn();c(l,r)};u(fa,l=>{e(Ie)&&l(ga)})}s(lt),s(Ws),s(ds);var ot=a(ds,2),ct=a(t(ot),2),ws=t(ct),vt=a(t(ws)),ma=t(vt,!0);s(vt),s(ws);var dt=a(ws,2),q=t(dt);q.__change=l=>Xt(l.currentTarget.value),rn(q,21,()=>e(Ns),on,(l,r)=>{var p=yn(),g=t(p,!0);s(p);var m={};T(()=>{_(g,e(r)),m!==(m=e(r))&&(p.value=(p.__value=e(r))??"")}),c(l,p)}),s(q);var pt;vn(q);var ja=a(q,2);{var ba=l=>{var r=wn();c(l,r)};u(ja,l=>{e(w)==="timezone"&&l(ba)})}s(dt),s(ct),s(ot),s(vs);var Ss=a(vs,2),ut=a(t(Ss),2),xs=t(ut),ks=a(t(xs),2);let ht;ks.__click=()=>n($,!e($)),s(xs);var ya=a(xs,2);{var wa=l=>{var r=An(),p=is(r);{var g=v=>{var b=Sn(),z=a(t(b),2);let ve;var zs=t(z,!0);s(z),s(b),T(()=>{ve=S(z,1,"status-badge svelte-hj1sc2",null,ve,{connected:e(Be).connected}),_(zs,e(Be).connected?"Connected":"Disconnected")}),c(v,b)};u(p,v=>{e(Be)&&v(g)})}var m=a(p,2),k=a(t(m),2);R(k),s(m);var C=a(m,2),U=a(t(C),2);R(U),s(C);var A=a(C,2),E=a(t(A),2),H=t(E);H.__click=ia;var K=t(H,!0);s(H);var L=a(H,2);{var V=v=>{var b=xn();let z;var ve=t(b,!0);s(b),T(()=>{z=S(b,1,"test-result svelte-hj1sc2",null,z,{success:e(le).success}),_(ve,e(le).message)}),c(v,b)};u(L,v=>{e(le)&&v(V)})}s(E),s(A);var J=a(A,2),Z=a(t(J),2);R(Z),s(J);var Y=a(J,2),f=a(t(Y),2);R(f),s(Y);var F=a(Y,2),G=a(t(F),2);R(G),s(F);var P=a(F,2),ee=a(t(P),2);R(ee),s(P);var se=a(P,2),te=t(se);te.__click=Vt;var Es=t(te);{var Hs=v=>{var b=kn();O(),c(v,b)},Xe=v=>{var b=ns("Save HA Settings");c(v,b)};u(Es,v=>{e(De)?v(Hs):v(Xe,!1)})}s(te);var Ze=a(te,2);{var Ae=v=>{var b=Tn(),z=t(b,!0);s(b),T(()=>_(z,e(Le))),c(v,b)};u(Ze,v=>{e(Le)&&v(Ae)})}var Fe=a(Ze,2);{var es=v=>{var b=Cn();c(v,b)};u(Fe,v=>{e(Je)&&v(es)})}s(se),T(()=>{H.disabled=e(Ne)||!e(_e)||!e(fe),_(K,e(Ne)?"Testing...":"Test"),te.disabled=e(De)}),N(k,()=>e(_e),v=>n(_e,v)),N(U,()=>e(fe),v=>n(fe,v)),N(Z,()=>e(Pe),v=>n(Pe,v)),N(f,()=>e(Re),v=>n(Re,v)),N(G,()=>e(je),v=>n(je,v)),N(ee,()=>e(be),v=>n(be,v)),c(l,r)};u(ya,l=>{e($)&&l(wa)})}s(ut),s(Ss);var _t=a(Ss,2);{var Sa=l=>{var r=In(),p=a(t(r),2),g=t(p),m=a(t(g),2);let k;m.__click=()=>n(re,!e(re)),s(g);var C=a(g,2);{var U=A=>{var E=Un(),H=is(E);let K;var L=t(H),V=t(L);let J;var Z=a(V,2),Y=a(t(Z),2);let f;var F=t(Y,!0);s(Y),s(Z);var G=a(Z,2),P=t(G);let ee;P.__click=()=>Rt("on").then(()=>Nt());var se=a(P,2);let te;se.__click=()=>Rt("off").then(()=>Nt()),s(G),s(L);var Es=a(L,2);{var Hs=h=>{var y=Fn(),ae=a(t(y),2),as=t(ae);s(ae),s(y),T(Is=>_(as,`Manual override active: ${Is??""}`),[()=>e(I).override_state?.toUpperCase()]),c(h,y)};u(Es,h=>{e(I)?.override_active&&h(Hs)})}s(H);var Xe=a(H,2);{var Ze=h=>{var y=En(),ae=t(y),as=a(t(ae),2),Is=t(as,!0);s(as),s(ae);var Ps=a(ae,2),Ot=a(t(Ps),2),Va=t(Ot);s(Ot),s(Ps);var Mt=a(Ps,2),Rs=a(t(Mt),2);let Ut;var Ya=t(Rs,!0);s(Rs),s(Mt),s(y),T(Qa=>{_(Is,Qa),_(Va,`${e(ye)??""}${e(ge)??""}`),Ut=S(Rs,1,"status-value svelte-hj1sc2",null,Ut,{override:e(I).override_active}),_(Ya,e(I).override_active?"Manual":"Auto")},[()=>e(I).wort_temp!==null?`${Jt(e(I).wort_temp)}${e(ge)}`:"â€”"]),c(h,y)};u(Xe,h=>{e(I)&&h(Ze)})}var Ae=a(Xe,2),Fe=t(Ae),es=a(t(Fe),2),v=t(es);s(es),s(Fe);var b=a(Fe,2),z=t(b);R(z);var ve=a(z,2),zs=t(ve,!0);s(ve),s(b),s(Ae);var Os=a(Ae,2),Ms=t(Os),kt=a(t(Ms),2),Na=t(kt);s(kt),s(Ms);var Tt=a(Ms,2),me=t(Tt);R(me);var Ct=a(me,2),Ba=t(Ct,!0);s(Ct),s(Tt),s(Os);var Us=a(Os,2),At=a(t(Us),2),ss=t(At);let Ft;ss.__click=()=>os("on");var ts=a(ss,2);let Et;ts.__click=()=>os("off");var Da=a(ts,2);{var La=h=>{var y=Hn();y.__click=()=>os(null),T(()=>y.disabled=e(Se)),c(h,y)};u(Da,h=>{e(I)?.override_active&&h(La)})}s(At),s(Us);var Ht=a(Us,2),Ee=t(Ht);Ee.__click=Yt;var Ja=t(Ee);{var Ga=h=>{var y=zn();O(),c(h,y)},Wa=h=>{var y=ns("Save Control Settings");c(h,y)};u(Ja,h=>{e(Ge)?h(Ga):h(Wa,!1)})}s(Ee);var zt=a(Ee,2);{var $a=h=>{var y=On(),ae=t(y,!0);s(y),T(()=>_(ae,e(We))),c(h,y)};u(zt,h=>{e(We)&&h($a)})}var qa=a(zt,2);{var Ka=h=>{var y=Mn();c(h,y)};u(qa,h=>{e($e)&&h(Ka)})}s(Ht),T(()=>{K=S(H,1,"heater-status-card svelte-hj1sc2",null,K,{"heater-active":Q.heater.state==="on"}),J=S(V,1,"heater-icon-container svelte-hj1sc2",null,J,{heating:Q.heater.state==="on"}),f=S(Y,1,"heater-state-value svelte-hj1sc2",null,f,{on:Q.heater.state==="on"}),_(F,Q.heater.state==="on"?"HEATING":Q.heater.state==="off"?"OFF":"Unknown"),ee=S(P,1,"heater-btn heater-btn-on svelte-hj1sc2",null,ee,{active:Q.heater.state==="on"}),P.disabled=Q.heater.loading,te=S(se,1,"heater-btn heater-btn-off svelte-hj1sc2",null,te,{active:Q.heater.state==="off"}),se.disabled=Q.heater.loading,_(v,`Desired fermentation temperature (${e(ge)??""})`),W(z,"min",e(D)?0:32),W(z,"max",e(D)?38:100),_(zs,e(ge)),_(Na,`Â± tolerance before triggering (${e(ge)??""})`),W(me,"min",e(D)?.3:.5),W(me,"max",e(D)?5.5:10),W(me,"step",e(D)?.25:.5),_(Ba,e(ge)),Ft=S(ss,1,"btn-override svelte-hj1sc2",null,Ft,{active:e(I)?.override_state==="on"}),ss.disabled=e(Se),Et=S(ts,1,"btn-override svelte-hj1sc2",null,Et,{active:e(I)?.override_state==="off"}),ts.disabled=e(Se),Ee.disabled=e(Ge)}),N(z,()=>e(ye),h=>n(ye,h)),N(me,()=>e(we),h=>n(we,h)),c(A,E)};u(C,A=>{e(re)&&A(U)})}s(p),s(r),T(()=>{k=S(m,1,"toggle svelte-hj1sc2",null,k,{active:e(re)}),W(m,"aria-pressed",e(re))}),c(l,r)};u(_t,l=>{e($)&&e(be)&&l(Sa)})}var ft=a(_t,2);{var xa=l=>{var r=Dn(),p=a(t(r),2),g=t(p),m=a(t(g),2);let k;m.__click=()=>n(oe,!e(oe)),s(g);var C=a(g,2);{var U=f=>{var F=Pn(),G=is(F),P=a(t(G),2),ee=t(P);R(ee),O(2),s(P),s(G),O(2),N(ee,()=>e(qe),se=>n(qe,se)),c(f,F)};u(C,f=>{e(oe)&&f(U)})}var A=a(C,2),E=t(A);E.__click=Qt;var H=t(E);{var K=f=>{var F=Rn();O(),c(f,F)},L=f=>{var F=ns("Save Alert Settings");c(f,F)};u(H,f=>{e(Ke)?f(K):f(L,!1)})}s(E);var V=a(E,2);{var J=f=>{var F=Nn(),G=t(F,!0);s(F),T(()=>_(G,e(Ve))),c(f,F)};u(V,f=>{e(Ve)&&f(J)})}var Z=a(V,2);{var Y=f=>{var F=Bn();c(f,F)};u(Z,f=>{e(Ye)&&f(Y)})}s(A),s(p),s(r),T(()=>{k=S(m,1,"toggle svelte-hj1sc2",null,k,{active:e(oe)}),W(m,"aria-pressed",e(oe)),E.disabled=e(Ke)}),c(l,r)};u(ft,l=>{e($)&&e(je)&&l(xa)})}var Ts=a(ft,2),gt=a(t(Ts),2),mt=t(gt),Cs=t(mt),ka=t(Cs);{var Ta=l=>{var r=Ln(),p=is(r),g=t(p),m=t(g,!0);s(g),O(2),s(p);var k=a(p,2),C=t(k),U=t(C,!0);s(C),O(2),s(k),T((A,E)=>{_(m,A),_(U,E)},[()=>Js(e(He).total_readings),()=>na(e(He).estimated_size_bytes)]),c(l,r)},Ca=l=>{var r=Jn();c(l,r)};u(ka,l=>{e(He)?l(Ta):l(Ca,!1)})}s(Cs);var jt=a(Cs,2),As=a(t(jt),2),Fs=t(As),bt=a(t(Fs),2);R(bt),O(2),s(Fs);var yt=a(Fs,2),Te=t(yt);Te.__click=Zt;var Aa=t(Te,!0);s(Te);var Fa=a(Te,2);{var Ea=l=>{var r=Gn();r.__click=ea;var p=t(r,!0);s(r),T(g=>{r.disabled=e(w)!==null,_(p,g)},[()=>e(w)==="cleanup"?"Deleting...":`Delete ${Js(e(B).readings_to_delete)} readings`]),c(l,r)};u(Fa,l=>{e(B)&&e(B).readings_to_delete>0&&l(Ea)})}s(yt),s(As);var Ha=a(As,2);{var za=l=>{var r=Wn(),p=t(r);s(r),T(()=>_(p,`No readings older than ${e(he)??""} days found.`)),c(l,r)};u(Ha,l=>{e(B)&&e(B).readings_to_delete===0&&l(za)})}s(jt),s(mt),s(gt),s(Ts);var wt=a(Ts,2),St=a(t(wt),2),xt=a(t(St),2),Ce=t(xt);Ce.__click=sa;var Oa=t(Ce);{var Ma=l=>{var r=$n();O(),c(l,r)},Ua=l=>{var r=qn();O(),c(l,r)};u(Oa,l=>{e(w)==="reboot"?l(Ma):l(Ua,!1)})}s(Ce);var Qe=a(Ce,2);Qe.__click=ta;var Ia=t(Qe);{var Pa=l=>{var r=Kn();O(),c(l,r)},Ra=l=>{var r=Vn();O(),c(l,r)};u(Ia,l=>{e(w)==="shutdown"?l(Pa):l(Ra,!1)})}s(Qe),s(xt),s(St),s(wt),s(x),T(()=>{qs=S(us,1,"unit-btn svelte-hj1sc2",null,qs,{active:e(pe)==="C"}),Vs=S(Ks,1,"unit-btn svelte-hj1sc2",null,Vs,{active:e(pe)==="F"}),Qs=S(_s,1,"unit-btn svelte-hj1sc2",null,Qs,{active:e(X)==="sg"}),Xs=S(fs,1,"unit-btn svelte-hj1sc2",null,Xs,{active:e(X)==="plato"}),et=S(Zs,1,"unit-btn svelte-hj1sc2",null,et,{active:e(X)==="brix"}),at=S(js,1,"toggle svelte-hj1sc2",null,at,{active:e(ie)}),W(js,"aria-pressed",e(ie)),it=S(ys,1,"toggle svelte-hj1sc2",null,it,{active:e(ue)}),W(ys,"aria-pressed",e(ue)),ke.disabled=e(Me),_(ma,e(de)),q.disabled=e(w)==="timezone",pt!==(pt=e(de))&&(q.value=(q.__value=e(de))??"",dn(q,e(de))),ht=S(ks,1,"toggle svelte-hj1sc2",null,ht,{active:e($)}),W(ks,"aria-pressed",e($)),Te.disabled=e(w)!==null,_(Aa,e(w)==="cleanup-preview"?"Checking...":"Preview"),Ce.disabled=e(w)!==null,Qe.disabled=e(w)!==null}),N(tt,()=>e(ze),l=>n(ze,l)),N(bt,()=>e(he),l=>n(he,l)),c(i,x)};u(la,i=>{e(Bs)?i(ra):i(oa,!1)})}s(cs),c(Dt,cs),an()}Xa(["click","change"]);export{oi as component};
