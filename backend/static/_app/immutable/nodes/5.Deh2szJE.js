import{d as Ja,f as d,a as o,s as _,t as as,b as Ht}from"../chunks/BtEPiJpU.js";import{ab as Wa,ac as c,p as $a,ad as Ga,ae as Ka,af as Va,s as n,V as qa,ag as a,ah as t,g as e,am as Ct,ai as Ya,aj as s,an as O,al as T,ak as ns}from"../chunks/BXMn-U5u.js";import{e as Qa,i as Xa}from"../chunks/BO78r8M3.js";import{i as h}from"../chunks/BvNBKeNs.js";import{c as y,h as Za,f as At,r as N,s as $,u as is,b as en}from"../chunks/DdswaOyk.js";import{s as F}from"../chunks/C4eq5C2N.js";import{b as P}from"../chunks/Dl9yvZz4.js";import{i as sn,s as tn,b as an}from"../chunks/CbZw9Vd9.js";import{t as Ft,f as Et,a as Q}from"../chunks/-6BuQLOK.js";var nn=d('<div class="loading-state svelte-hj1sc2"><div class="loading-spinner svelte-hj1sc2"></div> <span class="svelte-hj1sc2">Loading system information...</span></div>'),ln=d('<div class="info-grid svelte-hj1sc2"><div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Hostname</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Version</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">Uptime</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div> <div class="info-item svelte-hj1sc2"><span class="info-label svelte-hj1sc2">IP Address</span> <span class="info-value font-mono svelte-hj1sc2"> </span></div></div>'),rn=d('<p class="text-muted svelte-hj1sc2">Unable to load system information</p>'),on=d('<div class="setting-row sub-setting svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Smoothing Samples</span> <span class="setting-description svelte-hj1sc2">Number of readings to average</span></div> <select class="select-input-sm svelte-hj1sc2"><option class="svelte-hj1sc2">3</option><option class="svelte-hj1sc2">5</option><option class="svelte-hj1sc2">10</option><option class="svelte-hj1sc2">15</option><option class="svelte-hj1sc2">20</option></select></div>'),cn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),vn=d('<p class="config-error svelte-hj1sc2"> </p>'),dn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),pn=d('<option class="svelte-hj1sc2"> </option>'),hn=d('<div class="loading-spinner-small svelte-hj1sc2"></div>'),un=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Connection Status</span></div> <span> </span></div>'),_n=d("<span> </span>"),fn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),gn=d('<p class="config-error svelte-hj1sc2"> </p>'),mn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),jn=d('<!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Home Assistant URL</span> <span class="setting-description svelte-hj1sc2">e.g., http://192.168.1.100:8123</span></div> <input type="url" placeholder="http://homeassistant.local:8123" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Access Token</span> <span class="setting-description svelte-hj1sc2">Long-lived access token from HA profile</span></div> <input type="password" placeholder="Enter token..." class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Test Connection</span></div> <div class="test-connection svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Temp Entity</span> <span class="setting-description svelte-hj1sc2">e.g., sensor.fermenter_room_temperature</span></div> <input type="text" placeholder="sensor.xxx_temperature" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Ambient Humidity Entity</span> <span class="setting-description svelte-hj1sc2">Optional humidity sensor</span></div> <input type="text" placeholder="sensor.xxx_humidity" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Weather Entity</span> <span class="setting-description svelte-hj1sc2">For forecast display, e.g., weather.home</span></div> <input type="text" placeholder="weather.home" class="input-field svelte-hj1sc2"/></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Heater Switch Entity</span> <span class="setting-description svelte-hj1sc2">Switch to control fermentation heating</span></div> <input type="text" placeholder="switch.fermenter_heater" class="input-field svelte-hj1sc2"/></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),bn=d('<div class="override-banner svelte-hj1sc2"><span class="override-icon svelte-hj1sc2">âš¡</span> <span class="svelte-hj1sc2"> </span></div>'),yn=d('<div class="control-status svelte-hj1sc2"><div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Wort Temp</span> <span class="status-value svelte-hj1sc2"> </span></div> <div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Target</span> <span class="status-value svelte-hj1sc2"> </span></div> <div class="status-item svelte-hj1sc2"><span class="status-label svelte-hj1sc2">Mode</span> <span> </span></div></div>'),wn=d('<button type="button" class="btn-override btn-cancel svelte-hj1sc2">Cancel</button>'),Sn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),xn=d('<p class="config-error svelte-hj1sc2"> </p>'),Tn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),kn=d('<div><div class="heater-status-main svelte-hj1sc2"><div><span class="heater-icon svelte-hj1sc2">ðŸ”¥</span></div> <div class="heater-info svelte-hj1sc2"><span class="heater-state-label svelte-hj1sc2">Heater Status</span> <span> </span></div> <div class="heater-toggle-buttons svelte-hj1sc2"><button type="button">Turn On</button> <button type="button">Turn Off</button></div></div> <!></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Target Temperature</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" step="0.5" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Hysteresis</span> <span class="setting-description svelte-hj1sc2"> </span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" class="input-field input-number svelte-hj1sc2"/> <span class="unit svelte-hj1sc2"> </span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Manual Override</span> <span class="setting-description svelte-hj1sc2">Temporarily override automatic control (1 hour)</span></div> <div class="override-buttons svelte-hj1sc2"><button type="button">Force ON</button> <button type="button">Force OFF</button> <!></div></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div>',1),Cn=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Temperature Control</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Temperature Control</span> <span class="setting-description svelte-hj1sc2">Automatically control heater based on wort temp</span></div> <button type="button" aria-label="Toggle temperature control"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div>'),An=d('<div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Alert Threshold</span> <span class="setting-description svelte-hj1sc2">Alert when forecast differs from target by this amount (Â°C)</span></div> <div class="input-with-unit svelte-hj1sc2"><input type="number" min="1" max="15" step="0.5" class="input-field-sm svelte-hj1sc2"/> <span class="unit svelte-hj1sc2">Â°C</span></div></div> <p class="setting-hint mt-2 svelte-hj1sc2">Alerts are generated when the forecast high or low temperatures differ from your target fermentation temperature by more than the threshold.</p>',1),Fn=d('<span class="loading-dot svelte-hj1sc2"></span> Saving...',1),En=d('<p class="config-error svelte-hj1sc2"> </p>'),Hn=d('<p class="config-success svelte-hj1sc2">Settings saved</p>'),zn=d('<div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Weather Alerts</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Weather Alerts</span> <span class="setting-description svelte-hj1sc2">Get alerts when forecast temps may affect fermentation</span></div> <button type="button" aria-label="Toggle weather alerts"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div>'),On=d('<div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Total Readings</span></div> <div class="stat-item svelte-hj1sc2"><span class="stat-value font-mono svelte-hj1sc2"> </span> <span class="stat-label svelte-hj1sc2">Estimated Size</span></div>',1),Mn=d('<p class="text-muted svelte-hj1sc2">Unable to load storage stats</p>'),Un=d('<button type="button" class="btn-danger-sm svelte-hj1sc2"> </button>'),In=d('<p class="cleanup-message svelte-hj1sc2"> </p>'),Rn=d('<span class="loading-dot svelte-hj1sc2"></span> Rebooting...',1),Nn=Ht('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" class="svelte-hj1sc2"></path></svg> Reboot System',1),Pn=d('<span class="loading-dot svelte-hj1sc2"></span> Shutting down...',1),Bn=Ht('<svg class="w-4 h-4 svelte-hj1sc2" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728A9 9 0 015.636 5.636m12.728 12.728L5.636 5.636" class="svelte-hj1sc2"></path></svg> Shutdown System',1),Dn=d('<div class="grid gap-6 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">System Information</h2></div> <div class="card-body svelte-hj1sc2"><!></div></div> <div class="grid gap-6 md:grid-cols-2 svelte-hj1sc2"><div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Application Settings</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Temperature Units</span> <span class="setting-description svelte-hj1sc2">Display temperature in Celsius or Fahrenheit</span></div> <div class="unit-toggle svelte-hj1sc2"><button type="button">Â°C</button> <button type="button">Â°F</button></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Minimum RSSI</span> <span class="setting-description svelte-hj1sc2">Ignore readings below this signal strength</span></div> <div class="rssi-input svelte-hj1sc2"><input type="number" min="-100" max="0" class="input-field-sm svelte-hj1sc2"/> <span class="input-suffix svelte-hj1sc2">dBm</span></div></div> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Reading Smoothing</span> <span class="setting-description svelte-hj1sc2">Average multiple readings to reduce noise</span></div> <button type="button" aria-label="Toggle reading smoothing"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!> <div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Identify by MAC</span> <span class="setting-description svelte-hj1sc2">Use MAC address instead of broadcast ID</span></div> <button type="button" aria-label="Toggle identify by MAC address"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <div class="mt-4 config-actions svelte-hj1sc2"><button type="button" class="btn-primary svelte-hj1sc2"><!></button> <!> <!></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Timezone</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description svelte-hj1sc2">Current timezone: <span class="font-mono text-[var(--accent)] svelte-hj1sc2"> </span></p> <div class="timezone-selector svelte-hj1sc2"><select class="select-input svelte-hj1sc2"></select> <!></div></div></div></div> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Home Assistant</h2></div> <div class="card-body svelte-hj1sc2"><div class="setting-row svelte-hj1sc2"><div class="setting-info svelte-hj1sc2"><span class="setting-label svelte-hj1sc2">Enable Integration</span> <span class="setting-description svelte-hj1sc2">Connect to Home Assistant for ambient temp and control</span></div> <button type="button" aria-label="Enable Home Assistant integration"><span class="toggle-slider svelte-hj1sc2"></span></button></div> <!></div></div> <!> <!> <div class="card svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Storage & Data Cleanup</h2></div> <div class="card-body svelte-hj1sc2"><div class="storage-grid svelte-hj1sc2"><div class="storage-stats svelte-hj1sc2"><!></div> <div class="cleanup-section svelte-hj1sc2"><p class="section-description mb-3 svelte-hj1sc2">Remove old readings to free up storage. Readings older than the specified days will be permanently deleted.</p> <div class="cleanup-controls svelte-hj1sc2"><div class="cleanup-input-group svelte-hj1sc2"><label for="retention-days" class="svelte-hj1sc2">Keep readings from last</label> <input id="retention-days" type="number" min="1" max="365" class="input-field-sm svelte-hj1sc2"/> <span class="svelte-hj1sc2">days</span></div> <div class="cleanup-actions svelte-hj1sc2"><button type="button" class="btn-secondary-sm svelte-hj1sc2"> </button> <!></div></div> <!></div></div></div></div> <div class="card danger-zone svelte-hj1sc2"><div class="card-header svelte-hj1sc2"><h2 class="card-title svelte-hj1sc2">Power Controls</h2></div> <div class="card-body svelte-hj1sc2"><p class="section-description danger-text svelte-hj1sc2">These actions will affect the entire system. Make sure you have saved any pending work.</p> <div class="power-buttons svelte-hj1sc2"><button type="button" class="btn-warning svelte-hj1sc2"><!></button> <button type="button" class="btn-danger svelte-hj1sc2"><!></button></div></div></div></div>'),Ln=d('<div class="page-container svelte-hj1sc2"><div class="page-header svelte-hj1sc2"><h1 class="page-title svelte-hj1sc2">System</h1> <p class="page-description svelte-hj1sc2">System settings, timezone configuration, and power controls</p></div> <!></div>');function Xn(zt,Ot){Wa(Ot,!0);let ae=c(null),Ee=c(null),Us=c($a([])),ve=c(""),Is=c(!0),w=c(null),de=c("C"),He=c(-100),ne=c(!1),ze=c(5),pe=c(!1),Oe=c(!1),Me=c(null),Ue=c(!1),he=c(30),B=c(null),G=c(!1),ue=c(""),_e=c(""),Ie=c(""),Re=c(""),me=c(""),je=c(""),Ne=c(!1),ie=c(null),Pe=c(null),Be=c(!1),De=c(null),Le=c(!1),I=c(null),le=c(!1),be=c(68),ye=c(1),Je=c(!1),We=c(null),$e=c(!1),we=c(!1),re=c(!1),Ge=c(3),Ke=c(!1),Ve=c(null),qe=c(!1),D=Ct(()=>y.config.temp_units==="C"),fe=Ct(()=>e(D)?"Â°C":"Â°F");function Mt(i){return i==null?"â€”":e(D)?At(i).toFixed(1):i.toFixed(1)}function Ut(i){return e(D)?en(i):i}function It(i){return e(D)?At(i):i}async function Rt(){try{const i=await fetch("/api/system/info");i.ok&&n(ae,await i.json(),!0)}catch(i){console.error("Failed to load system info:",i)}}async function Rs(){try{const i=await fetch("/api/system/storage");i.ok&&n(Ee,await i.json(),!0)}catch(i){console.error("Failed to load storage stats:",i)}}async function Nt(){try{const[i,S]=await Promise.all([fetch("/api/system/timezones"),fetch("/api/system/timezone")]);if(i.ok){const M=await i.json();n(Us,M.timezones||[],!0)}if(S.ok){const M=await S.json();n(ve,M.timezone||"UTC",!0)}}catch(i){console.error("Failed to load timezones:",i)}}function Ns(){n(de,y.config.temp_units,!0),n(He,y.config.min_rssi,!0),n(ne,y.config.smoothing_enabled,!0),n(ze,y.config.smoothing_samples,!0),n(pe,y.config.id_by_mac,!0),n(G,y.config.ha_enabled,!0),n(ue,y.config.ha_url,!0),n(_e,y.config.ha_token,!0),n(Ie,y.config.ha_ambient_temp_entity_id,!0),n(Re,y.config.ha_ambient_humidity_entity_id,!0),n(me,y.config.ha_weather_entity_id,!0),n(je,y.config.ha_heater_entity_id,!0),n(le,y.config.temp_control_enabled,!0),n(be,Math.round(It(y.config.temp_target)*2)/2),n(ye,y.config.temp_units==="C"?Math.round(y.config.temp_hysteresis*(5/9)*100)/100:y.config.temp_hysteresis,!0),n(re,y.config.weather_alerts_enabled,!0),n(Ge,y.config.alert_temp_threshold,!0)}async function Pt(){n(Oe,!0),n(Me,null),n(Ue,!1);try{const i=await is({temp_units:e(de),min_rssi:e(He),smoothing_enabled:e(ne),smoothing_samples:e(ze),id_by_mac:e(pe)});i.success?(n(Ue,!0),setTimeout(()=>n(Ue,!1),3e3)):n(Me,i.error||"Failed to save settings",!0)}finally{n(Oe,!1)}}async function Bt(){n(Be,!0),n(De,null),n(Le,!1);try{const i=await is({ha_enabled:e(G),ha_url:e(ue),ha_token:e(_e),ha_ambient_temp_entity_id:e(Ie),ha_ambient_humidity_entity_id:e(Re),ha_weather_entity_id:e(me),ha_heater_entity_id:e(je)});i.success?(n(Le,!0),setTimeout(()=>n(Le,!1),3e3),await Bs()):n(De,i.error||"Failed to save settings",!0)}finally{n(Be,!1)}}async function ls(){try{const i=await fetch("/api/control/status");i.ok&&n(I,await i.json(),!0)}catch(i){console.error("Failed to load control status:",i)}}async function Dt(){n(Je,!0),n(We,null),n($e,!1);try{const i=Ut(e(be)),S=e(D)?e(ye)*(9/5):e(ye),M=await is({temp_control_enabled:e(le),temp_target:i,temp_hysteresis:S});M.success?(n($e,!0),setTimeout(()=>n($e,!1),3e3),await ls()):n(We,M.error||"Failed to save settings",!0)}finally{n(Je,!1)}}async function Lt(){n(Ke,!0),n(Ve,null),n(qe,!1);try{const i=await is({weather_alerts_enabled:e(re),alert_temp_threshold:e(Ge)});i.success?(n(qe,!0),setTimeout(()=>n(qe,!1),3e3)):n(Ve,i.error||"Failed to save settings",!0)}finally{n(Ke,!1)}}async function rs(i){n(we,!0);try{(await fetch("/api/control/override",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({state:i,duration_minutes:60})})).ok&&await ls()}catch(S){console.error("Failed to set override:",S)}finally{n(we,!1)}}async function Jt(i){n(w,"timezone");try{(await fetch("/api/system/timezone",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({timezone:i})})).ok&&n(ve,i,!0)}catch(S){console.error("Failed to set timezone:",S)}finally{n(w,null)}}async function Wt(){n(w,"cleanup-preview");try{const i=await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(he),confirm:!1})});i.ok&&n(B,await i.json(),!0)}catch(i){console.error("Failed to preview cleanup:",i)}finally{n(w,null)}}async function $t(){if(!(!e(B)||e(B).readings_to_delete===0)&&confirm(`Delete ${e(B).readings_to_delete.toLocaleString()} readings older than ${e(he)} days?`)){n(w,"cleanup");try{(await fetch("/api/system/cleanup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({retention_days:e(he),confirm:!0})})).ok&&(n(B,null),await Rs())}catch(i){console.error("Failed to execute cleanup:",i)}finally{n(w,null)}}}async function Gt(){if(confirm("Are you sure you want to reboot the system? The UI will be unavailable until restart completes.")){n(w,"reboot");try{await fetch("/api/system/reboot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Reboot command failed:",i)}finally{n(w,null)}}}async function Kt(){if(confirm("Are you sure you want to shut down the system? You will need physical access to restart.")){n(w,"shutdown");try{await fetch("/api/system/shutdown",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({confirm:!0})})}catch(i){console.error("Shutdown command failed:",i)}finally{n(w,null)}}}function Vt(i){if(!i)return"Unknown";const S=Math.floor(i/86400),M=Math.floor(i%86400/3600),Se=Math.floor(i%3600/60),oe=[];return S>0&&oe.push(`${S}d`),M>0&&oe.push(`${M}h`),Se>0&&oe.push(`${Se}m`),oe.length>0?oe.join(" "):"< 1m"}function qt(i){return!Number.isFinite(i)||i<0?"0 B":i<1024?`${i} B`:i<1024*1024?`${(i/1024).toFixed(1)} KB`:`${(i/(1024*1024)).toFixed(1)} MB`}function Ps(i){return i.toLocaleString()}async function Yt(){n(Ne,!0),n(ie,null);try{const i=await fetch("/api/ha/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:e(ue),token:e(_e)})});i.ok?n(ie,await i.json(),!0):n(ie,{success:!1,message:"Request failed"},!0)}catch{n(ie,{success:!1,message:"Network error"},!0)}finally{n(Ne,!1)}}async function Bs(){try{const i=await fetch("/api/ha/status");i.ok&&n(Pe,await i.json(),!0)}catch(i){console.error("Failed to load HA status:",i)}}Ga(async()=>{await Promise.all([Rt(),Rs(),Nt(),Bs(),ls()]),Ns(),n(Is,!1)}),Ka(()=>{y.loaded&&Ns()});var os=Ln();Za("hj1sc2",i=>{qa(()=>{Ya.title="System | Tilt UI"})});var Qt=a(t(os),2);{var Xt=i=>{var S=nn();o(i,S)},Zt=i=>{var S=Dn(),M=t(S),Se=a(t(M),2),oe=t(Se);{var ea=l=>{var r=ln(),p=t(r),g=a(t(p),2),m=t(g,!0);s(g),s(p);var x=a(p,2),k=a(t(x),2),U=t(k);s(k),s(x);var C=a(x,2),E=a(t(C),2),H=t(E,!0);s(E),s(C);var V=a(C,2),L=a(t(V),2),q=t(L,!0);s(L),s(V),s(r),T(J=>{_(m,e(ae).hostname),_(U,`v${e(ae).version??""}`),_(H,J),_(q,e(ae).ip_addresses.length>0?e(ae).ip_addresses[0]:"Unknown")},[()=>Vt(e(ae).uptime_seconds)]),o(l,r)},sa=l=>{var r=rn();o(l,r)};h(oe,l=>{e(ae)?l(ea):l(sa,!1)})}s(Se),s(M);var cs=a(M,2),vs=t(cs),Ds=a(t(vs),2),ds=t(Ds),Ls=a(t(ds),2),ps=t(Ls);let Js;ps.__click=()=>n(de,"C");var Ws=a(ps,2);let $s;Ws.__click=()=>n(de,"F"),s(Ls),s(ds);var hs=a(ds,2),Gs=a(t(hs),2),Ks=t(Gs);N(Ks),O(2),s(Gs),s(hs);var us=a(hs,2),_s=a(t(us),2);let Vs;_s.__click=()=>n(ne,!e(ne)),s(us);var qs=a(us,2);{var ta=l=>{var r=on(),p=a(t(r),2),g=t(p);g.value=g.__value=3;var m=a(g);m.value=m.__value=5;var x=a(m);x.value=x.__value=10;var k=a(x);k.value=k.__value=15;var U=a(k);U.value=U.__value=20,s(p),s(r),an(p,()=>e(ze),C=>n(ze,C)),o(l,r)};h(qs,l=>{e(ne)&&l(ta)})}var fs=a(qs,2),gs=a(t(fs),2);let Ys;gs.__click=()=>n(pe,!e(pe)),s(fs);var Qs=a(fs,2),xe=t(Qs);xe.__click=Pt;var aa=t(xe);{var na=l=>{var r=cn();O(),o(l,r)},ia=l=>{var r=as("Save Settings");o(l,r)};h(aa,l=>{e(Oe)?l(na):l(ia,!1)})}s(xe);var Xs=a(xe,2);{var la=l=>{var r=vn(),p=t(r,!0);s(r),T(()=>_(p,e(Me))),o(l,r)};h(Xs,l=>{e(Me)&&l(la)})}var ra=a(Xs,2);{var oa=l=>{var r=dn();o(l,r)};h(ra,l=>{e(Ue)&&l(oa)})}s(Qs),s(Ds),s(vs);var Zs=a(vs,2),et=a(t(Zs),2),ms=t(et),st=a(t(ms)),ca=t(st,!0);s(st),s(ms);var tt=a(ms,2),K=t(tt);K.__change=l=>Jt(l.currentTarget.value),Qa(K,21,()=>e(Us),Xa,(l,r)=>{var p=pn(),g=t(p,!0);s(p);var m={};T(()=>{_(g,e(r)),m!==(m=e(r))&&(p.value=(p.__value=e(r))??"")}),o(l,p)}),s(K);var at;sn(K);var va=a(K,2);{var da=l=>{var r=hn();o(l,r)};h(va,l=>{e(w)==="timezone"&&l(da)})}s(tt),s(et),s(Zs),s(cs);var js=a(cs,2),nt=a(t(js),2),bs=t(nt),ys=a(t(bs),2);let it;ys.__click=()=>n(G,!e(G)),s(bs);var pa=a(bs,2);{var ha=l=>{var r=jn(),p=ns(r);{var g=v=>{var j=un(),z=a(t(j),2);let ce;var As=t(z,!0);s(z),s(j),T(()=>{ce=F(z,1,"status-badge svelte-hj1sc2",null,ce,{connected:e(Pe).connected}),_(As,e(Pe).connected?"Connected":"Disconnected")}),o(v,j)};h(p,v=>{e(Pe)&&v(g)})}var m=a(p,2),x=a(t(m),2);N(x),s(m);var k=a(m,2),U=a(t(k),2);N(U),s(k);var C=a(k,2),E=a(t(C),2),H=t(E);H.__click=Yt;var V=t(H,!0);s(H);var L=a(H,2);{var q=v=>{var j=_n();let z;var ce=t(j,!0);s(j),T(()=>{z=F(j,1,"test-result svelte-hj1sc2",null,z,{success:e(ie).success}),_(ce,e(ie).message)}),o(v,j)};h(L,v=>{e(ie)&&v(q)})}s(E),s(C);var J=a(C,2),X=a(t(J),2);N(X),s(J);var Y=a(J,2),f=a(t(Y),2);N(f),s(Y);var A=a(Y,2),W=a(t(A),2);N(W),s(A);var R=a(A,2),Z=a(t(R),2);N(Z),s(R);var ee=a(R,2),se=t(ee);se.__click=Bt;var ks=t(se);{var Cs=v=>{var j=fn();O(),o(v,j)},Qe=v=>{var j=as("Save HA Settings");o(v,j)};h(ks,v=>{e(Be)?v(Cs):v(Qe,!1)})}s(se);var Xe=a(se,2);{var Ce=v=>{var j=gn(),z=t(j,!0);s(j),T(()=>_(z,e(De))),o(v,j)};h(Xe,v=>{e(De)&&v(Ce)})}var Ae=a(Xe,2);{var Ze=v=>{var j=mn();o(v,j)};h(Ae,v=>{e(Le)&&v(Ze)})}s(ee),T(()=>{H.disabled=e(Ne)||!e(ue)||!e(_e),_(V,e(Ne)?"Testing...":"Test"),se.disabled=e(Be)}),P(x,()=>e(ue),v=>n(ue,v)),P(U,()=>e(_e),v=>n(_e,v)),P(X,()=>e(Ie),v=>n(Ie,v)),P(f,()=>e(Re),v=>n(Re,v)),P(W,()=>e(me),v=>n(me,v)),P(Z,()=>e(je),v=>n(je,v)),o(l,r)};h(pa,l=>{e(G)&&l(ha)})}s(nt),s(js);var lt=a(js,2);{var ua=l=>{var r=Cn(),p=a(t(r),2),g=t(p),m=a(t(g),2);let x;m.__click=()=>n(le,!e(le)),s(g);var k=a(g,2);{var U=C=>{var E=kn(),H=ns(E);let V;var L=t(H),q=t(L);let J;var X=a(q,2),Y=a(t(X),2);let f;var A=t(Y,!0);s(Y),s(X);var W=a(X,2),R=t(W);let Z;R.__click=()=>Ft("on").then(()=>Et());var ee=a(R,2);let se;ee.__click=()=>Ft("off").then(()=>Et()),s(W),s(L);var ks=a(L,2);{var Cs=u=>{var b=bn(),te=a(t(b),2),ts=t(te);s(te),s(b),T(zs=>_(ts,`Manual override active: ${zs??""}`),[()=>e(I).override_state?.toUpperCase()]),o(u,b)};h(ks,u=>{e(I)?.override_active&&u(Cs)})}s(H);var Qe=a(H,2);{var Xe=u=>{var b=yn(),te=t(b),ts=a(t(te),2),zs=t(ts,!0);s(ts),s(te);var Os=a(te,2),xt=a(t(Os),2),Ba=t(xt);s(xt),s(Os);var Tt=a(Os,2),Ms=a(t(Tt),2);let kt;var Da=t(Ms,!0);s(Ms),s(Tt),s(b),T(La=>{_(zs,La),_(Ba,`${e(be)??""}${e(fe)??""}`),kt=F(Ms,1,"status-value svelte-hj1sc2",null,kt,{override:e(I).override_active}),_(Da,e(I).override_active?"Manual":"Auto")},[()=>e(I).wort_temp!==null?`${Mt(e(I).wort_temp)}${e(fe)}`:"â€”"]),o(u,b)};h(Qe,u=>{e(I)&&u(Xe)})}var Ce=a(Qe,2),Ae=t(Ce),Ze=a(t(Ae),2),v=t(Ze);s(Ze),s(Ae);var j=a(Ae,2),z=t(j);N(z);var ce=a(z,2),As=t(ce,!0);s(ce),s(j),s(Ce);var Fs=a(Ce,2),Es=t(Fs),ft=a(t(Es),2),Ea=t(ft);s(ft),s(Es);var gt=a(Es,2),ge=t(gt);N(ge);var mt=a(ge,2),Ha=t(mt,!0);s(mt),s(gt),s(Fs);var Hs=a(Fs,2),jt=a(t(Hs),2),es=t(jt);let bt;es.__click=()=>rs("on");var ss=a(es,2);let yt;ss.__click=()=>rs("off");var za=a(ss,2);{var Oa=u=>{var b=wn();b.__click=()=>rs(null),T(()=>b.disabled=e(we)),o(u,b)};h(za,u=>{e(I)?.override_active&&u(Oa)})}s(jt),s(Hs);var wt=a(Hs,2),Fe=t(wt);Fe.__click=Dt;var Ma=t(Fe);{var Ua=u=>{var b=Sn();O(),o(u,b)},Ia=u=>{var b=as("Save Control Settings");o(u,b)};h(Ma,u=>{e(Je)?u(Ua):u(Ia,!1)})}s(Fe);var St=a(Fe,2);{var Ra=u=>{var b=xn(),te=t(b,!0);s(b),T(()=>_(te,e(We))),o(u,b)};h(St,u=>{e(We)&&u(Ra)})}var Na=a(St,2);{var Pa=u=>{var b=Tn();o(u,b)};h(Na,u=>{e($e)&&u(Pa)})}s(wt),T(()=>{V=F(H,1,"heater-status-card svelte-hj1sc2",null,V,{"heater-active":Q.heater.state==="on"}),J=F(q,1,"heater-icon-container svelte-hj1sc2",null,J,{heating:Q.heater.state==="on"}),f=F(Y,1,"heater-state-value svelte-hj1sc2",null,f,{on:Q.heater.state==="on"}),_(A,Q.heater.state==="on"?"HEATING":Q.heater.state==="off"?"OFF":"Unknown"),Z=F(R,1,"heater-btn heater-btn-on svelte-hj1sc2",null,Z,{active:Q.heater.state==="on"}),R.disabled=Q.heater.loading,se=F(ee,1,"heater-btn heater-btn-off svelte-hj1sc2",null,se,{active:Q.heater.state==="off"}),ee.disabled=Q.heater.loading,_(v,`Desired fermentation temperature (${e(fe)??""})`),$(z,"min",e(D)?0:32),$(z,"max",e(D)?38:100),_(As,e(fe)),_(Ea,`Â± tolerance before triggering (${e(fe)??""})`),$(ge,"min",e(D)?.3:.5),$(ge,"max",e(D)?5.5:10),$(ge,"step",e(D)?.25:.5),_(Ha,e(fe)),bt=F(es,1,"btn-override svelte-hj1sc2",null,bt,{active:e(I)?.override_state==="on"}),es.disabled=e(we),yt=F(ss,1,"btn-override svelte-hj1sc2",null,yt,{active:e(I)?.override_state==="off"}),ss.disabled=e(we),Fe.disabled=e(Je)}),P(z,()=>e(be),u=>n(be,u)),P(ge,()=>e(ye),u=>n(ye,u)),o(C,E)};h(k,C=>{e(le)&&C(U)})}s(p),s(r),T(()=>{x=F(m,1,"toggle svelte-hj1sc2",null,x,{active:e(le)}),$(m,"aria-pressed",e(le))}),o(l,r)};h(lt,l=>{e(G)&&e(je)&&l(ua)})}var rt=a(lt,2);{var _a=l=>{var r=zn(),p=a(t(r),2),g=t(p),m=a(t(g),2);let x;m.__click=()=>n(re,!e(re)),s(g);var k=a(g,2);{var U=f=>{var A=An(),W=ns(A),R=a(t(W),2),Z=t(R);N(Z),O(2),s(R),s(W),O(2),P(Z,()=>e(Ge),ee=>n(Ge,ee)),o(f,A)};h(k,f=>{e(re)&&f(U)})}var C=a(k,2),E=t(C);E.__click=Lt;var H=t(E);{var V=f=>{var A=Fn();O(),o(f,A)},L=f=>{var A=as("Save Alert Settings");o(f,A)};h(H,f=>{e(Ke)?f(V):f(L,!1)})}s(E);var q=a(E,2);{var J=f=>{var A=En(),W=t(A,!0);s(A),T(()=>_(W,e(Ve))),o(f,A)};h(q,f=>{e(Ve)&&f(J)})}var X=a(q,2);{var Y=f=>{var A=Hn();o(f,A)};h(X,f=>{e(qe)&&f(Y)})}s(C),s(p),s(r),T(()=>{x=F(m,1,"toggle svelte-hj1sc2",null,x,{active:e(re)}),$(m,"aria-pressed",e(re)),E.disabled=e(Ke)}),o(l,r)};h(rt,l=>{e(G)&&e(me)&&l(_a)})}var ws=a(rt,2),ot=a(t(ws),2),ct=t(ot),Ss=t(ct),fa=t(Ss);{var ga=l=>{var r=On(),p=ns(r),g=t(p),m=t(g,!0);s(g),O(2),s(p);var x=a(p,2),k=t(x),U=t(k,!0);s(k),O(2),s(x),T((C,E)=>{_(m,C),_(U,E)},[()=>Ps(e(Ee).total_readings),()=>qt(e(Ee).estimated_size_bytes)]),o(l,r)},ma=l=>{var r=Mn();o(l,r)};h(fa,l=>{e(Ee)?l(ga):l(ma,!1)})}s(Ss);var vt=a(Ss,2),xs=a(t(vt),2),Ts=t(xs),dt=a(t(Ts),2);N(dt),O(2),s(Ts);var pt=a(Ts,2),Te=t(pt);Te.__click=Wt;var ja=t(Te,!0);s(Te);var ba=a(Te,2);{var ya=l=>{var r=Un();r.__click=$t;var p=t(r,!0);s(r),T(g=>{r.disabled=e(w)!==null,_(p,g)},[()=>e(w)==="cleanup"?"Deleting...":`Delete ${Ps(e(B).readings_to_delete)} readings`]),o(l,r)};h(ba,l=>{e(B)&&e(B).readings_to_delete>0&&l(ya)})}s(pt),s(xs);var wa=a(xs,2);{var Sa=l=>{var r=In(),p=t(r);s(r),T(()=>_(p,`No readings older than ${e(he)??""} days found.`)),o(l,r)};h(wa,l=>{e(B)&&e(B).readings_to_delete===0&&l(Sa)})}s(vt),s(ct),s(ot),s(ws);var ht=a(ws,2),ut=a(t(ht),2),_t=a(t(ut),2),ke=t(_t);ke.__click=Gt;var xa=t(ke);{var Ta=l=>{var r=Rn();O(),o(l,r)},ka=l=>{var r=Nn();O(),o(l,r)};h(xa,l=>{e(w)==="reboot"?l(Ta):l(ka,!1)})}s(ke);var Ye=a(ke,2);Ye.__click=Kt;var Ca=t(Ye);{var Aa=l=>{var r=Pn();O(),o(l,r)},Fa=l=>{var r=Bn();O(),o(l,r)};h(Ca,l=>{e(w)==="shutdown"?l(Aa):l(Fa,!1)})}s(Ye),s(_t),s(ut),s(ht),s(S),T(()=>{Js=F(ps,1,"unit-btn svelte-hj1sc2",null,Js,{active:e(de)==="C"}),$s=F(Ws,1,"unit-btn svelte-hj1sc2",null,$s,{active:e(de)==="F"}),Vs=F(_s,1,"toggle svelte-hj1sc2",null,Vs,{active:e(ne)}),$(_s,"aria-pressed",e(ne)),Ys=F(gs,1,"toggle svelte-hj1sc2",null,Ys,{active:e(pe)}),$(gs,"aria-pressed",e(pe)),xe.disabled=e(Oe),_(ca,e(ve)),K.disabled=e(w)==="timezone",at!==(at=e(ve))&&(K.value=(K.__value=e(ve))??"",tn(K,e(ve))),it=F(ys,1,"toggle svelte-hj1sc2",null,it,{active:e(G)}),$(ys,"aria-pressed",e(G)),Te.disabled=e(w)!==null,_(ja,e(w)==="cleanup-preview"?"Checking...":"Preview"),ke.disabled=e(w)!==null,Ye.disabled=e(w)!==null}),P(Ks,()=>e(He),l=>n(He,l)),P(dt,()=>e(he),l=>n(he,l)),o(i,S)};h(Qt,i=>{e(Is)?i(Xt):i(Zt,!1)})}s(os),o(zt,os),Va()}Ja(["click","change"]);export{Xn as component};
