import{d as Ie,f as c,s as l,a as v,c as he}from"../chunks/jyAcDmWg.js";import{al as a,ak as s,an as t,as as h,ah as ze,ar as Z,c as e,ai as R,at as je,aj as xe,ap as Ht,aK as It,aw as Vt,am as Wt,ao as fe,s as D}from"../chunks/DBUEpBwK.js";import{e as Ve,i as We}from"../chunks/CWBb8vPY.js";import{i as z}from"../chunks/Ce0eyuz5.js";import{h as Jt}from"../chunks/GnvximVd.js";import{s as bt}from"../chunks/BKC2WXbk.js";import{s as me}from"../chunks/-yfH5Rgi.js";import{s as ye}from"../chunks/Cmyp4dBw.js";import{i as Kt,s as Yt}from"../chunks/Dx7-2BRZ.js";import{s as qt,a as Qt}from"../chunks/kcwD9VOY.js";import{p as Xt}from"../chunks/CAss_v4a.js";import{g as Zt}from"../chunks/B1Yp9NyN.js";import{k as $t,b as ft,l as Ne,u as mt,m as ea,s as ta}from"../chunks/DlMVHRlb.js";import{b as aa,g as ht,d as Je,e as jt,c as pt}from"../chunks/D-cBTwJC.js";import{t as sa}from"../chunks/y7-K11TG.js";import{B as ra}from"../chunks/C1K0tKqr.js";import{s as ia}from"../chunks/CIodzTVx.js";import{p as He}from"../chunks/ly048rjG.js";const la=!1,ps=Object.freeze(Object.defineProperty({__proto__:null,prerender:la},Symbol.toStringTag,{value:"Module"}));var va=c('<div class="accent-bar svelte-1oyrwd9"></div>'),na=c('<span class="card-icon svelte-1oyrwd9"> </span>'),oa=c('<button type="button" class="expand-btn svelte-1oyrwd9"><svg fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path></svg></button>'),da=c('<div><!> <div class="card-header svelte-1oyrwd9"><div class="header-left svelte-1oyrwd9"><!> <h3 class="card-title svelte-1oyrwd9"> </h3></div> <!></div> <div><!></div></div>');function we(I,r){let G=He(r,"highlight",3,!1),M=He(r,"collapsible",3,!1),f=He(r,"expanded",3,!1);var j=da();let d;var i=a(j);{var S=g=>{var y=va();v(g,y)};z(i,g=>{G()&&g(S)})}var n=s(i,2),O=a(n),P=a(O);{var B=g=>{var y=na(),L=a(y,!0);t(y),h(()=>l(L,r.icon)),v(g,y)};z(P,g=>{r.icon&&g(B)})}var k=s(P,2),C=a(k,!0);t(k),t(O);var w=s(O,2);{var T=g=>{var y=oa();y.__click=function(...Q){r.onToggle?.apply(this,Q)};var L=a(y);let V;t(y),h(()=>{bt(y,"aria-label",f()?"Collapse":"Expand"),V=me(L,0,"expand-icon svelte-1oyrwd9",null,V,{"rotate-180":f()})}),v(g,y)};z(w,g=>{M()&&r.onToggle&&g(T)})}t(n);var o=s(n,2);let u;var _=a(o);ia(_,()=>r.children),t(o),t(j),h(()=>{d=me(j,1,"batch-card svelte-1oyrwd9",null,d,{highlight:G()}),l(C,r.title),u=me(o,1,"card-content svelte-1oyrwd9",null,u,{collapsed:M()&&!f()})}),v(I,j)}Ie(["click"]);var ca=c('<span class="unit svelte-lzskfi"> </span>'),ua=c('<div class="raw-values svelte-lzskfi"><span class="raw-label svelte-lzskfi">Raw:</span> <span class="raw-value svelte-lzskfi"> </span> <span class="raw-separator svelte-lzskfi">Â·</span> <span class="raw-value svelte-lzskfi"> </span></div>'),ga=c('<div class="signal-bar svelte-lzskfi"></div>'),_a=c('<div class="signal-section svelte-lzskfi"><div class="signal-bars svelte-lzskfi"></div> <div class="signal-info svelte-lzskfi"><span class="signal-label svelte-lzskfi"> </span> <span class="signal-rssi svelte-lzskfi"> </span></div></div>'),fa=c('<div class="last-seen svelte-lzskfi"> </div>'),ma=c('<div class="live-badge svelte-lzskfi"><span class="live-dot svelte-lzskfi"></span> <span class="live-text svelte-lzskfi">LIVE</span></div> <div class="readings-grid svelte-lzskfi"><div class="reading svelte-lzskfi"><div class="reading-value svelte-lzskfi"> <!></div> <div class="reading-label svelte-lzskfi"> </div></div> <div class="reading svelte-lzskfi"><div class="reading-value temp svelte-lzskfi"> <span class="unit svelte-lzskfi"> </span></div> <div class="reading-label svelte-lzskfi">Temperature</div></div></div> <!> <!> <!>',1);function pa(I,r){ze(r,!0);let G=R(()=>r.liveReading?.sg??r.currentSg),M=R(()=>r.liveReading?.temp??r.currentTemp),f=R(()=>r.liveReading?.sg_raw),j=R(()=>r.liveReading?.temp_raw),d=R(()=>r.liveReading?.rssi),i=R(()=>r.liveReading?.last_seen),S=R(()=>r.liveReading&&(r.liveReading.sg!==r.liveReading.sg_raw||r.liveReading.temp!==r.liveReading.temp_raw)),n=R(aa),O=R(ht);function P(o){return o==null?"--":Je(o)}function B(o){return o==null?"--":jt(o)}function k(o){return o>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:o>=-60?{bars:3,color:"var(--positive)",label:"Good"}:o>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}function C(o){const u=Math.floor((Date.now()-new Date(o).getTime())/1e3);if(u<10)return"just now";if(u<60)return`${u}s ago`;const _=Math.floor(u/60);if(_<60)return`${_}m ago`;const g=Math.floor(_/60);return g<24?`${g}h ago`:`${Math.floor(g/24)}d ago`}let w=R(()=>e(d)?k(e(d)):null),T=R(()=>e(i)?C(e(i)):null);we(I,{title:"Live Readings",highlight:!0,children:(o,u)=>{var _=ma(),g=s(Z(_),2),y=a(g),L=a(y),V=a(L),Q=s(V);{var H=p=>{var b=ca(),F=a(b,!0);t(b),h(()=>l(F,e(n))),v(p,b)};z(Q,p=>{e(n)!=="SG"&&p(H)})}t(L);var E=s(L,2),N=a(E,!0);t(E),t(y);var K=s(y,2),$=a(K),Y=a($),oe=s(Y),ee=a(oe,!0);t(oe),t($),je(2),t(K),t(g);var te=s(g,2);{var m=p=>{var b=ua(),F=s(a(b),2),q=a(F,!0);t(F);var W=s(F,4),ae=a(W);t(W),t(b),h((ie,pe)=>{l(q,ie),l(ae,`${pe??""}${e(O)??""}`)},[()=>P(e(f)),()=>B(e(j))]),v(p,b)};z(te,p=>{e(S)&&p(m)})}var U=s(te,2);{var ve=p=>{var b=_a(),F=a(b);Ve(F,20,()=>Array(4),We,(de,ke,se)=>{var be=ga();h(()=>ye(be,`
							height: ${8+se*4}px;
							background: ${(se<e(w).bars?e(w).color:"var(--bg-hover)")??""};
							opacity: ${se<e(w).bars?1:.4};
						`)),v(de,be)}),t(F);var q=s(F,2),W=a(q),ae=a(W);t(W);var ie=s(W,2),pe=a(ie);t(ie),t(q),t(b),h(()=>{ye(W,`color: ${e(w).color??""}`),l(ae,`${e(w).label??""} Signal`),l(pe,`${e(d)??""} dBm`)}),v(p,b)};z(U,p=>{e(w)&&e(d)&&p(ve)})}var re=s(U,2);{var X=p=>{var b=fa(),F=a(b);t(b),h(()=>l(F,`Updated ${e(T)??""}`)),v(p,b)};z(re,p=>{e(T)&&p(X)})}h((p,b)=>{l(V,`${p??""} `),l(N,e(n)==="SG"?"Gravity":e(n)==="Â°P"?"Plato":"Brix"),l(Y,`${b??""} `),l(ee,e(O))},[()=>P(e(G)),()=>B(e(M))]),v(o,_)},$$slots:{default:!0}}),xe()}var ba=c('<div class="gravity-point target svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Target FG</div> <div class="point-value svelte-t80j9z"> </div></div>'),ha=c('<div class="progress-remaining svelte-t80j9z"> </div>'),ja=c('<div class="progress-section svelte-t80j9z"><div class="progress-header svelte-t80j9z"><span class="progress-label svelte-t80j9z">Fermentation Progress</span> <span class="progress-percent svelte-t80j9z"> </span></div> <div class="progress-bar-container svelte-t80j9z"><div class="progress-bar-bg svelte-t80j9z"></div> <div class="progress-bar-fill svelte-t80j9z"></div> <div class="progress-bar-shine svelte-t80j9z"></div></div> <!></div>'),ka=c('<div class="current-sg svelte-t80j9z"><div class="sg-label svelte-t80j9z">Current Specific Gravity</div> <div class="sg-value svelte-t80j9z"> <span class="fermenting-badge svelte-t80j9z"><span class="pulse-dot svelte-t80j9z"></span> Fermenting</span></div></div> <div class="gravity-timeline svelte-t80j9z"><div class="timeline-line svelte-t80j9z"></div> <div class="gravity-point start svelte-t80j9z"><div class="point-marker svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Original Gravity</div> <div class="point-value svelte-t80j9z"> </div></div> <!> <div class="gravity-point current svelte-t80j9z"><div class="point-marker pulsing svelte-t80j9z"></div> <div class="point-label svelte-t80j9z">Current FG</div> <div class="point-value svelte-t80j9z"> </div></div></div> <div class="metrics-grid svelte-t80j9z"><div class="metric abv-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">%</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Alcohol by Volume</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div> <div class="metric attenuation-metric svelte-t80j9z"><div class="metric-icon svelte-t80j9z">â†“</div> <div class="metric-content svelte-t80j9z"><div class="metric-label svelte-t80j9z">Apparent Attenuation</div> <div class="metric-value svelte-t80j9z"> <span class="live-indicator svelte-t80j9z">LIVE</span></div></div></div></div> <!>',1),ya=c('<div class="measurements-grid svelte-t80j9z"><div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Original Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Final Gravity</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">ABV</div> <div class="measurement-value svelte-t80j9z"> </div></div> <div class="measurement svelte-t80j9z"><div class="measurement-label svelte-t80j9z">Attenuation</div> <div class="measurement-value svelte-t80j9z"> </div></div></div>'),za=c('<div class="no-data svelte-t80j9z"><div class="no-data-icon svelte-t80j9z">â—‹</div> <p class="no-data-text svelte-t80j9z">Set Original Gravity to begin tracking fermentation metrics</p></div>');function xa(I,r){ze(r,!0);let G=R(()=>{if(!r.batch.measured_og)return null;const d=r.currentSg??r.progress?.measured?.current_sg;if(!d)return null;const i=(r.batch.measured_og-d)*131.25,S=(r.batch.measured_og-d)/(r.batch.measured_og-1)*100;return{currentSg:d,abv:Math.max(0,i),attenuation:Math.max(0,Math.min(100,S)),isFermenting:r.batch.status==="fermenting"||r.batch.status==="conditioning"}}),M=R(()=>e(G)?.isFermenting??!1);function f(d){return d==null?"--":Je(d)}function j(d){return d==null?"--":`${d.toFixed(1)}%`}{let d=R(()=>e(M)?"Fermentation Progress":"Fermentation Measurements");we(I,{get title(){return e(d)},children:(i,S)=>{var n=he(),O=Z(n);{var P=k=>{var C=ka(),w=Z(C),T=s(a(w),2),o=a(T);je(),t(T),t(w);var u=s(w,2),_=s(a(u),2),g=s(a(_),4),y=a(g,!0);t(g),t(_);var L=s(_,2);{var V=X=>{var p=ba(),b=s(a(p),4),F=a(b,!0);t(b),t(p),h(q=>l(F,q),[()=>f(r.batch.recipe.fg_target)]),v(X,p)};z(L,X=>{r.batch.recipe?.fg_target&&X(V)})}var Q=s(L,2),H=s(a(Q),4),E=a(H,!0);t(H),t(Q),t(u);var N=s(u,2),K=a(N),$=s(a(K),2),Y=s(a($),2),oe=a(Y);je(),t(Y),t($),t(K);var ee=s(K,2),te=s(a(ee),2),m=s(a(te),2),U=a(m);je(),t(m),t(te),t(ee),t(N);var ve=s(N,2);{var re=X=>{var p=ja(),b=a(p),F=s(a(b),2),q=a(F);t(F),t(b);var W=s(b,2),ae=s(a(W),2);je(2),t(W);var ie=s(W,2);{var pe=de=>{var ke=ha(),se=a(ke);t(ke),h(be=>l(se,`${be??""} gravity points remaining`),[()=>r.progress.progress.sg_remaining.toFixed(3)]),v(de,ke)};z(ie,de=>{r.progress.progress.sg_remaining!=null&&de(pe)})}t(p),h(de=>{l(q,`${de??""}%`),ye(ae,`width: ${r.progress.progress.percent_complete??""}%`)},[()=>r.progress.progress.percent_complete.toFixed(0)]),v(X,p)};z(ve,X=>{r.progress?.progress?.percent_complete!=null&&X(re)})}h((X,p,b,F,q)=>{l(o,`${X??""} `),l(y,p),l(E,b),l(oe,`${F??""} `),l(U,`${q??""} `)},[()=>f(e(G).currentSg),()=>f(r.batch.measured_og),()=>f(e(G).currentSg),()=>j(e(G).abv),()=>j(e(G).attenuation)]),v(k,C)},B=k=>{var C=he(),w=Z(C);{var T=u=>{var _=ya(),g=a(_),y=s(a(g),2),L=a(y,!0);t(y),t(g);var V=s(g,2),Q=s(a(V),2),H=a(Q,!0);t(Q),t(V);var E=s(V,2),N=s(a(E),2),K=a(N,!0);t(N),t(E);var $=s(E,2),Y=s(a($),2),oe=a(Y,!0);t(Y),t($),t(_),h((ee,te,m,U)=>{l(L,ee),l(H,te),l(K,m),l(oe,U)},[()=>f(r.batch.measured_og),()=>f(r.batch.measured_fg),()=>r.batch.measured_abv!=null?j(r.batch.measured_abv):"--",()=>r.batch.measured_attenuation!=null?j(r.batch.measured_attenuation):"--"]),v(u,_)},o=u=>{var _=za();v(u,_)};z(w,u=>{r.batch.measured_og?u(T):u(o,!1)},!0)}v(k,C)};z(O,k=>{e(G)&&e(M)?k(P):k(B,!1)})}v(i,n)},$$slots:{default:!0}})}xe()}var wa=c('<div class="timeline svelte-yskb8i"><div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Brew Date</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Started</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Ended</span> <span class="timeline-value svelte-yskb8i"> </span></div> <div class="timeline-item svelte-yskb8i"><span class="timeline-label svelte-yskb8i">Created</span> <span class="timeline-value svelte-yskb8i"> </span></div></div>');function Sa(I,r){ze(r,!0);function G(f){return f?new Date(f).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function M(f){return f?new Date(f).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}we(I,{title:"Timeline",children:(f,j)=>{var d=wa(),i=a(d),S=s(a(i),2),n=a(S,!0);t(S),t(i);var O=s(i,2),P=s(a(O),2),B=a(P,!0);t(P),t(O);var k=s(O,2),C=s(a(k),2),w=a(C,!0);t(C),t(k);var T=s(k,2),o=s(a(T),2),u=a(o,!0);t(o),t(T),t(d),h((_,g,y,L)=>{l(n,_),l(B,g),l(w,y),l(u,L)},[()=>G(r.batch.brew_date),()=>M(r.batch.start_time),()=>M(r.batch.end_time),()=>M(r.batch.created_at)]),v(f,d)},$$slots:{default:!0}}),xe()}var Ba=c('<div class="signal-bar svelte-1kdxwtz"></div>'),Ca=c('<div class="signal-details svelte-1kdxwtz"><div class="signal-bars svelte-1kdxwtz"></div> <span class="signal-text svelte-1kdxwtz"> </span></div>'),Ta=c('<div class="device-last-seen svelte-1kdxwtz"> </div>'),Fa=c('<div class="device-status online svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <!> <!>',1),Ra=c('<div class="device-status offline svelte-1kdxwtz"><span class="device-dot svelte-1kdxwtz"></span> </div> <div class="device-last-seen svelte-1kdxwtz">Not receiving data</div>',1),Ga=c('<div class="device-info svelte-1kdxwtz"><!></div>'),Ma=c('<button type="button" class="link-btn svelte-1kdxwtz">Link a device</button>'),Oa=c('<div class="no-device svelte-1kdxwtz"><span>No device assigned</span> <!></div>');function Da(I,r){ze(r,!0);function G(d){const i=Math.floor((Date.now()-new Date(d).getTime())/1e3);if(i<10)return"just now";if(i<60)return`${i}s ago`;const S=Math.floor(i/60);if(S<60)return`${S}m ago`;const n=Math.floor(S/60);return n<24?`${n}h ago`:`${Math.floor(n/24)}d ago`}function M(d){return d>=-50?{bars:4,color:"var(--positive)",label:"Excellent"}:d>=-60?{bars:3,color:"var(--positive)",label:"Good"}:d>=-70?{bars:2,color:"var(--warning)",label:"Fair"}:{bars:1,color:"var(--negative)",label:"Weak"}}let f=R(()=>r.liveReading?.rssi?M(r.liveReading.rssi):null),j=R(()=>r.liveReading?.last_seen?G(r.liveReading.last_seen):null);we(I,{title:"Tracking Device",children:(d,i)=>{var S=he(),n=Z(S);{var O=B=>{var k=Ga(),C=a(k);{var w=o=>{var u=Fa(),_=Z(u),g=s(a(_));t(_);var y=s(_,2);{var L=H=>{var E=Ca(),N=a(E);Ve(N,20,()=>Array(4),We,(Y,oe,ee)=>{var te=Ba();h(()=>ye(te,`
										height: ${6+ee*3}px;
										background: ${(ee<e(f).bars?e(f).color:"var(--bg-hover)")??""};
										opacity: ${ee<e(f).bars?1:.4};
									`)),v(Y,te)}),t(N);var K=s(N,2),$=a(K);t(K),t(E),h(()=>{ye(K,`color: ${e(f).color??""}`),l($,`${e(f).label??""} (${r.liveReading.rssi??""} dBm)`)}),v(H,E)};z(y,H=>{e(f)&&H(L)})}var V=s(y,2);{var Q=H=>{var E=Ta(),N=a(E);t(E),h(()=>l(N,`Updated ${e(j)??""}`)),v(H,E)};z(V,H=>{e(j)&&H(Q)})}h(()=>l(g,` ${r.liveReading.color??""} Tilt - Connected`)),v(o,u)},T=o=>{var u=Ra(),_=Z(u),g=s(a(_));t(_),je(2),h(()=>l(g,` Device: ${r.batch.device_id??""}`)),v(o,u)};z(C,o=>{r.liveReading?o(w):o(T,!1)})}t(k),v(B,k)},P=B=>{var k=Oa(),C=s(a(k),2);{var w=T=>{var o=Ma();o.__click=function(...u){r.onEdit?.apply(this,u)},v(T,o)};z(C,T=>{r.onEdit&&T(w)})}t(k),v(B,k)};z(n,B=>{r.batch.device_id?B(O):B(P,!1)})}v(d,S)},$$slots:{default:!0}}),xe()}Ie(["click"]);var Ea=c('<div class="target wide svelte-19u9n31"><span class="target-label svelte-19u9n31">Yeast</span> <span class="target-value svelte-19u9n31"> </span></div>'),Pa=c('<div class="targets-grid svelte-19u9n31"><div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">OG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">FG</span> <span class="target-value svelte-19u9n31"> </span></div> <div class="target svelte-19u9n31"><span class="target-label svelte-19u9n31">ABV</span> <span class="target-value svelte-19u9n31"> </span></div> <!></div>');function La(I,r){ze(r,!0);function G(M){return M==null?"--":Je(M)}we(I,{title:"Recipe Targets",children:(M,f)=>{var j=Pa(),d=a(j),i=s(a(d),2),S=a(i,!0);t(i),t(d);var n=s(d,2),O=s(a(n),2),P=a(O,!0);t(O),t(n);var B=s(n,2),k=s(a(B),2),C=a(k,!0);t(k),t(B);var w=s(B,2);{var T=o=>{var u=Ea(),_=s(a(u),2),g=a(_,!0);t(_),t(u),h(()=>l(g,r.recipe.yeast_name)),v(o,u)};z(w,o=>{r.recipe.yeast_name&&o(T)})}t(j),h((o,u,_)=>{l(S,o),l(P,u),l(C,_)},[()=>G(r.recipe.og_target),()=>G(r.recipe.fg_target),()=>r.recipe.abv_target!=null?`${r.recipe.abv_target.toFixed(1)}%`:"--"]),v(M,j)},$$slots:{default:!0}}),xe()}var Ua=c('<p class="notes-content svelte-hkv31i"> </p>');function Aa(I,r){we(I,{title:"Notes",children:(G,M)=>{var f=Ua(),j=a(f,!0);t(f),h(()=>l(j,r.notes)),v(G,f)},$$slots:{default:!0}})}var Na=c('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),Ha=c('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),Ia=c('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),Va=c('<span class="recipe-type svelte-g5au2j"> </span>'),Wa=c('<a class="recipe-link svelte-g5au2j"> <!></a>'),Ja=c('<option class="svelte-g5au2j"> </option>'),Ka=c('<div class="override-banner svelte-g5au2j"><span class="override-icon svelte-g5au2j">âš¡</span> <span class="svelte-g5au2j"> </span> <button type="button" class="override-cancel-inline svelte-g5au2j">Cancel</button></div>'),Ya=c('<div class="heater-details svelte-g5au2j"><div class="heater-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Target</span> <span class="detail-value svelte-g5au2j"> </span></div> <div class="heater-detail svelte-g5au2j"><span class="detail-label svelte-g5au2j">Hysteresis</span> <span class="detail-value svelte-g5au2j"> </span></div></div> <!> <div class="override-controls svelte-g5au2j"><span class="override-label svelte-g5au2j">Manual Override (1hr)</span> <div class="override-btns svelte-g5au2j"><button type="button">Force ON</button> <button type="button">Force OFF</button></div></div>',1),qa=c('<div><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="heater-status svelte-g5au2j"><div>ðŸ”¥</div> <div class="heater-info svelte-g5au2j"><span> </span> <span class="heater-entity svelte-g5au2j"> </span></div></div> <!></div>'),Qa=c('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Temperature Control</h3> <div class="no-device svelte-g5au2j"><span class="svelte-g5au2j"> </span> <span class="hint svelte-g5au2j">Active only during fermentation</span></div></div>'),Xa=c('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!> <!></div> <div class="info-section svelte-g5au2j"><!> <!> <!> <!></div></div>',1),Za=c('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div>');function bs(I,r){ze(r,!0);const G=()=>Qt(Xt,"$page",M),[M,f]=qt();let j=null,d=null,i=fe(null),S=fe(null),n=fe(null),O=fe(!0),P=fe(null),B=fe(!1),k=fe(!1),C=fe(!1),w=R(()=>parseInt(G().params.id));const T={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},o=["planning","fermenting","conditioning","completed","archived"];let u=R(()=>e(i)?T[e(i).status]:T.planning),_=R(ht),g=R(()=>pt.config.ha_enabled&&pt.config.temp_control_enabled&&e(i)?.heater_entity_id),y=R(()=>{if(!e(i)?.device_id)return null;const m=e(i).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!m)return null;const U=m[1].toUpperCase();for(const ve of sa.tilts.values())if(ve.color.toUpperCase()===U)return ve;return null});async function L(){D(O,!0),D(P,null);try{if(D(i,await $t(e(w)),!0),e(i).status==="fermenting"||e(i).status==="conditioning")try{D(S,await ft(e(w)),!0)}catch{}if(e(i).heater_entity_id)try{D(n,await Ne(e(w)),!0)}catch{}}catch(m){D(P,m instanceof Error?m.message:"Failed to load batch",!0)}finally{D(O,!1)}}async function V(m){if(!(!e(i)||e(k))){D(k,!0);try{D(i,await mt(e(i).id,{status:m}),!0),(m==="fermenting"||m==="conditioning")&&D(S,await ft(e(i).id),!0)}catch(U){console.error("Failed to update status:",U)}finally{D(k,!1)}}}async function Q(m){if(e(i)&&(D(i,await mt(e(i).id,m),!0),D(B,!1),e(i).heater_entity_id))try{D(n,await Ne(e(i).id),!0)}catch{}}async function H(){if(e(i)&&confirm(`Are you sure you want to delete "${e(i).name||"this batch"}"?`))try{await ea(e(i).id),Zt("/batches")}catch{alert("Failed to delete batch")}}async function E(m){if(!(!e(i)||e(C))){D(C,!0);try{await ta(e(i).id,m),D(n,await Ne(e(i).id),!0)}catch(U){console.error("Failed to set override:",U)}finally{D(C,!1)}}}function N(){if(j?.readyState===WebSocket.OPEN)return;const U=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/ws`;j=new WebSocket(U),j.onmessage=async ve=>{try{const re=JSON.parse(ve.data);re.type==="control_event"&&re.batch_id===e(w)&&e(n)&&(re.action==="heat_on"?D(n,{...e(n),heater_state:"on"},!0):re.action==="heat_off"&&D(n,{...e(n),heater_state:"off"},!0))}catch{}},j.onclose=()=>{j=null,d=setTimeout(N,3e3)},j.onerror=()=>{j?.close()}}function K(){d&&(clearTimeout(d),d=null),j?.close(),j=null}function $(m){return m==null?"--":jt(m)}Ht(()=>{L(),N()}),It(()=>{K()});var Y=Za();Jt("g5au2j",m=>{Vt(()=>{Wt.title=`${(e(i)?.name||"Batch")??""} | BrewSignal`})});var oe=s(a(Y),2);{var ee=m=>{var U=Na();v(m,U)},te=m=>{var U=he(),ve=Z(U);{var re=p=>{var b=Ha(),F=s(a(b),2),q=a(F,!0);t(F);var W=s(F,2);W.__click=L,t(b),h(()=>l(q,e(P))),v(p,b)},X=p=>{var b=he(),F=Z(b);{var q=ae=>{var ie=Ia();v(ae,ie)},W=ae=>{var ie=he(),pe=Z(ie);{var de=se=>{ra(se,{get batch(){return e(i)},onSubmit:Q,onCancel:()=>D(B,!1)})},ke=se=>{var be=Xa(),Fe=Z(be),Re=a(Fe),Ge=a(Re),kt=a(Ge);t(Ge);var Ke=s(Ge,2),Me=a(Ke),yt=a(Me,!0);t(Me);var zt=s(Me,2);{var xt=x=>{var A=Wa(),J=a(A),ue=s(J);{var le=ne=>{var ge=Va(),_e=a(ge);t(ge),h(()=>l(_e,`(${e(i).recipe.type??""})`)),v(ne,ge)};z(ue,ne=>{e(i).recipe.type&&ne(le)})}t(A),h(()=>{bt(A,"href",`/recipes/${e(i).recipe.id??""}`),l(J,`${e(i).recipe.name??""} `)}),v(x,A)};z(zt,x=>{e(i).recipe&&x(xt)})}t(Ke),t(Re);var Ye=s(Re,2),Oe=a(Ye),ce=a(Oe);ce.__change=x=>V(x.currentTarget.value),Ve(ce,21,()=>o,We,(x,A)=>{var J=Ja(),ue=a(J,!0);t(J);var le={};h(()=>{l(ue,T[e(A)].label),le!==(le=e(A))&&(J.value=(J.__value=e(A))??"")}),v(x,J)}),t(ce);var qe;Kt(ce),t(Oe);var Qe=s(Oe,2);Qe.__click=()=>D(B,!0);var wt=s(Qe,2);wt.__click=H,t(Ye),t(Fe);var Xe=s(Fe,2),De=a(Xe),Ze=a(De);{var St=x=>{{let A=R(()=>e(S)?.measured?.current_sg),J=R(()=>e(S)?.temperature?.current);pa(x,{get liveReading(){return e(y)},get currentSg(){return e(A)},get currentTemp(){return e(J)}})}};z(Ze,x=>{(e(y)||e(S)?.measured?.current_sg!=null)&&x(St)})}var $e=s(Ze,2);{let x=R(()=>e(y)?.sg??e(S)?.measured?.current_sg);xa($e,{get batch(){return e(i)},get currentSg(){return e(x)},get progress(){return e(S)}})}var Bt=s($e,2);{var Ct=x=>{La(x,{get recipe(){return e(i).recipe}})};z(Bt,x=>{e(i).recipe&&x(Ct)})}t(De);var et=s(De,2),tt=a(et);Sa(tt,{get batch(){return e(i)}});var at=s(tt,2);Da(at,{get batch(){return e(i)},get liveReading(){return e(y)},onEdit:()=>D(B,!0)});var st=s(at,2);{var Tt=x=>{var A=qa();let J;var ue=s(a(A),2),le=a(ue);let ne;var ge=s(le,2),_e=a(ge);let Ce;var Mt=a(_e,!0);t(_e);var rt=s(_e,2),Ot=a(rt,!0);t(rt),t(ge),t(ue);var Dt=s(ue,2);{var Et=Ee=>{var it=Ya(),Pe=Z(it),Le=a(Pe),lt=s(a(Le),2),Pt=a(lt);t(lt),t(Le);var vt=s(Le,2),nt=s(a(vt),2),Lt=a(nt);t(nt),t(vt),t(Pe);var ot=s(Pe,2);{var Ut=Se=>{var Be=Ka(),Ae=s(a(Be),2),At=a(Ae);t(Ae);var _t=s(Ae,2);_t.__click=()=>E(null),t(Be),h(Nt=>{l(At,`Override active: ${Nt??""}`),_t.disabled=e(C)},[()=>e(n).override_state?.toUpperCase()]),v(Se,Be)};z(ot,Se=>{e(n).override_active&&Se(Ut)})}var dt=s(ot,2),ct=s(a(dt),2),Te=a(ct);let ut;Te.__click=()=>E("on");var Ue=s(Te,2);let gt;Ue.__click=()=>E("off"),t(ct),t(dt),h((Se,Be)=>{l(Pt,`${Se??""}${e(_)??""}`),l(Lt,`Â±${Be??""}${e(_)??""}`),ut=me(Te,1,"override-btn svelte-g5au2j",null,ut,{active:e(n).override_state==="on"}),Te.disabled=e(C),gt=me(Ue,1,"override-btn svelte-g5au2j",null,gt,{active:e(n).override_state==="off"}),Ue.disabled=e(C)},[()=>$(e(n).target_temp),()=>e(n).hysteresis?.toFixed(1)||"--"]),v(Ee,it)};z(Dt,Ee=>{e(n)&&Ee(Et)})}t(A),h(()=>{J=me(A,1,"info-card heater-card svelte-g5au2j",null,J,{"heater-on":e(n)?.heater_state==="on"}),ne=me(le,1,"heater-icon-wrap svelte-g5au2j",null,ne,{heating:e(n)?.heater_state==="on"}),Ce=me(_e,1,"heater-state svelte-g5au2j",null,Ce,{on:e(n)?.heater_state==="on"}),l(Mt,e(n)?.heater_state==="on"?"HEATING":e(n)?.heater_state==="off"?"OFF":"Unknown"),l(Ot,e(i).heater_entity_id)}),v(x,A)},Ft=x=>{var A=he(),J=Z(A);{var ue=le=>{var ne=Qa(),ge=s(a(ne),2),_e=a(ge),Ce=a(_e);t(_e),je(2),t(ge),t(ne),h(()=>l(Ce,`Heater: ${e(i).heater_entity_id??""}`)),v(le,ne)};z(J,le=>{e(i).heater_entity_id&&e(i).status!=="fermenting"&&le(ue)},!0)}v(x,A)};z(st,x=>{e(g)&&e(i).status==="fermenting"?x(Tt):x(Ft,!1)})}var Rt=s(st,2);{var Gt=x=>{Aa(x,{get notes(){return e(i).notes}})};z(Rt,x=>{e(i).notes&&x(Gt)})}t(et),t(Xe),h(()=>{l(kt,`#${(e(i).batch_number||"?")??""}`),l(yt,e(i).name||e(i).recipe?.name||"Unnamed Batch"),ce.disabled=e(k),ye(ce,`color: ${e(u).color??""}; background: ${e(u).bg??""};`),qe!==(qe=e(i).status)&&(ce.value=(ce.__value=e(i).status)??"",Yt(ce,e(i).status))}),v(se,be)};z(pe,se=>{e(B)?se(de):se(ke,!1)},!0)}v(ae,ie)};z(F,ae=>{e(i)?ae(W,!1):ae(q)},!0)}v(p,b)};z(ve,p=>{e(P)?p(re):p(X,!1)},!0)}v(m,U)};z(oe,m=>{e(O)?m(ee):m(te,!1)})}t(Y),v(I,Y),xe(),f()}Ie(["click","change"]);export{bs as component,ps as universal};
