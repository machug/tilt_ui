import{d as ba,f as p,a as o,t as ha,c as xa,s as N}from"../chunks/BHvHOtuG.js";import{ab as wa,ad as Sa,ae as ka,s as n,ag as t,g as l,ac as c,ah as e,al as Q,af as ya,V as Da,ai as La,aj as s,an as b,ak as Ba}from"../chunks/BeYMcFNd.js";import{i as T}from"../chunks/Cd5u1CHp.js";import{c as V,h as Ca,u as Fa,s as Ma}from"../chunks/D-gZUYAx.js";import{s as Na}from"../chunks/80fypgvT.js";import{b as Ta}from"../chunks/UEX34lHC.js";var Va=p('<span class="loading-dot svelte-11l5u6u"></span> Saving...',1),$a=p('<div class="loading-state svelte-11l5u6u"><div class="loading-spinner svelte-11l5u6u"></div> <span class="svelte-11l5u6u">Loading statistics...</span></div>'),ja=p('<div class="stats-grid svelte-11l5u6u"><div class="stat-item svelte-11l5u6u"><span class="stat-value font-mono svelte-11l5u6u"> </span> <span class="stat-label svelte-11l5u6u">Total Readings</span></div> <div class="stat-item svelte-11l5u6u"><span class="stat-value font-mono svelte-11l5u6u"> </span> <span class="stat-label svelte-11l5u6u">Estimated Size</span></div> <div class="stat-item full-width svelte-11l5u6u"><span class="stat-label svelte-11l5u6u">Data Range</span> <span class="stat-range font-mono svelte-11l5u6u"> </span></div></div>'),Ea=p('<p class="text-muted svelte-11l5u6u">No statistics available</p>'),Ia=p(`<div class="page-container svelte-11l5u6u"><div class="page-header svelte-11l5u6u"><h1 class="page-title svelte-11l5u6u">Logging</h1> <p class="page-description svelte-11l5u6u">Configure local data logging and export readings</p></div> <div class="grid gap-6 md:grid-cols-2 svelte-11l5u6u"><div class="card svelte-11l5u6u"><div class="card-header svelte-11l5u6u"><h2 class="card-title svelte-11l5u6u">Settings</h2></div> <div class="card-body svelte-11l5u6u"><div class="setting-row svelte-11l5u6u"><div class="setting-info svelte-11l5u6u"><span class="setting-label svelte-11l5u6u">Local Logging</span> <span class="setting-description svelte-11l5u6u">Store readings to database</span></div> <button type="button" aria-label="Toggle local logging"><span class="toggle-slider svelte-11l5u6u"></span></button></div> <div class="setting-row svelte-11l5u6u"><div class="setting-info svelte-11l5u6u"><span class="setting-label svelte-11l5u6u">Logging Interval</span> <span class="setting-description svelte-11l5u6u">How often to save readings</span></div> <div class="interval-select svelte-11l5u6u"><select class="select-input svelte-11l5u6u"><option class="svelte-11l5u6u">1 min</option><option class="svelte-11l5u6u">5 min</option><option class="svelte-11l5u6u">10 min</option><option class="svelte-11l5u6u">15 min</option><option class="svelte-11l5u6u">30 min</option><option class="svelte-11l5u6u">60 min</option></select></div></div> <div class="mt-6 svelte-11l5u6u"><button type="button" class="btn-primary svelte-11l5u6u"><!></button></div></div></div> <div class="card svelte-11l5u6u"><div class="card-header svelte-11l5u6u"><h2 class="card-title svelte-11l5u6u">Database</h2></div> <div class="card-body svelte-11l5u6u"><!></div></div> <div class="card md:col-span-2 svelte-11l5u6u"><div class="card-header svelte-11l5u6u"><h2 class="card-title svelte-11l5u6u">Export Data</h2></div> <div class="card-body svelte-11l5u6u"><div class="export-section svelte-11l5u6u"><div class="export-info svelte-11l5u6u"><p class="export-description svelte-11l5u6u">Download all recorded readings as a CSV file. The export includes timestamp,
							tilt ID, color, beer name, raw and calibrated values for SG and temperature,
							and signal strength.</p></div> <a href="/log.csv" download="tilt_readings.csv" class="btn-secondary svelte-11l5u6u"><svg class="w-4 h-4 svelte-11l5u6u" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" class="svelte-11l5u6u"></path></svg> Download CSV</a></div></div></div></div></div>`);function Ua(W,X){wa(X,!0);let u=c(null),$=c(!0),g=c(!1),v=c(!0),_=c(15);async function Y(){try{const a=await fetch("/api/stats");a.ok&&n(u,await a.json(),!0)}catch(a){console.error("Failed to load stats:",a)}finally{n($,!1)}}function j(){n(v,V.config.local_logging_enabled,!0),n(_,V.config.local_interval_minutes,!0)}async function Z(){n(g,!0);try{await Fa({local_logging_enabled:l(v),local_interval_minutes:l(_)})}finally{n(g,!1)}}function aa(a){return!Number.isFinite(a)||a<0?"0 B":a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`}function E(a){return a?new Date(a).toLocaleString():"N/A"}function ea(a){return a.toLocaleString()}Sa(()=>{Y(),j()}),ka(()=>{V.loaded&&j()});var h=Ia();Ca("11l5u6u",a=>{Da(()=>{La.title="Logging | Tilt UI"})});var I=t(e(h),2),x=e(I),z=t(e(x),2),w=e(z),S=t(e(w),2);let R;S.__click=()=>n(v,!l(v)),s(w);var k=t(w,2),A=t(e(k),2),f=e(A),y=e(f);y.value=y.__value=1;var D=t(y);D.value=D.__value=5;var L=t(D);L.value=L.__value=10;var B=t(L);B.value=B.__value=15;var C=t(B);C.value=C.__value=30;var G=t(C);G.value=G.__value=60,s(f),s(A),s(k);var H=t(k,2),m=e(H);m.__click=Z;var sa=e(m);{var ta=a=>{var i=Va();b(),o(a,i)},la=a=>{var i=ha("Save Settings");o(a,i)};T(sa,a=>{l(g)?a(ta):a(la,!1)})}s(m),s(H),s(z),s(x);var K=t(x,2),U=t(e(K),2),ia=e(U);{var na=a=>{var i=$a();o(a,i)},va=a=>{var i=xa(),oa=Ba(i);{var ua=r=>{var d=ja(),F=e(d),q=e(F),da=e(q,!0);s(q),b(2),s(F);var M=t(F,2),J=e(M),ca=e(J,!0);s(J),b(2),s(M);var O=t(M,2),P=t(e(O),2),pa=e(P);s(P),s(O),s(d),Q((ga,_a,fa,ma)=>{N(da,ga),N(ca,_a),N(pa,`${fa??""} â€” ${ma??""}`)},[()=>ea(l(u).total_readings),()=>aa(l(u).estimated_size_bytes),()=>E(l(u).oldest_reading),()=>E(l(u).newest_reading)]),o(r,d)},ra=r=>{var d=Ea();o(r,d)};T(oa,r=>{l(u)?r(ua):r(ra,!1)},!0)}o(a,i)};T(ia,a=>{l($)?a(na):a(va,!1)})}s(U),s(K),b(2),s(I),s(h),Q(()=>{R=Na(S,1,"toggle svelte-11l5u6u",null,R,{active:l(v)}),Ma(S,"aria-pressed",l(v)),f.disabled=!l(v),m.disabled=l(g)}),Ta(f,()=>l(_),a=>n(_,a)),o(W,h),ya()}ba(["click"]);export{Ua as component};
