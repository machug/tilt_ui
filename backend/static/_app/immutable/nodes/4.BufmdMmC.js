import{d as Sa,f as g,a as d,c as _e,s as o}from"../chunks/BMR6TOGE.js";import{aa as Aa,ap as Oa,ab as Ea,aD as Pa,ac as s,ad as t,b as e,ae as Va,an as S,af as a,s as j,ao as N,au as A,aq as b,ar as Ve}from"../chunks/CJ9U_lt3.js";import{e as Ia,i as Na}from"../chunks/Bv8p5TEf.js";import{i as m}from"../chunks/BK4Po838.js";import{h as Ra,s as za}from"../chunks/CHurcNvB.js";import{s as Ie}from"../chunks/CJgb9CkH.js";import{i as Ha,s as qa}from"../chunks/4F6_53_-.js";import{s as Ya,a as Ja}from"../chunks/CjMG55H5.js";import{p as Ka}from"../chunks/gfI_NUEz.js";import{g as Qa}from"../chunks/CmFxP73J.js";import{a as Wa,b as Ne,u as Re,d as Xa}from"../chunks/CTNLw3_F.js";import{d as Za,e as et,h as at,g as tt}from"../chunks/BZ207_Dj.js";import{t as st}from"../chunks/7aIyeNsM.js";import{B as rt}from"../chunks/B3MR2OL6.js";const vt=!1,Vt=Object.freeze(Object.defineProperty({__proto__:null,prerender:vt},Symbol.toStringTag,{value:"Module"}));var it=g('<div class="loading-state svelte-g5au2j"><div class="spinner svelte-g5au2j"></div> <span class="svelte-g5au2j">Loading batch...</span></div>'),lt=g('<div class="error-state svelte-g5au2j"><span class="error-icon svelte-g5au2j">!</span> <p class="svelte-g5au2j"> </p> <button type="button" class="retry-btn svelte-g5au2j">Retry</button></div>'),nt=g('<div class="error-state svelte-g5au2j"><p class="svelte-g5au2j">Batch not found</p></div>'),ot=g('<span class="recipe-type svelte-g5au2j"> </span>'),dt=g('<a class="recipe-link svelte-g5au2j"> <!></a>'),ut=g('<option class="svelte-g5au2j"> </option>'),ct=g('<span class="live-badge svelte-g5au2j"><span class="live-dot svelte-g5au2j"></span> Live</span>'),gt=g('<div class="stat-item svelte-g5au2j"><div class="stat-value temp svelte-g5au2j"> </div> <div class="stat-label svelte-g5au2j"> </div></div>'),pt=g('<div class="stat-card live svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Current</span> <!></div> <div class="stat-row svelte-g5au2j"><div class="stat-item svelte-g5au2j"><div class="stat-value svelte-g5au2j"> </div> <div class="stat-label svelte-g5au2j"> </div></div> <!></div></div>'),_t=g('<div class="progress-remaining svelte-g5au2j"> </div>'),mt=g('<div class="stat-card svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Progress</span></div> <div class="progress-display svelte-g5au2j"><div class="progress-value svelte-g5au2j"> </div> <div class="progress-bar-container svelte-g5au2j"><div class="progress-bar svelte-g5au2j"></div></div> <!></div></div>'),ft=g('<div class="measurement wide svelte-g5au2j"><span class="measurement-label svelte-g5au2j">Yeast</span> <span class="measurement-value target svelte-g5au2j"> </span></div>'),jt=g('<div class="stat-card svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Recipe Targets</span></div> <div class="measurements-grid svelte-g5au2j"><div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">OG</span> <span class="measurement-value target svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">FG</span> <span class="measurement-value target svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">ABV</span> <span class="measurement-value target svelte-g5au2j"> </span></div> <!></div></div>'),bt=g('<div class="device-status online svelte-g5au2j"><span class="device-dot svelte-g5au2j"></span> </div> <div class="device-last-seen svelte-g5au2j">Updated just now</div>',1),ht=g('<div class="device-status offline svelte-g5au2j"><span class="device-dot svelte-g5au2j"></span> </div> <div class="device-last-seen svelte-g5au2j">Not receiving data</div>',1),xt=g('<div class="device-info svelte-g5au2j"><!></div>'),yt=g('<div class="no-device svelte-g5au2j"><span class="svelte-g5au2j">No device assigned</span> <button type="button" class="link-btn svelte-g5au2j">Link a device</button></div>'),kt=g('<div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Notes</h3> <p class="notes-content svelte-g5au2j"> </p></div>'),wt=g('<div class="batch-header svelte-g5au2j"><div class="header-main svelte-g5au2j"><div class="batch-number svelte-g5au2j"> </div> <div class="header-info svelte-g5au2j"><h1 class="batch-name svelte-g5au2j"> </h1> <!></div></div> <div class="header-actions svelte-g5au2j"><div class="status-selector svelte-g5au2j"><select class="status-select svelte-g5au2j"></select></div> <button type="button" class="edit-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" class="svelte-g5au2j"></path></svg> Edit</button> <button type="button" class="delete-btn svelte-g5au2j"><svg class="btn-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" class="svelte-g5au2j"></path></svg></button></div></div> <div class="content-grid svelte-g5au2j"><div class="stats-section svelte-g5au2j"><!> <!> <div class="stat-card svelte-g5au2j"><div class="stat-header svelte-g5au2j"><span class="stat-title svelte-g5au2j">Measurements</span></div> <div class="measurements-grid svelte-g5au2j"><div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">OG</span> <span class="measurement-value svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">FG</span> <span class="measurement-value svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">ABV</span> <span class="measurement-value svelte-g5au2j"> </span></div> <div class="measurement svelte-g5au2j"><span class="measurement-label svelte-g5au2j">Atten</span> <span class="measurement-value svelte-g5au2j"> </span></div></div></div> <!></div> <div class="info-section svelte-g5au2j"><div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Timeline</h3> <div class="timeline svelte-g5au2j"><div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Brew Date</span> <span class="timeline-value svelte-g5au2j"> </span></div> <div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Started</span> <span class="timeline-value svelte-g5au2j"> </span></div> <div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Ended</span> <span class="timeline-value svelte-g5au2j"> </span></div> <div class="timeline-item svelte-g5au2j"><span class="timeline-label svelte-g5au2j">Created</span> <span class="timeline-value svelte-g5au2j"> </span></div></div></div> <div class="info-card svelte-g5au2j"><h3 class="info-title svelte-g5au2j">Tracking Device</h3> <!></div> <!></div></div>',1),Bt=g('<div class="page-container svelte-g5au2j"><div class="back-link svelte-g5au2j"><a href="/batches" class="back-btn svelte-g5au2j"><svg class="back-icon svelte-g5au2j" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" class="svelte-g5au2j"></path></svg> Back to Batches</a></div> <!></div>');function It(ze,He){Aa(He,!0);const qe=()=>Ja(Ka,"$page",Ye),[Ye,Je]=Ya();let r=S(null),x=S(null),J=S(!0),R=S(null),O=S(!1),z=S(!1),me=N(()=>parseInt(qe().params.id));const K={planning:{label:"Planning",color:"var(--text-secondary)",bg:"var(--bg-elevated)"},fermenting:{label:"Fermenting",color:"#f59e0b",bg:"rgba(245, 158, 11, 0.12)"},conditioning:{label:"Conditioning",color:"#8b5cf6",bg:"rgba(139, 92, 246, 0.12)"},completed:{label:"Completed",color:"var(--positive)",bg:"rgba(34, 197, 94, 0.12)"},archived:{label:"Archived",color:"var(--text-muted)",bg:"var(--bg-elevated)"}},Ke=["planning","fermenting","conditioning","completed","archived"];let fe=N(()=>e(r)?K[e(r).status]:K.planning),Qe=N(et),We=N(tt),D=N(()=>{if(!e(r)?.device_id)return null;const v=e(r).device_id.match(/^(?:tilt-)?(\w+)$/i);if(!v)return null;const C=v[1].toUpperCase();for(const H of st.tilts.values())if(H.color.toUpperCase()===C)return H;return null});async function je(){j(J,!0),j(R,null);try{if(j(r,await Wa(e(me)),!0),e(r).status==="fermenting"||e(r).status==="conditioning")try{j(x,await Ne(e(me)),!0)}catch{}}catch(v){j(R,v instanceof Error?v.message:"Failed to load batch",!0)}finally{j(J,!1)}}async function Xe(v){if(!(!e(r)||e(z))){j(z,!0);try{j(r,await Re(e(r).id,{status:v}),!0),(v==="fermenting"||v==="conditioning")&&j(x,await Ne(e(r).id),!0)}catch(C){console.error("Failed to update status:",C)}finally{j(z,!1)}}}async function Ze(v){e(r)&&(j(r,await Re(e(r).id,v),!0),j(O,!1))}async function ea(){if(e(r)&&confirm(`Are you sure you want to delete "${e(r).name||"this batch"}"?`))try{await Xa(e(r).id),Qa("/batches")}catch{alert("Failed to delete batch")}}function E(v){return v==null?"--":Za(v)}function aa(v){return v==null?"--":at(v)}function ta(v){return v?new Date(v).toLocaleDateString("en-GB",{weekday:"short",day:"numeric",month:"short",year:"numeric"}):"--"}function Q(v){return v?new Date(v).toLocaleString("en-GB",{day:"numeric",month:"short",hour:"numeric",minute:"2-digit"}):"--"}Oa(()=>{je()});var W=Bt();Ra("g5au2j",v=>{Pa(()=>{Va.title=`${(e(r)?.name||"Batch")??""} | BrewSignal`})});var sa=s(t(W),2);{var ra=v=>{var C=it();d(v,C)},va=v=>{var C=_e(),H=A(C);{var ia=G=>{var T=lt(),P=s(t(T),2),X=t(P,!0);a(P);var Z=s(P,2);Z.__click=je,a(T),b(()=>o(X,e(R))),d(G,T)},la=G=>{var T=_e(),P=A(T);{var X=U=>{var q=nt();d(U,q)},Z=U=>{var q=_e(),na=A(q);{var oa=L=>{rt(L,{get batch(){return e(r)},onSubmit:Ze,onCancel:()=>j(O,!1)})},da=L=>{var be=wt(),ee=A(be),ae=t(ee),te=t(ae),ua=t(te);a(te);var he=s(te,2),se=t(he),ca=t(se,!0);a(se);var ga=s(se,2);{var pa=l=>{var i=dt(),n=t(i),p=s(n);{var f=u=>{var c=ot(),_=t(c);a(c),b(()=>o(_,`(${e(r).recipe.type??""})`)),d(u,c)};m(p,u=>{e(r).recipe.type&&u(f)})}a(i),b(()=>{za(i,"href",`/recipes/${e(r).recipe.id??""}`),o(n,`${e(r).recipe.name??""} `)}),d(l,i)};m(ga,l=>{e(r).recipe&&l(pa)})}a(he),a(ae);var xe=s(ae,2),re=t(xe),w=t(re);w.__change=l=>Xe(l.currentTarget.value),Ia(w,21,()=>Ke,Na,(l,i)=>{var n=ut(),p=t(n,!0);a(n);var f={};b(()=>{o(p,K[e(i)].label),f!==(f=e(i))&&(n.value=(n.__value=e(i))??"")}),d(l,n)}),a(w);var ye;Ha(w),a(re);var ke=s(re,2);ke.__click=()=>j(O,!0);var _a=s(ke,2);_a.__click=ea,a(xe),a(ee);var we=s(ee,2),ve=t(we),Be=t(ve);{var ma=l=>{var i=pt(),n=t(i),p=s(t(n),2);{var f=y=>{var k=ct();d(y,k)};m(p,y=>{e(D)&&y(f)})}a(n);var u=s(n,2),c=t(u),_=t(c),B=t(_,!0);a(_);var h=s(_,2),F=t(h,!0);a(h),a(c);var V=s(c,2);{var I=y=>{var k=gt(),$=t(k),M=t($,!0);a($);var Y=s($,2),La=t(Y,!0);a(Y),a(k),b(Ma=>{o(M,Ma),o(La,e(We))},[()=>aa(e(D)?.temp??e(x)?.temperature?.current)]),d(y,k)};m(V,y=>{(e(D)?.temp!=null||e(x)?.temperature?.current!=null)&&y(I)})}a(u),a(i),b(y=>{o(B,y),o(F,e(Qe))},[()=>E(e(D)?.sg??e(x)?.measured?.current_sg)]),d(l,i)};m(Be,l=>{(e(D)||e(x)?.measured?.current_sg!=null)&&l(ma)})}var $e=s(Be,2);{var fa=l=>{var i=mt(),n=s(t(i),2),p=t(n),f=t(p);a(p);var u=s(p,2),c=t(u);a(u);var _=s(u,2);{var B=h=>{var F=_t(),V=t(F);a(F),b(I=>o(V,`${I??""} SG remaining`),[()=>e(x).progress.sg_remaining.toFixed(3)]),d(h,F)};m(_,h=>{e(x).progress.sg_remaining!=null&&h(B)})}a(n),a(i),b(h=>{o(f,`${h??""}%`),Ie(c,`width: ${e(x).progress.percent_complete??""}%`)},[()=>e(x).progress.percent_complete.toFixed(0)]),d(l,i)};m($e,l=>{e(x)?.progress?.percent_complete!=null&&l(fa)})}var ie=s($e,2),Ce=s(t(ie),2),le=t(Ce),Fe=s(t(le),2),ja=t(Fe,!0);a(Fe),a(le);var ne=s(le,2),De=s(t(ne),2),ba=t(De,!0);a(De),a(ne);var oe=s(ne,2),Ge=s(t(oe),2),ha=t(Ge,!0);a(Ge),a(oe);var Te=s(oe,2),Ue=s(t(Te),2),xa=t(Ue,!0);a(Ue),a(Te),a(Ce),a(ie);var ya=s(ie,2);{var ka=l=>{var i=jt(),n=s(t(i),2),p=t(n),f=s(t(p),2),u=t(f,!0);a(f),a(p);var c=s(p,2),_=s(t(c),2),B=t(_,!0);a(_),a(c);var h=s(c,2),F=s(t(h),2),V=t(F,!0);a(F),a(h);var I=s(h,2);{var y=k=>{var $=ft(),M=s(t($),2),Y=t(M,!0);a(M),a($),b(()=>o(Y,e(r).recipe.yeast_name)),d(k,$)};m(I,k=>{e(r).recipe.yeast_name&&k(y)})}a(n),a(i),b((k,$,M)=>{o(u,k),o(B,$),o(V,M)},[()=>E(e(r).recipe.og_target),()=>E(e(r).recipe.fg_target),()=>e(r).recipe.abv_target!=null?`${e(r).recipe.abv_target.toFixed(1)}%`:"--"]),d(l,i)};m(ya,l=>{e(r).recipe&&l(ka)})}a(ve);var Le=s(ve,2),de=t(Le),Me=s(t(de),2),ue=t(Me),Se=s(t(ue),2),wa=t(Se,!0);a(Se),a(ue);var ce=s(ue,2),Ae=s(t(ce),2),Ba=t(Ae,!0);a(Ae),a(ce);var ge=s(ce,2),Oe=s(t(ge),2),$a=t(Oe,!0);a(Oe),a(ge);var Ee=s(ge,2),Pe=s(t(Ee),2),Ca=t(Pe,!0);a(Pe),a(Ee),a(Me),a(de);var pe=s(de,2),Fa=s(t(pe),2);{var Da=l=>{var i=xt(),n=t(i);{var p=u=>{var c=bt(),_=A(c),B=s(t(_));a(_),Ve(2),b(()=>o(B,` ${e(D).color??""} Tilt - Connected`)),d(u,c)},f=u=>{var c=ht(),_=A(c),B=s(t(_));a(_),Ve(2),b(()=>o(B,` Device: ${e(r).device_id??""}`)),d(u,c)};m(n,u=>{e(D)?u(p):u(f,!1)})}a(i),d(l,i)},Ga=l=>{var i=yt(),n=s(t(i),2);n.__click=()=>j(O,!0),a(i),d(l,i)};m(Fa,l=>{e(r).device_id?l(Da):l(Ga,!1)})}a(pe);var Ta=s(pe,2);{var Ua=l=>{var i=kt(),n=s(t(i),2),p=t(n,!0);a(n),a(i),b(()=>o(p,e(r).notes)),d(l,i)};m(Ta,l=>{e(r).notes&&l(Ua)})}a(Le),a(we),b((l,i,n,p,f,u,c,_)=>{o(ua,`#${(e(r).batch_number||"?")??""}`),o(ca,e(r).name||e(r).recipe?.name||"Unnamed Batch"),w.disabled=e(z),Ie(w,`color: ${e(fe).color??""}; background: ${e(fe).bg??""};`),ye!==(ye=e(r).status)&&(w.value=(w.__value=e(r).status)??"",qa(w,e(r).status)),o(ja,l),o(ba,i),o(ha,n),o(xa,p),o(wa,f),o(Ba,u),o($a,c),o(Ca,_)},[()=>E(e(r).measured_og),()=>E(e(r).measured_fg),()=>e(r).measured_abv!=null?`${e(r).measured_abv.toFixed(1)}%`:"--",()=>e(r).measured_attenuation!=null?`${e(r).measured_attenuation.toFixed(0)}%`:"--",()=>ta(e(r).brew_date),()=>Q(e(r).start_time),()=>Q(e(r).end_time),()=>Q(e(r).created_at)]),d(L,be)};m(na,L=>{e(O)?L(oa):L(da,!1)},!0)}d(U,q)};m(P,U=>{e(r)?U(Z,!1):U(X)},!0)}d(G,T)};m(H,G=>{e(R)?G(ia):G(la,!1)},!0)}d(v,C)};m(sa,v=>{e(J)?v(ra):v(va,!1)})}a(W),d(ze,W),Ea(),Je()}Sa(["click","change"]);export{It as component,Vt as universal};
